Content-Length: 3121
{"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":9012,"clientInfo":{"name":"vscode","version":"1.68.1"},"rootPath":"d:\\TOTVS 12\\Microsiga\\Protheus\\ProjetoVSCode","rootUri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","capabilities":{"workspace":{"applyEdit":true,"workspaceEdit":{"documentChanges":true,"resourceOperations":["create","rename","delete"],"failureHandling":"textOnlyTransactional"},"didChangeConfiguration":{"dynamicRegistration":true},"didChangeWatchedFiles":{"dynamicRegistration":true},"symbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]}},"executeCommand":{"dynamicRegistration":true},"configuration":true,"workspaceFolders":true},"textDocument":{"publishDiagnostics":{"relatedInformation":true,"versionSupport":false,"tagSupport":{"valueSet":[1,2]}},"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"contextSupport":true,"completionItem":{"snippetSupport":true,"commitCharactersSupport":true,"documentationFormat":["markdown","plaintext"],"deprecatedSupport":true,"preselectSupport":true,"tagSupport":{"valueSet":[1]}},"completionItemKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]}},"hover":{"dynamicRegistration":true,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":true,"signatureInformation":{"documentationFormat":["markdown","plaintext"],"parameterInformation":{"labelOffsetSupport":true}},"contextSupport":true},"definition":{"dynamicRegistration":true,"linkSupport":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"hierarchicalDocumentSymbolSupport":true},"codeAction":{"dynamicRegistration":true,"isPreferredSupport":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}}},"codeLens":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true,"prepareSupport":true},"documentLink":{"dynamicRegistration":true,"tooltipSupport":true},"typeDefinition":{"dynamicRegistration":true,"linkSupport":true},"implementation":{"dynamicRegistration":true,"linkSupport":true},"colorProvider":{"dynamicRegistration":true},"foldingRange":{"dynamicRegistration":true,"rangeLimit":5000,"lineFoldingOnly":true},"declaration":{"dynamicRegistration":true,"linkSupport":true},"selectionRange":{"dynamicRegistration":true}},"window":{"workDoneProgress":true}},"initializationOptions":{"launchArgs":["--log-file=totvsls.log","--record=totvsls"]},"trace":"off","workspaceFolders":[{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","name":"ProjetoVSCode"}]}}
Content-Length: 52
{"jsonrpc":"2.0","method":"initialized","params":{}}
Content-Length: 7698
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/04_CONTABIL/MCT1CLI.prw","languageId":"advpl","version":1,"text":"#Include \"rwmake.ch\"\r\n#Include \"Colors.ch\"\r\n#Include \"Protheus.ch\"  \r\n#Include \"Topconn.ch\"\r\n    \r\n/*\r\nPrograma ...: MCT1CLI.Prw\r\nUso ........: Contabilidade Siga CTB/FATURAMENTO\r\nData .......: 24/11/2021\r\nFeito por ..: Bruno Lage Ferreira\r\nCopyright @1998-2001,2021\r\nAtualizado..: \r\n\r\nNome do Arquivo:\r\n*/     \r\nUser Function M030Inc()  \r\n/*****************************\r\n*   Ponto de entrada apos gravacao dos dados do SA1\r\n*   // INCLUSAO\r\n*/                \r\n  \r\n/*\r\nChamada para o item contabil\r\n*/\r\nIf PARAMIXB # 3\r\n\t//If SubString(CNUMEMP,1,2) == \"01\"\r\n\t\tU_MCT1CLI()\r\n\t//EndIf\r\nEndIf\r\n\r\nReturn(.T.)\r\n\r\nUser Function MCT1CLI()\r\n************************************************************************************************\r\n* // Vinculo ao ponto de entrada M030INC()\r\n* // \r\n***  \r\n\t//+----------------------------------------------------------+\r\n\t//| Declaração de Variáveis                                  |\r\n\t//+----------------------------------------------------------+\r\n\tLocal aAreaOld\t:= GetArea()\r\n\tLocal cBaseCTA\t:= \"11201\"\r\n\tLocal cUltCTA\t:= \"\"\r\n\tLocal cUltRed\t:= \"\"\r\n\tLocal cQuery\t:= \"\"\r\n\tLocal cQueryA1\t:= \"\"\r\n\t\r\n\tLocal cCtaRef\t:= PadR(\"1.01.02.02.01\",TamSx3(\"CVD_CTAREF\")[1])\r\n\tLocal cCtaSup\t:= PadR(\"1.01.02.02\"   ,TamSx3(\"CVD_CTAREF\")[1])\r\n\r\n\tLocal cMsgStop\t:= \"\"\r\n\tLocal lGravou\t:= .T.\r\n\r\n\t//+----------------------------------------------------------+\r\n\t//| Fecha areas de trabalho abertas                          |\r\n\t//+----------------------------------------------------------+\t\r\n\tIf Select(\"MAXCTA\") > 0\r\n\t\tdbSelectArea(\"MAXCTA\")\r\n\t\tdbCloseArea()\r\n\tEndIf\r\n\r\n\tIf Select(\"CTACLI\") > 0\r\n\t\tdbSelectArea(\"CTACLI\")\r\n\t\tdbCloseArea()\r\n\tEndIf\r\n\r\n\t//+----------------------------------------------------------+\r\n\t//| Verifica se ja tem cliente com esta base de CNPJ         |\r\n\t//| para pegar a conta contabil dele                         |\r\n\t//+----------------------------------------------------------+\t\r\n\tcQueryA1 := \"SELECT A1_CONTA \" + CRLF\r\n\tcQueryA1 += \"FROM \" + RetSqlName(\"SA1\") + \" SA1 \" + CRLF\r\n\tcQueryA1 += \"WHERE D_E_L_E_T_ <> '*' \"  + CRLF\r\n\tcQueryA1 += \" AND ((A1_TIPO = 'J' AND SUBSTR(A1_CGC,1,8) = '\"+Substr(SA1->A1_CGC,1,8)+\"') OR (A1_TIPO <> 'J' AND A1_CGC = '\"+SA1->A1_CGC+\"')) \"\r\n\r\n\t//+---------------------------------------------------+\r\n\t//| Grava a query no log                              |\r\n\t//+---------------------------------------------------+\r\n\t//MemoWrite(CLOGPATH+'RCTBM001_MCT1CLI.sql',cQueryA1)\r\n\r\n\r\n\t//TcQuery cQueryA1 New Alias \"CTACLI\"\r\n\t\r\n\t//dbSelectArea(\"CTACLI\")\r\n\t//dbGoTop()\r\n\r\n\t/*\r\n\tIf CTACLI->(!Eof()) .AND. !Empty(CTACLI->A1_CONTA)\r\n\r\n\t\tcUltCTA := CTACLI->A1_CONTA\r\n\r\n\tElse \r\n\t*/\r\n\tcQuery := \" SELECT TOP 1 * FROM (\r\n\tcQuery += \" SELECT ROW_NUMBER() OVER(ORDER BY REPLACE(CT1_CONTA,'11201','') ) AS ROW1,\r\n\tcQuery += \" \t\tCT1_CONTA ULCTA, \r\n\tcQuery += \" \t\tCAST(REPLACE(CT1_CONTA,'11201','') AS INTEGER) COD_INTEIRO,\r\n\tcQuery += \" \t\tREPLACE(CT1_CONTA,'11201','') CODIGO,\r\n\tcQuery += \" \t\t(SELECT MAX(CT1_RES) FROM \" + RetSqlName(\"CT1\") + \" (nolock) WHERE D_E_L_E_T_ = '' ) ULTRES  \r\n\tcQuery += \"   FROM \" + RetSqlName(\"CT1\") + \" (nolock) CT1 \r\n\tcQuery += \"  WHERE D_E_L_E_T_ <> '*' \r\n\tcQuery += \"    AND SUBSTRING(CT1_CONTA,1,5) = '11201'\r\n\tcQuery += \"    AND REPLACE(CT1_CONTA,'11201','') <> ''\r\n\tcQuery += \"    AND Len(REPLACE(CT1_CONTA,'11201',''))=4\r\n\tcQuery += \"  )TAB\r\n \tcQuery += \" WHERE ROW1<>COD_INTEIRO\r\n\r\n\t//MemoWrite(CLOGPATH+'RCTBM001_MCT1CLI1.sql',cQuery)\r\n\r\n\tTcQuery cQuery New Alias MAXCTA\r\n\r\n\tdbSelectArea(\"MAXCTA\")\r\n\tdbGoTop()\r\n\t\r\n\t//+----------------------------------------------------------+\r\n\t//| Se trouxer resultados, coleta e grava na CT1             |\r\n\t//+----------------------------------------------------------+\r\n\tIf MAXCTA->(!Eof())\r\n\t\t\r\n\t\tcUltCTA\t:= STRZERO(MAXCTA->ROW1 , 4)\r\n\t\tcUltRED\t:= SOMA1(Alltrim(MAXCTA->ULTRES))\r\n\r\n\t\t//+---------------------+\r\n\t\t//| Grava os Dados      |\r\n\t\t//+---------------------+\r\n\t\tdbSelectArea(\"CT1\")\r\n\r\n\t\tIf  Reclock(\"CT1\",.T.)\r\n\t\t\r\n\t\t\tCT1_FILIAL\t:= xFilial(\"CT1\")\r\n\t\t\tCT1_CONTA\t:= cBaseCTA+cUltCTA\r\n\t\t\tCT1_CTASUP  := cBaseCTA\r\n\t\t\tCT1_DESC01\t:= SA1->A1_NOME\r\n\t\t\tCT1_RES\t\t:= cUltRED\r\n\t\t\tCT1_CLASSE\t:= '2'\r\n\t\t\tCT1_DTEXIS\t:= CTOD(\"01/01/1980\")\r\n\t\t\tCT1_BLOQ\t:= '2'\r\n\t\t\tCT1_NORMAL\t:= '1'\r\n\t\t\tCT1_NTSPED\t:= '01'\r\n\t\t\tCT1_NATCTA\t:= '01'\r\n\t\t\tMsUnlock(\"CT1\")\r\n\t\t\t\r\n\t\t\t//+----------------------------------------------------------+\r\n\t\t\t//| Dados da Amarracao Conta x Referencial                   |\r\n\t\t\t//+----------------------------------------------------------+\t\r\n\t\t\tIf Reclock(\"CVD\",.T.)\r\n\t\t\t\tCVD->CVD_FILIAL := xFilial('CVD')\r\n\t\t\t\tCVD->CVD_CONTA \t:= cUltCTA     \r\n\t\t\t\tCVD->CVD_ENTREF := PadR('10',TamSx3('CVD_ENTREF')[1])         \r\n\t\t\t\tCVD->CVD_CTAREF\t:= cCtaRef \r\n\t\t\t\tCVD->CVD_TPUTIL := 'A' \t\r\n\t\t\t\tCVD->CVD_CODPLA := PadR('001',TamSx3('CVD_CODPLA')[1])       \r\n\t\t\t\tCVD->CVD_CLASSE := '2'\r\n\t\t\t\tCVD->CVD_NATCTA := '02'\r\n\t\t\t\tCVD->CVD_CTASUP := cCtaSup\r\n\t\t\t\tCVD->CVD_CUSTO\t:= '' \r\n\r\n\t\t\t\tMsUnlock(\"CVD\")\r\n\t\t\tElse\r\n\t\t\t\tcMsgStop := \"Não conseguiu gravar amarracao plano de contas x referencial\" \r\n\t\t\t\tConOut(cMsgStop)\r\n\t\t\t\tMsgStop(cMsgStop)\r\n\t\t\tEndIf\r\n\t\t\t\r\n\r\n\t\tElse\r\n\r\n\t\t\tlGravou := .F.\r\n\t\t\tcMsgStop := \"Nao conseguiu gravar conta contabil e amarracao plano de contas x Referencial\"\r\n\t\t\tConOut(cMsgStop)\r\n\t\t\tMsgStop(cMsgStop)\r\n\t\tEndIf\t\r\n\t\r\n\tEndIf\r\n\t/*\r\n\tEndIf\r\n\t*/\r\n\t//+----------------------------------------------------+\r\n\t//| Grava a conta contabil no fornecedor               |\r\n\t//+----------------------------------------------------+\r\n\tIf lGravou\r\n\r\n\t\tIf Reclock(\"SA1\",.F.)\r\n\t\t\r\n\t\t\tSA1->A1_CONTA\t:= cBaseCTA+cUltCTA\r\n\t\t\t\r\n\t\t\tSA1->(MsUnlock())\r\n\r\n\t\tElse\r\n\r\n\t\t\tcMsgStop := \"Nao foi possivel gravar a conta contabil no cadastro do fornecedor (A1_CONTA)\"\r\n\t\t\tConOut(cMsgStop)\r\n\t\t\tMsgStop(cMsgStop)\r\n\t\t\r\n\t\tEndIf\r\n\r\n\tEndIf\t\r\n\t\r\n   \t//+----------------------------------------------------------+\r\n\t//| Fecha areas de trabalho abertas                          |\r\n\t//+----------------------------------------------------------+\t\r\n\tIf Select(\"MAXCTA\") > 0\r\n\t\tdbSelectArea(\"MAXCTA\")\r\n\t\tdbCloseArea()\r\n\tEndIf\r\n\r\n\tIf Select(\"CTACLI\") > 0\r\n\t\tdbSelectArea(\"CTACLI\")\r\n\t\tdbCloseArea()\r\n\tEndIf\t\t\r\n\r\n\t//+----------------------------------------------------------+\r\n\t//| Restaura a posição de memoria e ponteiro de arquivos     |\r\n\t//+----------------------------------------------------------+\t\r\n\tRestArea(aAreaOld) \r\n\t\r\n\t//+----------------------------------------------------------+\r\n\t//| Limpa Variaveis e memoria                                |\r\n\t//+----------------------------------------------------------+\r\n\taAreaOld := aSize(aAreaOld,0)\r\n\taAreaOld := Nil\t\t\r\n\r\nReturn\r\n"}}}
Content-Length: 703
{"jsonrpc":"2.0","id":1,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOkNDUGc4WEViRTl4YUdVTGRqZWY2TjhidlkrTGN5L0s1UzlHUkNnaFFNRnc9|djI6MTY1NzAzMTI3NTowOjE6MQ==.WZpjryN26fHQdYeNb0qrTED7lfczCX6PF7nWBAAgwv+QV0baNKLg+Go+T1rBZOQ2xGyboQBStR3rTbcy0c+esmU0JeFmTrPnQb1T3OvLzThiF2RA1ssE4kHN5xBQUVhuN7rnOJ+k9Hta2ezpB9n/Tj/KEwtKuJmsB3Vo7nRlYGqgYlVAN8Rh7spCBxCgCM3oXL5Taikub7XOK0GJERsKEODM0w6sSEodtKG/KoElCqC5Wdr52a5n1drMICOvjsULeT+F664JrlYnJrZ+y7oWcbKlBY8nJiz/sUJvn0eo/Zfn1cEY37EPDKtptNBKfMJ5J3LdBCYXgxWndhLf4g2jMQ==","serverName":"DEV_COMPILA","connType":3}}}
Content-Length: 681
{"jsonrpc":"2.0","id":2,"method":"$totvsserver/serverInformations","params":{"serverInformationsInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOkNDUGc4WEViRTl4YUdVTGRqZWY2TjhidlkrTGN5L0s1UzlHUkNnaFFNRnc9|djI6MTY1NzAzNzAzODowOjE6MQ==.bI3XwtVP4cA6nx7GkmciOLNsCtEL2ukZVg/4aJE28qYKsmQi3csP2OQPf52FxSpCEoi+Ik4tWkg39PrfxYbL+fYAQDFHhALG1m5gUXwTo8MWdFX0uH/HWv5FEj7ET5d7RQO77Os+Tcb2ZZIR1EoqbrAXalDSVs5QSgIDRm0YhYuae6sI1IrjKD32eQUyKf+1nqdOL4JGT5NUl8bwWuf0mGlzVYcukAUSJUnT1CA7SEFpOxTPJNnoqgoHTKbV6hNwWGj5Za6TzE13g//4XYRvrNjIvuUiwVBuh+1aEp5gzcx51YupohskS/QnChi4RLtiyDU1X1Hrmg1eOdUZK274Xg=="}}}
Content-Length: 183
{"jsonrpc":"2.0","id":3,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"includes","value":"D:\\TOTVS 12\\Microsiga\\Protheus\\include;"}}}
Content-Length: 2329
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/10_LIB/MArqExpoB.prw","languageId":"advpl","version":1,"text":"#include \"protheus.ch\"\r\n#include \"rwmake.ch\"\r\n#include \"tbiconn.ch\"  \r\n#INCLUDE \"TOTVS.CH\"\r\n#INCLUDE \"TopConn.CH\"\r\n\r\n/*\r\nPrograma ...: MArqExpoB.Prw\r\nUso ........: Programa para enviar o arquivo BI exportação base para sigaeis\r\nData .......: 04/01/2021\r\nFeito por ..: Bruno Lage Ferreira\r\nCopyright @1998-2001,2021\r\n*/ \r\n\r\nUser function MArqExpoB()\r\n***********************************************************************************************************\r\n*  \r\n*\r\n***  \r\n//Local _aDados := {}                         //Array com os campos enviados no TXT.\r\nLocal nHandle      := 0                       //Handle do arquivo texto.\r\nLocal cArqImp      := \"\"                      //Arquivo Txt a ser lido.\r\nLocal cNomeArquivo := \"\"\r\nPrivate aPerg      := {}\r\nPrivate cPerg      := \"IMPEXPBASE\"\r\n\r\nAadd(aPerg,{cPerg,\"Digite o ano do arqvivo? (04)\",\"C\",04,00,\"G\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"})\r\n\r\nU_Testasx1(cPerg,aPerg,.t.) \r\n\r\nIf ! Pergunte(cPerg,.T.)\r\n\tReturn\r\nEndIf\r\n\r\n//Alert(mv_par01)\r\n\r\ncArqImp := cGetFile(\"Arquivo .csv |*.csv\",\"Selecione o Arquivo CSV do Ponto.\",0,\"\",.T.,GETF_LOCALFLOPPY + GETF_LOCALHARD + GETF_NETWORKDRIVE)\r\nIf (nHandle := FT_FUse(cArqImp))== -1\r\n     MsgInfo(\"Erro ao tentar abrir arquivo.\",\"Atenção\")\r\n     Return(.T.)\r\nEndIf\r\n\r\nIf ! ApMsgYesNo(\"Confirma a importacao do arquivo \" + cArqImp +\" ???\", \"Confirmar\")\r\n     Return(.T.)\r\nEndIf\r\n\r\nCpyT2S( cArqImp, \"\\dirdoc\\Arquivo_de_export\", .t. )\r\n\r\ncNomeArquivo := RetFileName(cArqImp) + \".csv\"\r\n\r\nfErase(\"D:\\TOTVS 12\\Microsiga\\protheus_data\\dirdoc\\Arquivo_de_export\\EXP_\"+ mv_par01 +\".csv\")\r\n//Alert(\"apagou\")\r\nfRename(\"D:\\TOTVS 12\\Microsiga\\protheus_data\\dirdoc\\Arquivo_de_export\\\"+cNomeArquivo, \"D:\\TOTVS 12\\Microsiga\\protheus_data\\dirdoc\\Arquivo_de_export\\EXP_\"+ mv_par01 +\".csv\")\r\n//Alert(\"renomeou\")\r\n\r\n\r\nTCSPExec(\"SP_EXPORTBASE\",mv_par01)\r\n\r\nMsgInfo(\"Arquivo importado com sucesso!\",\"Atenção\")\r\n\r\n\r\n\r\nReturn(.T.)\r\n"}}}
Content-Length: 164
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/10_LIB/MArqExpoB.prw"}}}
Content-Length: 148
{"jsonrpc":"2.0","id":4,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":5,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 153
{"jsonrpc":"2.0","id":6,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 145
{"jsonrpc":"2.0","id":7,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 148
{"jsonrpc":"2.0","id":8,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":9,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 154
{"jsonrpc":"2.0","id":10,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":11,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 76
{"jsonrpc":"2.0","method":"$/setTraceNotification","params":{"value":"off"}}
