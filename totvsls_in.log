Content-Length: 3121
{"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":1792,"clientInfo":{"name":"vscode","version":"1.70.0"},"rootPath":"d:\\TOTVS 12\\Microsiga\\Protheus\\ProjetoVSCode","rootUri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","capabilities":{"workspace":{"applyEdit":true,"workspaceEdit":{"documentChanges":true,"resourceOperations":["create","rename","delete"],"failureHandling":"textOnlyTransactional"},"didChangeConfiguration":{"dynamicRegistration":true},"didChangeWatchedFiles":{"dynamicRegistration":true},"symbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]}},"executeCommand":{"dynamicRegistration":true},"configuration":true,"workspaceFolders":true},"textDocument":{"publishDiagnostics":{"relatedInformation":true,"versionSupport":false,"tagSupport":{"valueSet":[1,2]}},"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"contextSupport":true,"completionItem":{"snippetSupport":true,"commitCharactersSupport":true,"documentationFormat":["markdown","plaintext"],"deprecatedSupport":true,"preselectSupport":true,"tagSupport":{"valueSet":[1]}},"completionItemKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]}},"hover":{"dynamicRegistration":true,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":true,"signatureInformation":{"documentationFormat":["markdown","plaintext"],"parameterInformation":{"labelOffsetSupport":true}},"contextSupport":true},"definition":{"dynamicRegistration":true,"linkSupport":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"hierarchicalDocumentSymbolSupport":true},"codeAction":{"dynamicRegistration":true,"isPreferredSupport":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}}},"codeLens":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true,"prepareSupport":true},"documentLink":{"dynamicRegistration":true,"tooltipSupport":true},"typeDefinition":{"dynamicRegistration":true,"linkSupport":true},"implementation":{"dynamicRegistration":true,"linkSupport":true},"colorProvider":{"dynamicRegistration":true},"foldingRange":{"dynamicRegistration":true,"rangeLimit":5000,"lineFoldingOnly":true},"declaration":{"dynamicRegistration":true,"linkSupport":true},"selectionRange":{"dynamicRegistration":true}},"window":{"workDoneProgress":true}},"initializationOptions":{"launchArgs":["--log-file=totvsls.log","--record=totvsls"]},"trace":"off","workspaceFolders":[{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","name":"ProjetoVSCode"}]}}
Content-Length: 52
{"jsonrpc":"2.0","method":"initialized","params":{}}
Content-Length: 4044
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/05_ESTOQUE/A330DECC.prw","languageId":"advpl","version":1,"text":"#include \"protheus.ch\"\r\n#include \"topconn.ch\"\r\n/*\r\n{Protheus.doc} A330DECC\r\nPE C.custo \r\n@author Nilton (TOTVS)\r\n@since 14/07/2022\r\n@version 1.0\r\n*/\r\nUser Function A330DECC()\r\n\tLocal cCod      := PARAMIXB[1]\r\n\tLocal dDataFim  := PARAMIXB[2]\r\n\tLocal cGrupo    := PARAMIXB[3]\r\n\tLocal lGrupo    := PARAMIXB[4]\r\n\tLocal atemp\r\n\tLocal nqte      := 0\r\n\tLocal cperiodo  := PADL(Alltrim(Str(Month(dDataFim))),2,\"0\") + \"/\"+Alltrim(Str(Year(dDataFim)))\r\n\tatemp := fA330Sal(cCod,dDataFim,cGrupo,lGrupo) //Funcao padrao TOTVS calculo custo\r\n\t//B1_TIPO = 'MO'\r\n\tIf Posicione(\"SB1\",1,xFilial(\"SB1\")+CCODPESQ,\"B1_TIPO\") == \"MO\"\r\n\t\tIf Posicione(\"SB1\",1,xFilial(\"SB1\")+CCODPESQ,\"B1_PRV1\") > 0 //Achou valor fixo para valorizar\r\n\t\t\tnqte := ABS(fQtdSB2(CCODPESQ))\r\n\t\t\tatemp[1] := nqte * Posicione(\"SB1\",1,xFilial(\"SB1\")+CCODPESQ,\"B1_PRV1\")\r\n\t\tElseIf Posicione(\"SZG\",1,xFilial(\"SZG\")+cperiodo+cCod,\"ZG_VALOR\") > 0\r\n\t\t\tatemp[1] := Posicione(\"SZG\",1,xFilial(\"SZG\")+cperiodo+cCod,\"ZG_VALOR\")\r\n\t\tEndIf\r\n\tEndIf\r\nReturn atemp\r\n/*\r\n{Protheus.doc} fA330Sal\r\nFuncao padrao para trazer o valor do centro de custos\r\n@author Nilton (TOTVS)\r\n@since 14/07/2022\r\n@version 1.0\r\n*/\r\nStatic Function fA330Sal(cCod,dDataFim,cGrupo,lgrupo)\r\n\tLocal aSaldos[5]\r\n\tLocal ncont := 0\r\n\tLocal dDataIni := GetMV(\"MV_ULMES\")\r\n\tAFILL(aSaldos,0)\r\n\tcCod := padr(cCod,Len(CTT->CTT_CUSTO))\r\n\tFor nCont := 1 To 5\r\n\t\t// Verifica se moeda devera ser considerada\r\n\t\tIf nCont # 1 .And. !(Str(nCont,1,0) $ cMV_MOEDACM)\r\n\t\t\tLoop\r\n\t\tEndIf\r\n\t\t//-- Somo o saldo atual DEBITO - CREDITO\r\n\t\tcQuery := \"SELECT SUM(CQ3.CQ3_DEBITO) DEBITO, SUM(CQ3.CQ3_CREDIT) CREDITO \"\r\n\t\tcQuery += \" FROM \"+RetSqlName(\"CQ3\")+\" CQ3 \"\r\n\t\tcQuery += \" WHERE EXISTS(SELECT CT1_CONTA FROM \"+RetSqlName(\"CT1\")\r\n\t\tcQuery += \" WHERE CT1_FILIAL = '\" + xFilial(\"CT1\") + \"' AND \"\r\n\t\t//-- Considera grupo na filtragem caso tenha conteudo definido\r\n\t\tIf !Empty(cGrupo) .And. lGrupo\r\n\t\t\tcQuery += \" CT1_GRUPO = '\"+cGrupo+\"' AND \"\r\n\t\tEndIf\r\n\t\tcQuery += \"CT1_CONTA = CQ3.CQ3_CONTA AND D_E_L_E_T_ = ' ') AND \"\r\n\t\tIf !lCusEmp\r\n\t\t\tcQuery += \"\tCQ3.CQ3_FILIAL ='\"+xFilial(\"CQ3\")+\"' AND \"\r\n\t\tElse\r\n\t\t\tIf FWSM0Layout() <> \"FF\"\r\n\t\t\t\tcQuery += cFuncSubs+\"(CQ3.CQ3_FILIAL,1,\"+cvaltochar(len(fwcodemp()))+\") = '\"+FwCodEmp()+\"' And \"\r\n\t\t\tEndIf\r\n\t\tEndIf\r\n\t\tcQuery += \" CQ3.CQ3_CCUSTO = '\" + cCod + \"' AND \"\r\n\t\tcQuery += \"CQ3.CQ3_MOEDA ='\"+StrZero(nCont,2)+\"' AND \"\r\n\t\tcQuery += \"CQ3.CQ3_TPSALD ='1' AND \"\r\n\t\tcQuery += \"CQ3.D_E_L_E_T_ = ' ' AND \"\r\n\t\tcQuery += \"CQ3.CQ3_DATA >= '\"+DTOS(dDataIni+1)+\"' AND \"\r\n\t\tcQuery += \"CQ3.CQ3_DATA <= '\"+DTOS(dDataFim)+\"'\"\r\n\t\tdbUseArea(.T.,\"TOPCONN\",TcGenQry(,,cQuery),\"SLDATU\",.T.,.F.)\r\n\t\taSaldos[nCont] \t+= (SLDATU->DEBITO - SLDATU->CREDITO)\r\n\t\tDbCloseArea()\r\n\tNext nCont\r\nReturn aSaldos\r\n/*\r\n{Protheus.doc} fQtdSB2\r\nTrazer a quantidade encontrada como saldo final do MOD/CCUSTO\r\n@author Nilton (TOTVS)\r\n@since 14/07/2022\r\n@version 1.0\r\n*/\r\nStatic Function fQtdSB2(cCod)\r\nLocal aArea    := GetArea()\r\nLocal cSql     := \"\"\r\nLocal nret     := 0\r\n\r\ncsql := \" SELECT SUM(B2_QFIM) TOTPESO\"+CHR(10)\r\ncsql += \" from \" + RetSqlName(\"SB2\")+\" SB2 WITH (NOLOCK)\"+CHR(10)\r\ncsql +=  \" where SB2.B2_FILIAL =  '\"+xFilial(\"SB2\")+\"' \" +CHR(10)\r\ncsql +=  \" and SB2.B2_COD = '\"+cCod+\"'\"+CHR(10)\r\ncsql +=  \" and SB2.D_E_L_E_T_ = ' '  \"+CHR(10)\r\nTcQuery csql New Alias \"ctrabalho\"\r\nDbGotop()\r\n\r\nIf !eof()\r\n\tnret := ctrabalho->TOTPESO\r\nEndIf\r\n\r\nctrabalho->(DbCloseArea())\r\nRestArea(aArea)\r\nReturn(nret)\r\n"}}}
Content-Length: 2459
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/05_ESTOQUE/MTA105OK.PRW","languageId":"advpl","version":1,"text":"#INCLUDE \"Rwmake.ch\"\r\n#INCLUDE \"topconn.ch\"\r\n\r\n/*            \r\nBRUNO LAGE FERREIRA\r\nSIGAWISE\r\n\r\n06/12/2019 - \r\n05/04/2022 - If !IsBlind()  para funcionar via aplicativo do MNT\r\n*/\r\n            \r\nUser Function MTA105OK()\r\n*****************************************************************************************\r\n* //VALIDA DADOS NA GRAÇÃO DA GERAÇÃO DOS DADOS RAT. C.C.\r\n*\r\n*****\r\nLocal lRet      := .T.\r\nLocal nX        := 0\r\nLocal nY        := 0\r\nLocal cAvisoMsg := \"\"\r\n\r\n\r\nIf !IsBlind()    \r\n\tIf !funname() $ \"MNTA420/MNTA300/MNTA990/MNTA295/MNTA265/MNTA410/MNTA120/MNTA902/MNTA365\"\r\n\t\tIf Len(aPesNota) <> 0\r\n\t\t\tIf Len(ACPISGS) == 0\r\n\t\t\t\t//Aviso(\"Aviso!\",\"Preencha o centro de custos na tela de rateios! OUTRAS AÇOES > RAT CC \",{\"OK\"})\r\n\t\t\t\t//lRet := .F.\r\n\t\t\tEndIf\r\n\r\n\t\t\tFor nX := 1  to Len(aPesNota)\r\n\t\t\t\taPesNota[nX][6] := 0\r\n\t\t\tNext nX\r\n\r\n\t\t\tFor nX := 1  to Len(aPesNota)\r\n\t\t\t\tFor nY := 1  to Len(aCols)\r\n\t\t\t\t\tIF AllTrim(aPesNota[nX][1]) == AllTrim(aCols[nY][2])\r\n\t\t\t\t\t\taPesNota[nX][6] := aPesNota[nX][6] + aCols[nY][5]\r\n\t\t\t\t\tEndIf\r\n\t\t\t\tNext nY\r\n\t\t\tNext nX\r\n\r\n\t\t\tcAvisoMsg := \"Encontrado diferenças entre a nota e os item de baixas!\" + chr(13)+chr(10)\r\n\t\t\tFor nX := 1  to Len(aPesNota)\r\n\t\t\t\tIf aPesNota[nX][6] <> aPesNota[nX][2]\r\n\t\t\t\t\tlRet := .F.\r\n\t\t\t\t\tdbSelectArea(\"SB1\")\r\n\t\t\t\t\tdbSetOrder(1)\r\n\t\t\t\t\tdbSeek( xFilial(\"SB1\") + AllTrim(aPesNota[nX][1]))\r\n\t\t\t\t\tcAvisoMsg  := cAvisoMsg + \" -Item: [\" + AllTrim(SB1->B1_DESC) + \"] -> Qtd. na Nf-e:\" + AllTrim(str(aPesNota[nX][2])) + \" Qtd. Baixa:\" + AllTrim(str(aPesNota[nX][6])) +\" .\"+ chr(13)+chr(10) \r\n\t\t\t\tEndIf\r\n\t\t\tNext nX\r\n\t\t\tIf lRet == .F.\r\n\t\t\t\tAviso(\"Aviso!\",cAvisoMsg,{\"OK\"})\r\n\t\t\tEndIf\r\n\t\tEndIf\r\n\tEndIf \r\nEndIf\r\n\r\nReturn(lRet)\r\n\r\nUser Function MT105FIM()\r\n*****************************************************************************************\r\n* //Chamado 5361 - ERRO NA HORA DE DA BAIXA\r\n*\r\n*****\r\nLocal nOpcap := PARAMIXB\r\n\r\nIF TYPE (\"aPesNota\") == \"A\"\r\n\taPesNota := {}\r\nendif\r\n\r\nReturn\r\n"}}}
Content-Length: 703
{"jsonrpc":"2.0","id":1,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNDQ3NTI2MTowOjE6MQ==.CS+UXyBl+vXwyprImD8xecniM2Ka4VVuqKS7XSYbEy89rEpj2xiP611Pa2mqPNkwL+XrIkufc5Zwtf1hFMRBtU4gPaIIO8cZAUDp8B5nlfoOL8yuJUaFlKS2OnE42TaB6CgdT3ynO2lgG8mghDOASf4hDYai11h65LpVpr9Hhjv3I6Ej5TJou0f+BfUyhCHeoa7MSWmw8XbumSZ3RXb7erkbQcKxH/yetiagQN6EXQ9ddh3Yyj9wA1Pyou+/DuV01l9P+YD50NHBaySSv1UM2NErlb2R80Vm6tYduWtsK8XAWtc57OeCRyurQAleGkxGCrayPDVhGpqjC58i0N/aag==","serverName":"DEV_COMPILA","connType":3}}}
Content-Length: 681
{"jsonrpc":"2.0","id":2,"method":"$totvsserver/serverInformations","params":{"serverInformationsInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNTMyMDM4MDowOjE6MQ==.fv6OFh+jUPJFYaF/8efycAfo2aK8i7mB/nOCgy4O9yOBeG+lli3EAtAU4i9eq2yea6iqcRTu0nz1HZFLty9oTt9M7QM+QJTq4HIGCPPF8oJcePAr9GRr6mLdZUp0bh/hUMQxSRrvYKA1lp+z4bh8w1djf/u2cZaUfvlDlrT8M417Gb8gxUw+wGSYEdb37CY+jwA0DUIhutOrR9uJ31q0vx3FaL64bw5KudYLV5itg74yLcqYPRs71cdy+Z6ZvPhEC5BM81Yh9XEmS8+9BlQ5o9/wbTNjCNm7WWRuzLQb5VJZZOOjT7eyfs2SVxb91irYdwz2p7gpB/ryA9i+FG3+qw=="}}}
Content-Length: 183
{"jsonrpc":"2.0","id":3,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"includes","value":"D:\\TOTVS 12\\Microsiga\\Protheus\\include;"}}}
Content-Length: 1882
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT103DCF.PRW","languageId":"advpl","version":1,"text":"#INCLUDE \"TopConn.CH\"\r\n#INCLUDE \"RWMAKE.CH\"\r\n#INCLUDE \"PROTHEUS.CH\"   \r\n#INCLUDE \"TBICONN.CH\"\r\n            \r\n/*\r\nPrograma ...: MT103DCF.Prw\r\nUso ........: MT103DCF.Prw - Habilita botão Mais Inf. e acrescenta campos na aba DANFE \r\nData .......: 16/09/2020\r\nFeito por ..: Bruno Lage Ferreira\r\nCopyright @1998-2001,2020\r\n\r\nMV_MRCVLM1\r\n*/ \r\nUser Function MT103DCF()\r\n************************************************************************************************\r\n*\r\n*\r\n****\r\nLocal lInclui    := PARAMIXB[1]\r\nLocal lAltera    := PARAMIXB[2]\r\nLocal lVisual    := PARAMIXB[3]\r\nLocal aCamposPar := PARAMIXB[4]\r\nLocal aCamposRet := {}\t\r\n\r\nLocal oMarca1\r\nLocal cMarca1 := space(60)  \r\nLocal oNumer1\r\nLocal cNumer1 := space(60)\r\n/*\r\nF1_MARCA1\r\nF1_NUMER1\r\n*/\r\nDEFINE MSDIALOG oDlg TITLE \"Informações de Blocos:\" FROM 0,0 TO 140,360 OF oMainWnd PIXEL\r\n \r\n @ 16,10 SAY RetTitle(\"F1_MARCA1\")    \t\t\t\tSIZE 45,09  OF oDlg PIXEL\r\n @ 14,50 MSGET oMarca1 VAR cMarca1  PICTURE(\"@!\")  \tSIZE 60,09  OF oDlg PIXEL\r\n\r\n @ 36,10 SAY RetTitle(\"F1_NUMER1\")    \t\t\t\tSIZE 45,09  OF oDlg PIXEL\r\n @ 34,50 MSGET oNumer1 VAR cNumer1  PICTURE(\"@!\")  \tSIZE 60,09  OF oDlg PIXEL \r\n \r\n //DEFINE SBUTTON FROM 50,143 TYPE 1 ACTION GravMot(aCamposRet,cCodigo)ENABLE OF oDlg     \r\n \r\n DEFINE SBUTTON FROM 50,143 TYPE 1 ACTION {||oDlg:End()}ENABLE OF oDlg\r\n                                   \r\nACTIVATE MSDIALOG oDlg CENTERED\r\n \r\n //PARAMIXB[4]:={\"F1_MOTCANC\",cCodigo}\r\naCamposPar:={{\"F1_MARCA1\",AllTrim(cMarca1)},{\"F1_NUMER1\",AllTrim(cNumer1)}}\r\n     \r\nReturn aCamposPar\r\n\r\n"}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT103DCF.PRW"}}}
Content-Length: 1836
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MSGDECRETO.PRW","languageId":"advpl","version":1,"text":"#include \"protheus.ch\"\r\n#include \"rwmake.ch\"\r\n#include \"tbiconn.ch\"  \r\n#INCLUDE \"TOTVS.CH\"\r\n#INCLUDE \"TOPCONN.CH\"\r\n\r\n/*\r\nPrograma ...: MsgDecreto.Prw\r\nUso ........: Mensagem Automatica para nota de creto\r\nData .......: 28/08/2019\r\nFeito por ..: Bruno Lage Ferreira\r\nCopyright @1998-2001,2019\r\n*/ \r\n\r\nUser Function MsgDecreto()  \r\n************************************************************************************************************\r\n* Alert(u_MsgDecreto())\r\n*\r\n***\r\nLocal cQuery    := \"\"\r\nLocal cMsgNfDec := \"\"\r\n\r\ncQuery := \"  SELECT D1_DOC,\r\ncQuery += \"   \t\tD1_SERIE,\r\ncQuery += \" \t\tD1_LOTECTL,\r\ncQuery += \" \t\tdbo.FRETCHPENT(D1_DOC,D1_SERIE,D1_LOTECTL) AS SUBLOTES\r\ncQuery += \"     FROM SD1010 A\r\ncQuery += \"   WHERE A.D_E_L_E_T_ =''\r\ncQuery += \"      AND D1_DOC   = '\"+ SF1->F1_DOC   +\"'\r\ncQuery += \"      AND D1_SERIE = '\"+ SF1->F1_SERIE +\"'\r\ncQuery += \"      AND D1_FORNECE+D1_LOJA = '00016501'\r\ncQuery += \"      AND LEFT(D1_COD,2)='CH'\r\ncQuery += \"  \t AND D1_NUMLOTE <> ''\r\ncQuery += \" GROUP BY D1_DOC,\r\ncQuery += \"  \t     D1_SERIE,\r\ncQuery += \" \t\t D1_LOTECTL\r\n \r\ntcQuery cQuery alias TRB new\r\ndbSelectArea(\"TRB\")\r\ndbGoTop()\r\nDo While !EOF()  \r\n\r\n\tcMsgNfDec  := cMsgNfDec + \"| LOTE:\" + TRB->D1_LOTECTL + \"CHAPAS:\" +  TRB->SUBLOTES\r\n\r\n\tdbSelectArea(\"TRB\")\r\n\tdbSkip()\r\nEndDo    \r\n\r\ndbSelectArea(\"TRB\") \r\ndbCloseArea()\r\n\r\nIF !EMPTY(cMsgNfDec)\r\n\tcMsgNfDec := \"NF:\" + SF1->F1_DOC + \"/\" +SF1->F1_SERIE + \" \" + cMsgNfDec\r\nEndIf\r\n\r\nReturn(cMsgNfDec)"}}}
Content-Length: 169
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MSGDECRETO.PRW"}}}
Content-Length: 158503
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/ITMmatr110.prx","languageId":"advpl","version":1,"text":"#INCLUDE \"MATR110.CH\"\r\n#INCLUDE \"PROTHEUS.CH\"\r\n#INCLUDE \"REPORT.CH\"\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ MATR110  ³ Autor ³ Alexandre Inacio Lemes³ Data ³06/09/2006³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Pedido de Compras e Autorizacao de Entrega                 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ MATR110(void)                                              ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ Generico SIGACOM                                           ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nUser Function SWITMMatr110( cAlias, nReg, nOpcx )\r\n\r\nLocal oReport\r\nLocal lTRepInUse := .T.\r\n\r\nPRIVATE lAuto := (nReg!=Nil)\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³Para versoes localizadas em TReport R4 e usado o MATR110, a chamada e       ³\r\n//³realizada atraves do MATR111 onde a funcao TRepInUse() e executada para     ³\r\n//³selecionar o tipo de impressao R3 ou R4, este tratamento e para impedir que ³\r\n//³a pergunta seja apresentada 2 vezes.                                        ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf FunName() == Alltrim(\"MATR111\") .Or. (cPaisLoc <> \"BRA\" .And. FunName() == Alltrim(\"MATA121\"))\r\n\tlTRepInUse := .T.\r\nElse                                    \r\n\tlTRepInUse := TRepInUse()\r\nEndIf\r\n\r\nIf lTRepInUse\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³Interface de impressao                                                  ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\toReport:= ReportDef(nReg, nOpcx)\r\n\toReport:PrintDialog()\r\nElse\r\n\tu_ITMMATR110R3( cAlias, nReg, nOpcx )\r\nEndIf\r\n\r\nReturn\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Programa  ³ ReportDef³Autor  ³Alexandre Inacio Lemes ³Data  ³06/09/2006³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Pedido de Compras / Autorizacao de Entrega                 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ nExp01: nReg = Registro posicionado do SC7 apartir Browse  ³±±\r\n±±³          ³ nExp02: nOpcx= 1 - PC / 2 - AE                             ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Retorno   ³ oExpO1: Objeto do relatorio                                ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function ReportDef(nReg,nOpcx)\r\n\r\nLocal cTitle   := STR0003 // \"Emissao dos Pedidos de Compras ou Autorizacoes de Entrega\"\r\nLocal oReport\r\nLocal oSection1\r\nLocal oSection2\r\nLocal nTamCdProd:= TamSX3(\"C7_PRODUTO\")[1]\r\n\r\nIf Type(\"lAuto\") == \"U\"\r\n\tlAuto := (nReg!=Nil)\r\nEndif\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Variaveis utilizadas para parametros                         ³\r\n//³ mv_par01               Do Pedido                             ³\r\n//³ mv_par02               Ate o Pedido                          ³\r\n//³ mv_par03               A partir da data de emissao           ³\r\n//³ mv_par04               Ate a data de emissao                 ³\r\n//³ mv_par05               Somente os Novos                      ³\r\n//³ mv_par06               Campo Descricao do Produto    \t     ³\r\n//³ mv_par07               Unidade de Medida:Primaria ou Secund. ³\r\n//³ mv_par08               Imprime ? Pedido Compra ou Aut. Entreg³\r\n//³ mv_par09               Numero de vias                        ³\r\n//³ mv_par10               Pedidos ? Liberados Bloqueados Ambos  ³\r\n//³ mv_par11               Impr. SC's Firmes, Previstas ou Ambas ³\r\n//³ mv_par12               Qual a Moeda ?                        ³\r\n//³ mv_par13               Endereco de Entrega                   ³\r\n//³ mv_par14               todas ou em aberto ou atendidos       ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nPergunte(\"MTR110\",.F.)\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³Criacao do componente de impressao                                      ³\r\n//³                                                                        ³\r\n//³TReport():New                                                           ³\r\n//³ExpC1 : Nome do relatorio                                               ³\r\n//³ExpC2 : Titulo                                                          ³\r\n//³ExpC3 : Pergunte                                                        ³\r\n//³ExpB4 : Bloco de codigo que sera executado na confirmacao da impressao  ³\r\n//³ExpC5 : Descricao                                                       ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\noReport:= TReport():New(\"MATR110\",cTitle,\"MTR110\", {|oReport| ReportPrint(oReport,nReg,nOpcx)},STR0001+\" \"+STR0002)\r\noReport:SetPortrait()\r\noReport:HideParamPage()\r\noReport:HideHeader()\r\noReport:HideFooter()\r\noReport:SetTotalInLine(.F.)\r\noReport:DisableOrientation()\r\noReport:ParamReadOnly(lAuto)\r\noSection1:= TRSection():New(oReport,STR0102,{\"SC7\",\"SM0\",\"SA2\"}, /* <aOrder> */ ,;\r\n\t\t\t\t\t\t\t\t /* <.lLoadCells.> */ , , /* <cTotalText>  */, /* !<.lTotalInCol.>  */, /* <.lHeaderPage.>  */,;\r\n\t\t\t\t\t\t\t\t /* <.lHeaderBreak.> */, /* <.lPageBreak.>  */, /* <.lLineBreak.>  */, /* <nLeftMargin>  */,;\r\n\t\t\t\t\t\t\t\t .T./* <.lLineStyle.>  */, /* <nColSpace>  */,.T. /*<.lAutoSize.> */, /*<cSeparator> */,;\r\n\t\t\t\t\t\t\t\t /*<nLinesBefore>  */, /*<nCols>  */, /* <nClrBack> */, /* <nClrFore>  */)\r\noSection1:SetReadOnly()\r\noSection1:SetNoFilter(\"SA2\")\r\n\r\nTRCell():New(oSection1,\"M0_NOMECOM\",\"SM0\",STR0087      ,/*Picture*/,49,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"M0_ENDENT\" ,\"SM0\",STR0088      ,/*Picture*/,48,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"M0_CEPENT\" ,\"SM0\",STR0089      ,/*Picture*/,10,/*lPixel*/,{|| Trans(SM0->M0_CEPENT,PesqPict(\"SA2\",\"A2_CEP\")) })\r\nTRCell():New(oSection1,\"M0_CIDENT\" ,\"SM0\",STR0090      ,/*Picture*/,20,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"M0_ESTENT\" ,\"SM0\",STR0091      ,/*Picture*/,11,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"M0_CGC\"    ,\"SM0\",STR0124      ,/*Picture*/,18,/*lPixel*/,{|| Transform(SM0->M0_CGC,PesqPict(\"SA2\",\"A2_CGC\")) })\r\nIf cPaisLoc == \"BRA\"\r\n\tTRCell():New(oSection1,\"M0IE\"  ,\"   \",STR0041      ,/*Picture*/,18,/*lPixel*/,{|| InscrEst()})\r\nEndIf\r\nTRCell():New(oSection1,\"M0_TEL\"    ,\"SM0\",STR0092      ,/*Picture*/,14,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"M0_FAX\"    ,\"SM0\",STR0093      ,/*Picture*/,34,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_NOME\"   ,\"SA2\",/*Titulo*/   ,/*Picture*/,40,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_COD\"    ,\"SA2\",/*Titulo*/   ,/*Picture*/,20,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_LOJA\"   ,\"SA2\",/*Titulo*/   ,/*Picture*/,04,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_END\"    ,\"SA2\",/*Titulo*/   ,/*Picture*/,40,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_BAIRRO\" ,\"SA2\",/*Titulo*/   ,/*Picture*/,20,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_CEP\"    ,\"SA2\",/*Titulo*/   ,/*Picture*/,08,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_MUN\"    ,\"SA2\",/*Titulo*/   ,/*Picture*/,15,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_EST\"    ,\"SA2\",/*Titulo*/   ,/*Picture*/,02,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"A2_CGC\"    ,\"SA2\",/*Titulo*/   ,/*Picture*/,/*Tamanho*/,/*lPixel*/,/*{|| code-block de impressao }*/)\r\nTRCell():New(oSection1,\"INSCR\"     ,\"   \",If( cPaisLoc$\"ARG|POR|EUA\",space(11) , STR0095 ),/*Picture*/,18,/*lPixel*/,{|| If( cPaisLoc$\"ARG|POR|EUA\",space(18), SA2->A2_INSCR ) })\r\nTRCell():New(oSection1,\"FONE\"      ,\"   \",STR0094      ,/*Picture*/,25,/*lPixel*/,{|| \"(\"+Substr(SA2->A2_DDD,1,3)+\") \"+Substr(SA2->A2_TEL,1,15)})\r\nTRCell():New(oSection1,\"FAX\"       ,\"   \",STR0093      ,/*Picture*/,25,/*lPixel*/,{|| \"(\"+Substr(SA2->A2_DDD,1,3)+\") \"+SubStr(SA2->A2_FAX,1,15)})\r\n\r\noSection1:Cell(\"A2_BAIRRO\"):SetCellBreak()\r\noSection1:Cell(\"A2_CGC\"   ):SetCellBreak()\r\noSection1:Cell(\"INSCR\"    ):SetCellBreak()\r\n\r\noSection2:= TRSection():New(oSection1, STR0103, {\"SC7\",\"SB1\"}, /* <aOrder> */ ,;\r\n\t\t\t\t\t\t\t\t /* <.lLoadCells.> */ , , /* <cTotalText>  */, /* !<.lTotalInCol.>  */, /* <.lHeaderPage.>  */,;\r\n\t\t\t\t\t\t\t\t /* <.lHeaderBreak.> */, /* <.lPageBreak.>  */, /* <.lLineBreak.>  */, /* <nLeftMargin>  */,;\r\n\t\t\t\t\t\t\t\t /* <.lLineStyle.>  */, /* <nColSpace>  */, /*<.lAutoSize.> */, /*<cSeparator> */,;\r\n\t\t\t\t\t\t\t\t /*<nLinesBefore>  */, /*<nCols>  */, /* <nClrBack> */, /* <nClrFore>  */)\r\n\r\noSection2:SetCellBorder(\"ALL\",,,.T.)\r\noSection2:SetCellBorder(\"RIGHT\")                        \r\noSection2:SetCellBorder(\"LEFT\")                                   \r\n\r\nTRCell():New(oSection2,\"C7_NUM\"\t\t\t,\"SC7\",STR0129   \t,/*Picture*/)                                                                                \r\nTRCell():New(oSection2,\"C7_ITEM\"    \t,\"SC7\",/*Titulo*/\t,/*Picture*/)\r\nTRCell():New(oSection2,\"C7_PRODUTO\" \t,\"SC7\",/*Titulo*/\t,/*Picture*/,25)\r\nTRCell():New(oSection2,\"DESCPROD\"   \t,\"   \",STR0097   \t,/*Picture*/,100,/*lPixel*/, {|| cDescPro},,,,,,.F.)\r\nTRCell():New(oSection2,\"C7_UM\"      \t,\"SC7\",STR0115   \t,/*Picture*/,04,/*lPixel*/,/* */,\"CENTER\",,\"CENTER\")\r\nTRCell():New(oSection2,\"C7_QUANT\"   \t,\"SC7\",/*Titulo*/\t,/*Picture*/,14,/*lPixel*/,/* */,\"RIGHT\",,\"RIGHT\")\r\nTRCell():New(oSection2,\"C7_SEGUM\"   \t,\"SC7\",STR0118\t\t,/*Picture*/,07,/*lPixel*/,/* */,\"CENTER\",,\"CENTER\")\r\nTRCell():New(oSection2,\"C7_QTSEGUM\" \t,\"SC7\",/*Titulo*/\t,/*Picture*/,14,/*lPixel*/,/* */,\"RIGHT\",,\"RIGHT\")\r\nTRCell():New(oSection2,\"PRECO\"      \t,\"   \",STR0098\t\t,/*Picture*/,20,/*lPixel*/,{|| nVlUnitSC7 },\"RIGHT\",,\"RIGHT\")\r\nTRCell():New(oSection2,\"C7_IPI\"     \t,\"SC7\",STR0119\t\t,/*Picture*/,10,/*lPixel*/,/* */,\"RIGHT\",,\"RIGHT\")\r\nTRCell():New(oSection2,\"TOTAL\"     \t\t,\"   \",STR0099\t\t,/*Picture*/,20,/*lPixel*/,{|| nValTotSC7 },\"RIGHT\",,\"RIGHT\")\r\nTRCell():New(oSection2,\"C7_DATPRF\"  \t,\"SC7\",/*Titulo*/\t,/*Picture*/,15,/*lPixel*/,/* */,\"CENTER\",,\"CENTER\")\r\nTRCell():New(oSection2,\"C7_CC\"      \t,\"SC7\",STR0066\t\t,/*Picture*/,10,/*lPixel*/,/* */,\"CENTER\",,\"CENTER\")\r\nTRCell():New(oSection2,\"C7_NUMSC\"   \t,\"SC7\",STR0123\t\t,/*Picture*/,16,/*lPixel*/,/* */,\"CENTER\",,\"CENTER\")\r\nTRCell():New(oSection2,\"OPCC\"       \t,\"   \",STR0100  \t,/*Picture*/,TamSX3(\"C7_OP\")[1],/*lPixel*/,{|| cOPCC },,,,,,.F.)          \r\n\r\noSection2:Cell(\"C7_PRODUTO\"):SetLineBreak()\r\noSection2:Cell(\"DESCPROD\"):SetLineBreak()\r\noSection2:Cell(\"C7_CC\"):SetLineBreak()\r\noSection2:Cell(\"OPCC\"):SetLineBreak()\r\noSection2:Cell(\"C7_NUMSC\"):SetLineBreak()\r\n\r\nReturn(oReport)\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Programa  ³ReportPrin³ Autor ³Alexandre Inacio Lemes ³Data  ³06/09/2006³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Emissao do Pedido de Compras / Autorizacao de Entrega      ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ ReportPrint(ExpO1,ExpN1,ExpN2)                             ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ ExpO1 = Objeto oReport                      \t              ³±±\r\n±±³          ³ ExpN1 = Numero do Recno posicionado do SC7 impressao Menu  ³±±\r\n±±³          ³ ExpN2 = Numero da opcao para impressao via menu do PC      ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Retorno   ³Nenhum                                                      ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ExpO1: Objeto Report do Relatório                           ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function ReportPrint(oReport,nReg,nOpcX)\r\n\r\nLocal oSection1   := oReport:Section(1)\r\nLocal oSection2   := oReport:Section(1):Section(1)\r\n\r\nLocal aRecnoSave  := {}\r\nLocal aPedido     := {}\r\nLocal aPedMail    := {}\r\nLocal aValIVA     := {}\r\n\r\nLocal cNumSC7\t\t:= Len(SC7->C7_NUM)\r\nLocal cCondicao\t\t:= \"\"\r\nLocal cFiltro\t\t:= \"\"\r\nLocal cComprador\t:= \"\"\r\nLOcal cAlter\t\t:= \"\"\r\nLocal cAprov\t\t:= \"\"\r\nLocal cTipoSC7\t\t:= \"\"\r\nLocal cCondBus\t\t:= \"\"\r\nLocal cMensagem\t\t:= \"\"\r\nLocal cVar\t\t\t:= \"\"\r\nLocal cPictVUnit\t:= PesqPict(\"SC7\",\"C7_PRECO\",15)\r\nLocal cPictVTot\t\t:= PesqPict(\"SC7\",\"C7_TOTAL\",, mv_par12)\r\nLocal lNewAlc\t\t:= .F.\r\nLocal lLiber\t\t:= .F.\r\nLocal lRejeit\t\t:= .F.\r\nLocal lRet\t\t\t:= .T.\r\n\r\nLocal nRecnoSC7   \t:= 0\r\nLocal nTotalsX3   \t:= 0\r\nLocal nRecnoSM0   \t:= 0\r\nLocal nX          \t:= 0\r\nLocal nY          \t:= 0\r\nLocal nVias       \t:= 0\r\nLocal nTxMoeda    \t:= 0\r\nLocal nTpImp\t    := IIF(ValType(oReport:nDevice)!=Nil,oReport:nDevice,0) // Tipo de Impressao\r\nLocal nPageWidth  \t:= IIF(nTpImp==1.Or.nTpImp==6,2435,2435) // oReport:PageWidth()\r\nLocal nPrinted    \t:= 0\r\nLocal nValIVA     \t:= 0\r\nLocal nTotIpi\t    := 0\r\nLocal nTotIcms    \t:= 0\r\nLocal nTotDesp    \t:= 0\r\nLocal nTotFrete   \t:= 0\r\nLocal nTotalNF    \t:= 0\r\nLocal nTotSeguro  \t:= 0\r\nLocal nLinPC\t    := 0\r\nLocal nLinObs     \t:= 0\r\nLocal nDescProd   \t:= 0\r\nLocal nTotal      \t:= 0\r\nLocal nTotMerc    \t:= 0\r\nLocal nPagina     \t:= 0\r\nLocal nOrder      \t:= 1\r\nLocal cUserId     \t:= RetCodUsr()\r\nLocal cCont       \t:= Nil\r\nLocal lImpri      \t:= .F.\r\nLocal cCident\t  \t:= \"\"\r\nLocal cCidcob\t  \t:= \"\"\r\nLocal nLinPC2\t  \t:= 0\r\nLocal nLinPC3\t  \t:= 0\r\nLocal nAprovLin \t:= 0\r\nLocal aAux1\r\nLocal nQtdLinhas //, nX\r\nLocal lC7OBSChar  \t:= Type( \"SC7->C7_OBS\" ) == \"C\"\r\n\r\nPrivate cDescPro  \t:= \"\"\r\nPrivate cOPCC     \t:= \"\"\r\nPrivate nVlUnitSC7\t:= 0\r\nPrivate nValTotSC7\t:= 0\r\n\r\nPrivate cObs01    \t:= \"\"\r\nPrivate cObs02    \t:= \"\"\r\nPrivate cObs03    \t:= \"\"\r\nPrivate cObs04    \t:= \"\"\r\nPrivate cObs05    \t:= \"\"\r\nPrivate cObs06    \t:= \"\"\r\nPrivate cObs07    \t:= \"\"\r\nPrivate cObs08    \t:= \"\"\r\nPrivate cObs09    \t:= \"\"\r\nPrivate cObs10    \t:= \"\"\r\nPrivate cObs11    \t:= \"\"\r\nPrivate cObs12    \t:= \"\"\r\nPrivate cObs13    \t:= \"\"\r\nPrivate cObs14    \t:= \"\"\r\nPrivate cObs15    \t:= \"\"\r\nPrivate cObs16    \t:= \"\"\r\n\r\nIf Type(\"lPedido\") != \"L\"\r\n\tlPedido := .F.\r\nEndif\r\n\r\nIf Type(\"lAuto\") == \"U\"\r\n\tlAuto := (nReg!=Nil)\r\nEndif\r\n\r\ndbSelectArea(\"SC7\")\r\n\r\nIf lAuto\r\n\tdbSelectArea(\"SC7\")\r\n\tdbGoto(nReg)\r\n\tmv_par01 := SC7->C7_NUM\r\n\tmv_par02 := SC7->C7_NUM\r\n\tmv_par03 := SC7->C7_EMISSAO\r\n\tmv_par04 := SC7->C7_EMISSAO\r\n\tmv_par05 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"05\"),If(cCont == Nil,2,cCont) })\r\n   \tmv_par08 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"08\"),If(cCont == Nil,C7_TIPO,cCont) })\r\n\tmv_par09 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"09\"),If(cCont == Nil,1,cCont) })\r\n  \tmv_par10 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"10\"),If(cCont == Nil,3,cCont) }) \r\n\tmv_par11 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"11\"),If(cCont == Nil,3,cCont) }) \r\n  \tmv_par14 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"14\"),If(cCont == Nil,1,cCont) }) \r\n  \tcCondBus := AllTrim(Str(SC7->C7_TIPO) + SC7->C7_NUM)\r\nElse\r\n\tMakeAdvplExpr(oReport:uParam)\r\n\t\r\n\tcCondicao := 'C7_FILIAL==\"'       + xFilial(\"SC7\") + '\".And.'\r\n\tcCondicao += 'C7_NUM>=\"'          + mv_par01       + '\".And.C7_NUM<=\"'          + mv_par02 + '\".And.'\r\n\tcCondicao += 'Dtos(C7_EMISSAO)>=\"'+ Dtos(mv_par03) +'\".And.Dtos(C7_EMISSAO)<=\"' + Dtos(mv_par04) + '\"'\r\n\t\r\n\toReport:Section(1):SetFilter(cCondicao,IndexKey())\r\n\t\r\n\tcCondBus := \"1\"+PadL(mv_par01, Len(SC7->C7_NUM),\"0\")\r\nEndIf      \r\n\r\nIf lPedido\r\n\tmv_par12 := MAX(SC7->C7_MOEDA,1)\r\nEndIf\r\n\r\nnOrder\t := 10\r\n\r\nIf mv_par14 == 2\r\n\tcFiltro := \"SC7->C7_QUANT-SC7->C7_QUJE <= 0 .Or. !EMPTY(SC7->C7_RESIDUO)\"\r\nElseif mv_par14 == 3\r\n\tcFiltro := \"SC7->C7_QUANT > SC7->C7_QUJE\"\r\nEndIf\r\n\r\noSection2:Cell(\"PRECO\"):SetPicture(cPictVUnit)\r\noSection2:Cell(\"TOTAL\"):SetPicture(cPictVTot)\r\n\r\nTRPosition():New(oSection2,\"SB1\",1,{ || xFilial(\"SB1\") + SC7->C7_PRODUTO })\r\nTRPosition():New(oSection2,\"SB5\",1,{ || xFilial(\"SB5\") + SC7->C7_PRODUTO })\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Executa o CodeBlock com o PrintLine da Sessao 1 toda vez que rodar o oSection1:Init()   ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\noReport:onPageBreak( { || nPagina++ , nPrinted := 0 , CabecPCxAE(oReport,oSection1,nVias,nPagina) })\r\n\r\noReport:SetMeter(SC7->(LastRec()))\r\ndbSelectArea(\"SC7\")\r\ndbSetOrder(nOrder)\r\ndbSeek(xFilial(\"SC7\")+cCondBus,.T.)\r\n\r\noSection2:Init()\r\n\r\ncNumSC7 := SC7->C7_NUM\r\n\r\nWhile !oReport:Cancel() .And. !SC7->(Eof()) .And. SC7->C7_FILIAL == xFilial(\"SC7\") .And. SC7->C7_NUM >= mv_par01 .And. SC7->C7_NUM <= mv_par02\r\n\t\r\n\tIf (SC7->C7_CONAPRO <> \"B\" .And. mv_par10 == 2) .Or.;\r\n\t\t(SC7->C7_CONAPRO <> \"L\" .And. mv_par10 == 1) .Or.;\r\n\t\t(SC7->C7_EMITIDO == \"S\" .And. mv_par05 == 1) .Or.;\r\n\t\t((SC7->C7_EMISSAO < mv_par03) .Or. (SC7->C7_EMISSAO > mv_par04)) .Or.;\r\n\t\t((SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3) .And. mv_par08 == 2) .Or.;\r\n\t\t(SC7->C7_TIPO == 2 .And. (mv_par08 == 1 .OR. mv_par08 == 3)) .Or. !MtrAValOP(mv_par11, \"SC7\") .Or.;\r\n\t\t(SC7->C7_QUANT > SC7->C7_QUJE .And. mv_par14 == 3) .Or.;\r\n\t\t((SC7->C7_QUANT - SC7->C7_QUJE <= 0 .Or. !Empty(SC7->C7_RESIDUO)) .And. mv_par14 == 2 )\r\n\t\t\r\n\t\tdbSelectArea(\"SC7\")\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndif\r\n\t\r\n\tIf oReport:Cancel()\r\n\t\tExit\r\n\tEndIf\r\n\t\r\n\tMaFisEnd()\r\n\tR110FIniPC(SC7->C7_NUM,,,cFiltro)\r\n\t\r\n\tcObs01    := \" \"\r\n\tcObs02    := \" \"\r\n\tcObs03    := \" \"\r\n\tcObs04    := \" \"\r\n\tcObs05    := \" \"\r\n\tcObs06    := \" \"\r\n\tcObs07    := \" \"\r\n\tcObs08    := \" \"\r\n\tcObs09    := \" \"\r\n\tcObs10    := \" \"\r\n\tcObs11    := \" \"\r\n\tcObs12    := \" \"\r\n\tcObs13    := \" \"\r\n\tcObs14    := \" \"\r\n\tcObs15    := \" \"\r\n\tcObs16    := \" \"\r\n\t\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Roda a impressao conforme o numero de vias informado no mv_par09 ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tFor nVias := 1 to mv_par09\r\n\t\t\r\n\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t//³ Dispara a cabec especifica do relatorio.                     ³\r\n\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\toReport:EndPage()\r\n\t\t\r\n\t\tnPagina  := 0\r\n\t\tnPrinted := 0\r\n\t\tnTotal   := 0\r\n\t\tnTotMerc := 0\r\n\t\tnDescProd:= 0\r\n\t\tnLinObs  := 0\r\n\t\tnRecnoSC7:= SC7->(Recno())\r\n\t\tcNumSC7  := SC7->C7_NUM\r\n\t\taPedido  := {SC7->C7_FILIAL,SC7->C7_NUM,SC7->C7_EMISSAO,SC7->C7_FORNECE,SC7->C7_LOJA,SC7->C7_TIPO}\r\n\t\t\r\n\t\tWhile !oReport:Cancel() .And. !SC7->(Eof()) .And. SC7->C7_FILIAL == xFilial(\"SC7\") .And. SC7->C7_NUM == cNumSC7\r\n\t\t\t\r\n\t\t\tIf (SC7->C7_CONAPRO <> \"B\" .And. mv_par10 == 2) .Or.;\r\n\t\t\t\t(SC7->C7_CONAPRO <> \"L\" .And. mv_par10 == 1) .Or.;\r\n\t\t\t\t(SC7->C7_EMITIDO == \"S\" .And. mv_par05 == 1) .Or.;\r\n\t\t\t\t((SC7->C7_EMISSAO < mv_par03) .Or. (SC7->C7_EMISSAO > mv_par04)) .Or.;\r\n\t\t\t\t((SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3) .And. mv_par08 == 2) .Or.;\r\n\t\t\t\t(SC7->C7_TIPO == 2 .And. (mv_par08 == 1 .OR. mv_par08 == 3)) .Or. !MtrAValOP(mv_par11, \"SC7\") .Or.;\r\n\t\t\t\t(SC7->C7_QUANT > SC7->C7_QUJE .And. mv_par14 == 3) .Or.;\r\n\t\t\t\t((SC7->C7_QUANT - SC7->C7_QUJE <= 0 .Or. !Empty(SC7->C7_RESIDUO)) .And. mv_par14 == 2 )\r\n\t\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\t\tdbSkip()\r\n\t\t\t\tLoop\r\n\t\t\tEndif\r\n\t\t\t\r\n\t\t\tIf oReport:Cancel()\r\n\t\t\t\tExit\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\toReport:IncMeter()\r\n\t\t\t\r\n\t\t\tIf oReport:Row() > oReport:LineHeight() * 100\r\n\t\t\t\toReport:Box( oReport:Row(),010,oReport:Row() + oReport:LineHeight() * 3, nPageWidth )\r\n\t\t\t\toReport:SkipLine()\r\n\t\t\t\toReport:PrintText(STR0101,, 050 ) // Continua na Proxima pagina ....\r\n\t\t\t\toReport:EndPage()\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Salva os Recnos do SC7 no aRecnoSave para marcar reimpressao.³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf Ascan(aRecnoSave,SC7->(Recno())) == 0\r\n\t\t\t\tAADD(aRecnoSave,SC7->(Recno()))\r\n\t\t\tEndif\r\n\t\t\t\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Inicializa o descricao do Produto conf. parametro digitado.³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tcDescPro :=  \"\"\r\n\t\t\tIf Empty(mv_par06)\r\n\t\t\t\tmv_par06 := \"B1_DESC\"\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\tIf AllTrim(mv_par06) == \"B1_DESC\"\r\n\t\t\t\tSB1->(dbSetOrder(1))\r\n\t\t\t\tSB1->(dbSeek( xFilial(\"SB1\") + SC7->C7_PRODUTO ))\r\n\t\t\t\tcDescPro := SB1->B1_DESC\r\n\t\t\tElseIf AllTrim(mv_par06) == \"B5_CEME\"\r\n\t\t\t\tSB5->(dbSetOrder(1))\r\n\t\t\t\tIf SB5->(dbSeek( xFilial(\"SB5\") + SC7->C7_PRODUTO ))\r\n\t\t\t\t\tcDescPro := SB5->B5_CEME\r\n\t\t\t\tEndIf\r\n\t\t\tElseIf AllTrim(mv_par06) == \"C7_DESCRI\"\r\n\t\t\t\tcDescPro := SC7->C7_DESCRI\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\tIf Empty(cDescPro)\r\n\t\t\t\tSB1->(dbSetOrder(1))\r\n\t\t\t\tSB1->(dbSeek( xFilial(\"SB1\") + SC7->C7_PRODUTO ))\r\n\t\t\t\tcDescPro := SB1->B1_DESC\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\tSA5->(dbSetOrder(1))\r\n\t\t\tIf SA5->(dbSeek(xFilial(\"SA5\")+SC7->C7_FORNECE+SC7->C7_LOJA+SC7->C7_PRODUTO)) .And. !Empty(SA5->A5_CODPRF)\r\n\t\t\t\tcDescPro := Alltrim(cDescPro) + \" (\"+Alltrim(SA5->A5_CODPRF)+\")\"\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\tIf SC7->C7_DESC1 != 0 .Or. SC7->C7_DESC2 != 0 .Or. SC7->C7_DESC3 != 0\r\n\t\t\t\tnDescProd+= CalcDesc(SC7->C7_TOTAL,SC7->C7_DESC1,SC7->C7_DESC2,SC7->C7_DESC3)\r\n\t\t\tElse\r\n\t\t\t\tnDescProd+=SC7->C7_VLDESC\r\n\t\t\tEndif\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Inicializacao da Observacao do Pedido.                       ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf lC7OBSChar .AND. !Empty(SC7->C7_OBS) .And. nLinObs < 17\r\n\t\t\t\tIf !(SC7->C7_OBS $ SC7->C7_OBSM) \r\n\t\t\t\t\tnLinObs++\r\n\t\t\t\t\tcVar:=\"cObs\"+StrZero(nLinObs,2)\r\n\t\t\t\t\tEval(MemVarBlock(cVar),Alltrim(SC7->C7_OBS))\r\n\t\t\t\tEndIf \r\n\t\t\tEndif\r\n\t\t\t\r\n\t\t\tIf !Empty(SC7->C7_OBSM) .And. nLinObs < 17\r\n\t\t\t\tnLinObs++\r\n\t\t\t\tcVar:=\"cObs\"+StrZero(nLinObs,2)\r\n\t\t\t\tEval(MemVarBlock(cVar),Alltrim(SC7->C7_OBSM))\r\n\t\t\tEndif\r\n\t\t\t\t\t\t\r\n\t\t\tnTxMoeda   := IIF(SC7->C7_TXMOEDA > 0,SC7->C7_TXMOEDA,Nil)\r\n\t\t\tnValTotSC7 := xMoeda(SC7->C7_TOTAL,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda)\r\n\t\t\t\r\n\t\t\tnTotal     := nTotal + SC7->C7_TOTAL\r\n\t\t\tnTotMerc   := MaFisRet(,\"NF_TOTAL\")\r\n\t\t\t\r\n\t\t\tIf oReport:nDevice != 4 .Or. (oReport:nDevice == 4 .And. !oReport:lXlsTable .And. oReport:lXlsHeader)  //impressao em planilha tipo tabela\r\n\t\t\t\toSection2:Cell(\"C7_NUM\"):Disable()\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\tIf MV_PAR07 == 2 .And. !Empty(SC7->C7_QTSEGUM) .And. !Empty(SC7->C7_SEGUM)\r\n\t\t\t\toSection2:Cell(\"C7_SEGUM\"  ):Enable()\r\n\t\t\t\toSection2:Cell(\"C7_QTSEGUM\"):Enable()\r\n\t\t\t\toSection2:Cell(\"C7_UM\"     ):Disable()\r\n\t\t\t\toSection2:Cell(\"C7_QUANT\"  ):Disable()\r\n\t\t\t\tnVlUnitSC7 := xMoeda(((SC7->C7_PRECO*SC7->C7_QUANT)/SC7->C7_QTSEGUM),SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda)\r\n\t\t\tElseIf MV_PAR07 == 1 .And. !Empty(SC7->C7_QUANT) .And. !Empty(SC7->C7_UM)\r\n\t\t\t\toSection2:Cell(\"C7_SEGUM\"  ):Disable()\r\n\t\t\t\toSection2:Cell(\"C7_QTSEGUM\"):Disable()\r\n\t\t\t\toSection2:Cell(\"C7_UM\"     ):Enable()\r\n\t\t\t\toSection2:Cell(\"C7_QUANT\"  ):Enable()\r\n\t\t\t\tnVlUnitSC7 := xMoeda(SC7->C7_PRECO,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda)\r\n\t\t\tElse\r\n\t\t\t\toSection2:Cell(\"C7_SEGUM\"  ):Enable()\r\n\t\t\t\toSection2:Cell(\"C7_QTSEGUM\"):Enable()\r\n\t\t\t\toSection2:Cell(\"C7_UM\"     ):Enable()\r\n\t\t\t\toSection2:Cell(\"C7_QUANT\"  ):Enable()\r\n\t\t\t\tnVlUnitSC7 := xMoeda(SC7->C7_PRECO,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda)\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\tIf cPaisLoc <> \"BRA\" .Or. mv_par08 == 2\r\n\t\t\t\toSection2:Cell(\"C7_IPI\" ):Disable()\r\n\t\t\tEndIf\r\n\t\t\t \r\n\t\t\tIf mv_par08 == 1 .OR. mv_par08 == 3\r\n\t\t\t\toSection2:Cell(\"OPCC\"):Disable()\r\n\t\t\tElse\r\n\t\t\t\toSection2:Cell(\"C7_DATPRF\"):SetSize(9)\r\n\t\t\t\toSection2:Cell(\"C7_CC\"):Disable()\r\n\t\t\t\toSection2:Cell(\"C7_NUMSC\"):Disable()\r\n\t\t\t\tIf !Empty(SC7->C7_OP)\r\n\t\t\t\t\tcOPCC := STR0065 + \" \" + SC7->C7_OP\r\n\t\t\t\tElseIf !Empty(SC7->C7_CC)\r\n\t\t\t\t\tcOPCC := STR0066 + \" \" + SC7->C7_CC\r\n\t\t\t\tEndIf\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\toSection2:Cell(\"C7_ITEM\"):SetSize(10)\r\n\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(50)\r\n\t\t\toSection2:Cell(\"C7_NUMSC\"):SetSize(12.3)\r\n\t\t\tIf MV_PAR07 == 1\r\n\t\t\t\tIf nTpImp == 6\r\n\t\t\t\t\toSection2:Cell(\"C7_DATPRF\"):SetSize(17.6)\r\n\t\t\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(70)\r\n\t\t\t\tEndIF\r\n\t\t\tElseIf MV_PAR07 == 2 .And. !Empty(SC7->C7_QTSEGUM) .And. !Empty(SC7->C7_SEGUM)\r\n   \t\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(47)\r\n   \t\t\t\tIf nTpImp == 6\r\n\t\t\t\t\toSection2:Cell(\"C7_DATPRF\"):SetSize(24.7)\r\n\t\t\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(80)\r\n\t\t\t\tEndIF\r\n   \t\t\tElse\r\n   \t\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(32.3)\r\n   \t\t\t\toSection2:Cell(\"C7_NUMSC\"):SetSize(8)\r\n   \t\t\t\toSection2:Cell(\"C7_ITEM\"):SetSize(9)\r\n   \t\t\t\tIf nTpImp == 6\r\n\t\t\t\t\toSection2:Cell(\"C7_DATPRF\"):SetSize(14.7)\r\n\t\t\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(85)\r\n\t\t\t\t\toSection2:Cell(\"C7_NUMSC\"):SetSize(20.5)\r\n\t\t\t\tEndIF\r\n   \t\t\tEndIF\r\n   \t\t\t\r\n \t\t\t\toSection2:Cell(\"C7_ITEM\"):SetSize(10)\r\n \t\t\t\toSection2:Cell(\"C7_PRODUTO\"):SetSize(017)\r\n\t\t\t\t\r\n\t\t\t\tDo \tCase\r\n\t\t\t\t\tCase oReport:PageWidth() = 2550 // 2435\r\n\r\n\t\t\t\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(049.57)\r\n\t\r\n\t\t\t\t\tCase oReport:PageWidth() = 2479 // 2550\r\n\t\t\t\t\t\toSection2:Cell(\"DESCPROD\"):SetSize(090)\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tCase oReport:PageWidth() = 3300\r\n\r\n\t\t\t\tEndCase\t\t\t\t\r\n\t\t\t\toSection2:Cell(\"C7_QUANT\"):SetSize(015) \t// 30\r\n\t\t\t\toSection2:Cell(\"C7_QTSEGUM\"):SetSize(015) \t// 30\r\n\t\t\t\toSection2:Cell(\"PRECO\"):SetSize(019) \r\n\t\t\t\toSection2:Cell(\"TOTAL\"):SetSize(019)  \t\t// 25\r\n\t\t\t\toSection2:Cell(\"C7_DATPRF\"):SetSize(013)    \t\t\t\r\n\t\t\t\toSection2:Cell(\"C7_CC\"):SetSize(010)\r\n\t\t\t\toSection2:Cell(\"C7_NUMSC\"):SetSize(008)\r\n\r\n\t\t\tIf oReport:nDevice == 4 .And. oReport:lXlsTable .And. !oReport:lXlsHeader  //impressao em planilha tipo tabela\t\r\n\t\t\t\toSection1:Init()\r\n\t\t\t\tTRPosition():New(oSection1,\"SA2\",1,{ || xFilial(\"SA2\") + SC7->C7_FORNECE + SC7->C7_LOJA })\r\n\t\t\t\toSection1:PrintLine()\r\n\t\t\t\toSection2:PrintLine()\r\n\t\t\t\toSection1:Finish()\r\n\t\t\tElse\t\r\n\t\t\t\toSection2:PrintLine()\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\t\tnPrinted ++\r\n\t\t\tlImpri  := .T.\r\n\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\tdbSkip()\r\n\t\t\t\r\n\t\tEndDo\r\n\t\t\r\n\t\tSC7->(dbGoto(nRecnoSC7))\r\n\t\t\r\n\t\tIf oReport:Row() > oReport:LineHeight() * 68\r\n\t\t\t\r\n\t\t\toReport:Box( oReport:Row(),010,oReport:Row() + oReport:LineHeight() * 3, nPageWidth )\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:PrintText(STR0101,, 050 ) // Continua na Proxima pagina ....\r\n\t\t\t\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Dispara a cabec especifica do relatorio.                     ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\toReport:EndPage()\r\n\t\t\toReport:PrintText(\" \",1992 , 010 ) // Necessario para posicionar Row() para a impressao do Rodape\r\n\t\t\t\r\n\t\t\toReport:Box( 280,010,oReport:Row() + oReport:LineHeight() * ( 93 - nPrinted ) , nPageWidth )\r\n\t\t\t\r\n\t\tElse\r\n\t\t\toReport:Box( oReport:Row(),oReport:Col(),oReport:Row() + oReport:LineHeight() * ( 93 - nPrinted ) , nPageWidth )\r\n\t\tEndIf\r\n\t\t\r\n\t\toReport:Box( 1990 ,010,oReport:Row() + oReport:LineHeight() * ( 93 - nPrinted ) , nPageWidth )\r\n\t\toReport:Box( 2080 ,010,oReport:Row() + oReport:LineHeight() * ( 93 - nPrinted ) , nPageWidth )\r\n\t\toReport:Box( 2200 ,010,oReport:Row() + oReport:LineHeight() * ( 93 - nPrinted ) , nPageWidth )\r\n\t\toReport:Box( 2320 ,010,oReport:Row() + oReport:LineHeight() * ( 93 - nPrinted ) , nPageWidth )\r\n\t\t\r\n\t\toReport:Box( 2200 , 1080 , 2320 , 1400 ) // Box da Data de Emissao\r\n\t\toReport:Box( 2320 ,  010 , 2406 , 1220 ) // Box do Reajuste\r\n\t\toReport:Box( 2320 , 1220 , 2460 , 1750 ) // Box do IPI e do Frete\r\n\t\toReport:Box( 2320 , 1750 , 2460 , nPageWidth ) // Box do ICMS Despesas e Seguro\r\n\t\toReport:Box( 2406 ,  010 , 2700 , 1220 ) // Box das Observacoes\r\n\r\n\t\tcMensagem:= Formula(C7_MSG)\r\n\t\tIf !Empty(cMensagem)\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:PrintText(PadR(cMensagem,129), , oSection2:Cell(\"DESCPROD\"):ColPos() )\r\n\t\tEndif\r\n\t\t\r\n\t\toReport:PrintText( STR0007 /*\"D E S C O N T O S -->\"*/ + \" \" + ;\r\n\t\tTransForm(SC7->C7_DESC1,\"999.99\" ) + \" %    \" + ;\r\n\t\tTransForm(SC7->C7_DESC2,\"999.99\" ) + \" %    \" + ;\r\n\t\tTransForm(SC7->C7_DESC3,\"999.99\" ) + \" %    \" + ;\r\n\t\tTransForm(xMoeda(nDescProd,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , PesqPict(\"SC7\",\"C7_VLDESC\",14, MV_PAR12) ),;\r\n\t\t2022 , 050 )\r\n\t\t\r\n\t\toReport:SkipLine()\r\n\t\toReport:SkipLine()\r\n\t\toReport:SkipLine()\r\n\t\t\r\n\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t//³ Posiciona o Arquivo de Empresa SM0.                          ³\r\n\t\t//³ Imprime endereco de entrega do SM0 somente se o MV_PAR13 =\" \"³\r\n\t\t//³ e o Local de Cobranca :                                      ³\r\n\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\tSM0->(dbSetOrder(1))\r\n\t\tnRecnoSM0 := SM0->(Recno())\r\n\t\tSM0->(dbSeek(SUBS(cNumEmp,1,2)+SC7->C7_FILENT))\r\n\r\n\t\tcCident := IIF(len(SM0->M0_CIDENT)>20,Substr(SM0->M0_CIDENT,1,15),SM0->M0_CIDENT)\r\n\t\tcCidcob := IIF(len(SM0->M0_CIDCOB)>20,Substr(SM0->M0_CIDCOB,1,15),SM0->M0_CIDCOB)\r\n\r\n\t\tIf Empty(MV_PAR13) //\"Local de Entrega  : \"\r\n\t\t\toReport:PrintText(STR0008 + SM0->M0_ENDENT+\"  \"+Rtrim(SM0->M0_CIDENT)+\"  - \"+SM0->M0_ESTENT+\" - \"+STR0009+\" \"+Trans(Alltrim(SM0->M0_CEPENT),PesqPict(\"SA2\",\"A2_CEP\")),, 050 )\r\n\t\tElse\r\n\t\t\toReport:PrintText(STR0008 + mv_par13,, 050 ) //\"Local de Entrega  : \" imprime o endereco digitado na pergunte\r\n\t\tEndif\r\n\t\tSM0->(dbGoto(nRecnoSM0))\r\n\t\toReport:PrintText(STR0010 + SM0->M0_ENDCOB+\"  \"+Rtrim(SM0->M0_CIDCOB)+\"  - \"+SM0->M0_ESTCOB+\" - \"+STR0009+\" \"+Trans(Alltrim(SM0->M0_CEPCOB),PesqPict(\"SA2\",\"A2_CEP\")),, 050 )\r\n\t\t\r\n\t\toReport:SkipLine()\r\n\t\toReport:SkipLine()\r\n\t\t\r\n\t\tSE4->(dbSetOrder(1))\r\n\t\tSE4->(dbSeek(xFilial(\"SE4\")+SC7->C7_COND))\r\n\t\t\r\n\t\tnLinPC := oReport:Row()\r\n\t\toReport:PrintText( STR0011+SubStr(SE4->E4_CODIGO,1,40),nLinPC,050 )\r\n\t\toReport:PrintText( STR0070,nLinPC,1120 ) //\"Data de Emissao\"\r\n\t\toReport:PrintText( STR0013 +\" \"+ Transform(xMoeda(nTotal,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotal,14,MsDecimais(MV_PAR12)) ),nLinPC,1612 ) //\"Total das Mercadorias : \"\r\n\t\toReport:SkipLine()\r\n\t\tnLinPC := oReport:Row()\r\n\t\t\r\n\t\tIf cPaisLoc<>\"BRA\"\r\n\t\t\taValIVA := MaFisRet(,\"NF_VALIMP\")\r\n\t\t\tnValIVA :=0\r\n\t\t\tIf !Empty(aValIVA)\r\n\t\t\t\tFor nY:=1 to Len(aValIVA)\r\n\t\t\t\t\tnValIVA+=aValIVA[nY]\r\n\t\t\t\tNext nY\r\n\t\t\tEndIf\r\n\t\t\toReport:PrintText(SubStr(SE4->E4_DESCRI,1,34),nLinPC, 050 )\r\n\t\t\toReport:PrintText( dtoc(SC7->C7_EMISSAO),nLinPC,1120 )\r\n\t\t\toReport:PrintText( STR0063+ \"   \" + ; //\"Total dos Impostos:    \"\r\n\t\t\tTransform(xMoeda(nValIVA,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nValIVA,14,MsDecimais(MV_PAR12)) ),nLinPC,1612 )\r\n\t\tElse\r\n\t\t\toReport:PrintText( SubStr(SE4->E4_DESCRI,1,34),nLinPC, 050 )\r\n\t\t\toReport:PrintText( dtoc(SC7->C7_EMISSAO),nLinPC,1120 )\r\n\t\t\toReport:PrintText( STR0064+ \"  \" + ; //\"Total com Impostos:    \"\r\n\t\t\tTransform(xMoeda(nTotMerc,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotMerc,14,MsDecimais(MV_PAR12)) ),nLinPC,1612 )\r\n\t\tEndif\r\n\t\toReport:SkipLine()\r\n\t\t\r\n\t\tnTotIpi\t  := MaFisRet(,'NF_VALIPI')\r\n\t\tnTotIcms  := MaFisRet(,'NF_VALICM')\r\n\t\tnTotDesp  := MaFisRet(,'NF_DESPESA')\r\n\t\tnTotFrete := MaFisRet(,'NF_FRETE')\r\n\t\tnTotSeguro:= MaFisRet(,'NF_SEGURO')\r\n\t\tnTotalNF  := MaFisRet(,'NF_TOTAL')\r\n\t\t\r\n\t\toReport:SkipLine()\r\n\t\toReport:SkipLine()\r\n\t\tnLinPC := oReport:Row()\r\n\t\t\r\n\t\tSM4->(dbSetOrder(1))\r\n\t\tIf SM4->(dbSeek(xFilial(\"SM4\")+SC7->C7_REAJUST))\r\n\t\t\toReport:PrintText(  STR0014 + \" \" + SC7->C7_REAJUST + \" \" + SM4->M4_DESCR ,nLinPC, 050 )  //\"Reajuste :\"\r\n\t\tEndIf\t\t\t\r\n\r\n\t\tIf cPaisLoc == \"BRA\"\r\n\t\t\toReport:PrintText( STR0071 + Transform(xMoeda(nTotIPI ,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotIpi ,14,MsDecimais(MV_PAR12))) ,nLinPC,1320 ) //\"IPI      :\"\r\n\t\t\toReport:PrintText( STR0072 + Transform(xMoeda(nTotIcms,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotIcms,14,MsDecimais(MV_PAR12))) ,nLinPC,1815 ) //\"ICMS     :\"\r\n\t\tEndIf\r\n\t\toReport:SkipLine()\r\n\r\n\t\tnLinPC := oReport:Row()\r\n\t\toReport:PrintText( STR0073 + Transform(xMoeda(nTotFrete,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotFrete,14,MsDecimais(MV_PAR12))) ,nLinPC,1320 ) //\"Frete    :\"\r\n\t\toReport:PrintText( STR0074 + Transform(xMoeda(nTotDesp ,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotDesp ,14,MsDecimais(MV_PAR12))) ,nLinPC,1815 ) //\"Despesas :\"\r\n\t\toReport:SkipLine()\r\n\t\t\r\n\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t//³ Inicializar campos de Observacoes.                           ³\r\n\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\t\t\r\n\t\tIf Empty(cObs02) .Or. cObs01 == cObs02\r\n\t\t\t\r\n\t\t\tcObs02 := \"\"\r\n\t\t\taAux1 := strTokArr(cObs01, chr(13)+chr(10))\r\n\t\t\tnQtdLinhas := 0\t\t\t\t\t\t\r\n\t\t\tfor nX := 1 To  Len(aAux1)\r\n\t\t\t\tnQtdLinhas += Ceiling(Len(aAux1[nX]) / 65)\r\n\t\t\tNext nX\t\t\t\r\n\t\t\tIf nQtdLinhas <= 8\r\n\t\t\t\tR110cObs(aAux1, 65)\r\n\t\t\tElse\r\n\t\t\t\tR110cObs(aAux1, 40)\r\n\t\t\tEndIf\t\t\t\r\n\t\tElse\r\n\t\t\tcObs01:= Substr(cObs01,1,IIf(Len(cObs01)<65,Len(cObs01),65))\r\n\t\t\tcObs02:= Substr(cObs02,1,IIf(Len(cObs02)<65,Len(cObs02),65))\r\n\t\t\tcObs03:= Substr(cObs03,1,IIf(Len(cObs03)<65,Len(cObs03),65))\r\n\t\t\tcObs04:= Substr(cObs04,1,IIf(Len(cObs04)<65,Len(cObs04),65))\r\n\t\t\tcObs05:= Substr(cObs05,1,IIf(Len(cObs05)<65,Len(cObs05),65))\r\n\t\t\tcObs06:= Substr(cObs06,1,IIf(Len(cObs06)<65,Len(cObs06),65))\r\n\t\t\tcObs07:= Substr(cObs07,1,IIf(Len(cObs07)<65,Len(cObs07),65))\r\n\t\t\tcObs08:= Substr(cObs08,1,IIf(Len(cObs08)<65,Len(cObs08),65))\r\n\t\t\tcObs09:= Substr(cObs09,1,IIf(Len(cObs09)<65,Len(cObs09),65))\r\n\t\t\tcObs10:= Substr(cObs10,1,IIf(Len(cObs10)<65,Len(cObs10),65))\r\n\t\t\tcObs11:= Substr(cObs11,1,IIf(Len(cObs11)<65,Len(cObs11),65))\r\n\t\t\tcObs12:= Substr(cObs12,1,IIf(Len(cObs12)<65,Len(cObs12),65))\r\n\t\t\tcObs13:= Substr(cObs13,1,IIf(Len(cObs13)<65,Len(cObs13),65))\r\n\t\t\tcObs14:= Substr(cObs14,1,IIf(Len(cObs14)<65,Len(cObs14),65))\r\n\t\t\tcObs15:= Substr(cObs15,1,IIf(Len(cObs15)<65,Len(cObs15),65))\r\n\t\t\tcObs16:= Substr(cObs16,1,IIf(Len(cObs16)<65,Len(cObs16),65))\r\n\t\tEndIf\r\n\t\t\r\n\t\tcComprador:= \"\"\r\n\t\tcAlter\t  := \"\"\r\n\t\tcAprov\t  := \"\"\r\n\t\tlNewAlc\t  := .F.\r\n\t\tlLiber \t  := .F.\r\n\t\tlRejeit\t  := .F.\r\n\t\t\r\n\t\tdbSelectArea(\"SC7\")\r\n\t//Incluida validação para os pedidos de compras por item do pedido  (IP/alçada)\t\t\t\r\n\t\tcTipoSC7:= IIF((SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3),\"PC\",\"AE\") \r\n\t\t\r\n\t\tIf cTipoSC7 == \"PC\"\r\n\t\t\r\n\t\t\tdbSelectArea(\"SCR\")\r\n\t\t\tdbSetOrder(1)\r\n\t\t\tIf dbSeek(xFilial(\"SCR\")+cTipoSC7+SC7->C7_NUM)\r\n\t\t\t\tcTst = ''\r\n\t\t\tElse\r\n\t\t\t\tIf dbSeek(xFilial(\"SCR\")+\"IP\"+SC7->C7_NUM)\r\n\t\t\t\t\tcTst = ''\r\n\t\t\t\tEndIf\r\n\t\t\tEndIf\r\n\t\t\r\n\t\tElse\r\n\t\t\r\n\t\t\tdbSelectArea(\"SCR\")\r\n\t\t\tdbSetOrder(1)\r\n\t\t\tdbSeek(xFilial(\"SCR\")+cTipoSC7+SC7->C7_NUM)\r\n\t\tEndIf\r\n\t\t\r\n\t\tIf !Empty(SC7->C7_APROV) .Or. (Empty(SC7->C7_APROV) .And. SCR->CR_TIPO == \"IP\")\r\n\t\t\t\r\n\t\t\tlNewAlc := .T.\r\n\t\t\tcComprador := UsrFullName(SC7->C7_USER)\r\n\t\t\tIf SC7->C7_CONAPRO != \"B\"\r\n\t\t\t\tIF SC7->C7_CONAPRO == \"R\"\r\n\t\t\t\t\tlRejeit\t  := .T.\r\n\t\t\t\tElse\r\n\t\t\t\t\tlLiber    := .T.\r\n\t\t\t\tEndIf\r\n\t\t\tEndIf\r\n\r\n\t\t\tWhile !Eof() .And. SCR->CR_FILIAL+Alltrim(SCR->CR_NUM) == xFilial(\"SCR\")+Alltrim(SC7->C7_NUM) .And. SCR->CR_TIPO $ \"PC|AE|IP\"\r\n\t\t\t\tcAprov += AllTrim(UsrFullName(SCR->CR_USER))+\" [\"\r\n\t\t\t\tDo Case\r\n\t\t\t\t\tCase SCR->CR_STATUS==\"02\" //Pendente\r\n        \t\t\t\tcAprov += \"BLQ\"\r\n\t\t\t\t\tCase SCR->CR_STATUS==\"03\" //Liberado\r\n\t\t\t\t\t\tcAprov += \"Ok\"\r\n\t\t\t\t\tCase SCR->CR_STATUS==\"04\" //Bloqueado\r\n\t\t\t\t\t\tcAprov += \"BLQ\"\r\n\t\t\t\t\tCase SCR->CR_STATUS==\"05\" //Nivel Liberado\r\n\t\t\t\t\t\tcAprov += \"##\"\r\n\t\t\t\t\tCase SCR->CR_STATUS==\"06\" //Rejeitado\r\n\t\t\t\t\t\tcAprov += \"REJ\"\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tOtherWise                 //Aguar.Lib\r\n\t\t\t\t\t\tcAprov += \"??\"\r\n\t\t\t\tEndCase\r\n\t\t\t\tcAprov += \"] - \"\r\n\t\t\t\tdbSelectArea(\"SCR\")\r\n\t\t\t\tdbSkip()\r\n\t\t\tEnddo\r\n\t\t\tIf !Empty(SC7->C7_GRUPCOM)\r\n\t\t\t\tdbSelectArea(\"SAJ\")\r\n\t\t\t\tdbSetOrder(1)\r\n\t\t\t\tdbSeek(xFilial(\"SAJ\")+SC7->C7_GRUPCOM)\r\n\t\t\t\tWhile !Eof() .And. SAJ->AJ_FILIAL+SAJ->AJ_GRCOM == xFilial(\"SAJ\")+SC7->C7_GRUPCOM\r\n\t\t\t\t\tIf SAJ->AJ_USER != SC7->C7_USER\r\n\t\t\t\t\t\tIf SAJ->(FieldPos(\"AJ_MSBLQL\") > 0)\r\n\t\t\t\t\t\t\tIf SAJ->AJ_MSBLQL == \"1\"\r\n\t\t\t\t\t\t\t\tdbSkip()\r\n\t\t\t\t\t\t\t\tLOOP\r\n\t\t\t\t\t\t\tEndIf \r\n\t\t\t\t\t\tEndIf\r\n\t\t\t\t\t\tcAlter += AllTrim(UsrFullName(SAJ->AJ_USER))+\"/\"\r\n\t\t\t\t\tEndIf\r\n\t\t\t\t\tdbSelectArea(\"SAJ\")\r\n\t\t\t\t\tdbSkip()\r\n\t\t\t\tEndDo\r\n\t\t\tEndIf\r\n\t\tEndIf\r\n\r\n\t\tnLinPC := oReport:Row()\r\n\t\toReport:PrintText( STR0077 ,nLinPC, 050 ) // \"Observacoes \"\r\n\t\toReport:PrintText( STR0076 + Transform(xMoeda(nTotSeguro,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotSeguro,14,MsDecimais(MV_PAR12))) ,nLinPC, 1815 ) // \"SEGURO   :\"\r\n\t\toReport:SkipLine()\r\n\r\n\t\tnLinPC2 := oReport:Row()\r\n\t\toReport:PrintText(cObs01,,050 )\r\n\t\toReport:PrintText(cObs02,,050 )\r\n\r\n\t\tnLinPC := oReport:Row()\r\n\t\toReport:PrintText(cObs03,nLinPC,050 )\r\n\r\n\t\tIf !lNewAlc\r\n\t\t\toReport:PrintText( STR0078 + Transform(xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotalNF,14,MsDecimais(MV_PAR12))) ,nLinPC,1774 ) //\"Total Geral :\"\r\n\t\tElse\r\n\t\t\tIf lLiber\r\n\t\t\t\toReport:PrintText( STR0078 + Transform(xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) , tm(nTotalNF,14,MsDecimais(MV_PAR12))) ,nLinPC,1774 )\r\n\t\t\tElse\r\n\t\t\t\toReport:PrintText( STR0078 + If((SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3),IF(lRejeit,STR0130,STR0051),STR0086) ,nLinPC,1390 )\r\n\t\t\tEndIf\r\n\t\tEndIf\r\n\t\toReport:SkipLine()\r\n\t\t\r\n\t\toReport:PrintText(cObs04,,050 )\r\n\t\toReport:PrintText(cObs05,,050 )\r\n\t\toReport:PrintText(cObs06,,050 )\r\n\t\tnLinPC3 := oReport:Row()\r\n\t\toReport:PrintText(cObs07,,050 )\r\n\t\toReport:PrintText(cObs08,,050 )\r\n\t\toReport:PrintText(cObs09,nLinPC2,650 )\r\n\t\toReport:SkipLine()\r\n\t\toReport:PrintText(cObs10,,650 )\r\n\t\toReport:PrintText(cObs11,,650 )\r\n\t\toReport:PrintText(cObs12,,650 )\r\n\t\toReport:PrintText(cObs13,,650 )\r\n\t\toReport:PrintText(cObs14,,650 )\r\n\t\toReport:PrintText(cObs15,,650 )\r\n\t\toReport:PrintText(cObs16,,650 )\r\n\r\n\t\tIf !lNewAlc\r\n\t\t\t\r\n\t\t\toReport:Box( 2700 , 0010 , 3020 , 0400 )\r\n\t\t\toReport:Box( 2700 , 0400 , 3020 , 0800 )\r\n\t\t\toReport:Box( 2700 , 0800 , 3020 , 1220 )\r\n\t\t\toReport:Box( 2600 , 1220 , 3020 , 1770 )\r\n\t\t\toReport:Box( 2600 , 1770 , 3020 , nPageWidth )\r\n\t\t\t\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\tnLinPC := oReport:Row()\r\n\t\t\toReport:PrintText( If((SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3),STR0079,STR0084),nLinPC,1310) //\"Liberacao do Pedido\"##\"Liber. Autorizacao \"\r\n\t\t\toReport:PrintText( STR0080 + IF( SC7->C7_TPFRETE $ \"F\",\"FOB\",IF(SC7->C7_TPFRETE $ \"C\",\"CIF\",IF(SC7->C7_TPFRETE $ \"R\",STR0132,IF(SC7->C7_TPFRETE $ \"D\",STR0133,IF(SC7->C7_TPFRETE $ \"T\",STR0134,\" \" ) )))) ,nLinPC,1820 ) //STR0132 Por conta remetente, STR0133 Por conta destinatario,STR0134 Por Conta Terceiros.\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\tnLinPC := oReport:Row()\r\n\t\t\toReport:PrintText( STR0021 ,nLinPC, 050 ) //\"Comprador\"\r\n\t\t\toReport:PrintText( STR0022 ,nLinPC, 430 ) //\"Gerencia\"\r\n\t\t\toReport:PrintText( STR0023 ,nLinPC, 850 ) //\"Diretoria\"\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\tnLinPC := oReport:Row()\r\n\t\t\toReport:PrintText( Replic(\"_\",23) ,nLinPC,  050 )\r\n\t\t\toReport:PrintText( Replic(\"_\",23) ,nLinPC,  430 )\r\n\t\t\toReport:PrintText( Replic(\"_\",23) ,nLinPC,  850 )\r\n\t\t\toReport:PrintText( Replic(\"_\",31) ,nLinPC, 1310 )\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\tIf SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3\r\n\t\t\t\toReport:PrintText(\"NOTA1: Só aceitaremos a mercadoria se na sua Nota Fiscal constar o numero do nosso Pedido de Compras. \",,050 ) //\r\n\t\t\t\toReport:PrintText(\"NOTA2: Só será liberada a entrada da mercadoria na empresa mediante apresentação de nota fiscal na recepção. \",,050 )\r\n\t\t\tElse\r\n\t\t\t\toReport:PrintText(\"NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero da Autorizacao de Entrega.\",,050 ) //\r\n\t\t\tEndIf\r\n\t\t\t\r\n\t\tElse\r\n\t\t\t\r\n\t\t\toReport:Box( 2570 , 1220 , 2700 , 1820 )\r\n\t\t\toReport:Box( 2570 , 1820 , 2700 , nPageWidth )\r\n\t\t\toReport:Box( 2700 , 0010 , 3020 , nPageWidth )\r\n\t\t\toReport:Box( 2970 , 0010 , 3020 , 1800 )\r\n\t\t\t\r\n\t\t\tnLinPC := nLinPC3\r\n\t\t\t\r\n\t\t\toReport:PrintText( If((SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3), If( lLiber , STR0050 , IF(lRejeit,STR0130,STR0051) ) , If( lLiber , STR0085 , STR0086 ) ),nLinPC,1290 ) //\"     P E D I D O   L I B E R A D O\"#\"|     P E D I D O   B L O Q U E A D O !!!\"\r\n\t\t\toReport:PrintText( STR0080 + Substr(RetTipoFrete(SC7->C7_TPFRETE),3),nLinPC,1830 ) //\"Obs. do Frete: \"\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:PrintText(STR0052+\" \"+Substr(cComprador,1,60),,050 ) \t//\"Comprador Responsavel :\" //\"BLQ:Bloqueado\"\r\n\t\t\toReport:SkipLine()\r\n\t\t\toReport:PrintText(STR0053+\" \"+ If( Len(cAlter) > 0 , Substr(cAlter,001,130) , \" \" ),,050 ) //\"Compradores Alternativos :\"\r\n\t\t\toReport:PrintText(            If( Len(cAlter) > 0 , Substr(cAlter,131,130) , \" \" ),,440 ) //\"Compradores Alternativos :\"\r\n\t\t\t\r\n\t\t\t\r\n\r\n\t\t\tnLinCar := 140\r\n\t\t\tnColCarac := 050\r\n\t\t\tnCCarac := 140\r\n\t\t\t\r\n\t\t\tnAprovLin := Ceiling( IIF(Len(AllTrim(cAprov)) < 75 , 75 , Len(AllTrim(cAprov))) / nLinCar,0)\r\n\t\t\t\r\n\t\t\tFor nX := 1 to nAprovLin \r\n\t\t\t\tIf nX == 1\r\n\t\t\t\t\toReport:PrintText(STR0054+\" \"+If( Len(cAprov) > 0 , Substr(cAprov,001,nLinCar) , \" \" ),,nColCarac ) //\"Aprovador(es) :\"\r\n\t\t\t\t\tnColCarac+=250\r\n\t\t\t\tElse\r\n\t\t\t\t\toReport:PrintText(            If( Len(cAprov) > 0 , Substr(cAprov,nCCarac+1,nLinCar) , \" \" ),,nColCarac )\r\n\t\t\t\t\tnCCarac+=nLinCar\r\n\t\t\t\tEndIf\r\n\t\t\tNext nx\r\n\r\n\t\t\tnX:=nAprovLin\r\n\t\t\tWhile nX <= 3\t\t\t\r\n\t\t\t\toReport:SkipLine()\r\n\t\t\t\tnX:=nX+1\r\n\t\t\tEndDo\r\n\r\n\r\n\t\t\tnLinPC := oReport:Row()\r\n\t\t\toReport:PrintText( STR0082+\" \"+STR0060 ,nLinPC, 050 ) \t//\"Legendas da Aprovacao : //\"BLQ:Bloqueado\"\r\n\t\t\toReport:PrintText(       \"|  \"+STR0061 ,nLinPC, 610 ) \t//\"Ok:Liberado\"\r\n\t\t\toReport:PrintText(       \"|  \"+STR0131 ,nLinPC, 830 ) \t//\"Ok:REJEITADO\"\r\n\t\t\toReport:PrintText(       \"|  \"+STR0062 ,nLinPC, 1050 ) \t//\"??:Aguar.Lib\"\r\n\t\t\toReport:PrintText(       \"|  \"+STR0067 ,nLinPC, 1300 )\t//\"##:Nivel Lib\"\r\n\t\t\toReport:SkipLine()\r\n\r\n\t\t\toReport:SkipLine()\r\n\t\t\tIf SC7->C7_TIPO == 1 .OR. SC7->C7_TIPO == 3\r\n\t\t\t\toReport:PrintText(STR0081,,050 ) //\"NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero do nosso Pedido de Compras.\"\r\n\t\t\tElse\r\n\t\t\t\toReport:PrintText(STR0083,,050 ) //\"NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero da Autorizacao de Entrega.\"\r\n\t\t\tEndIf\r\n\t\tEndIf\r\n\t\t\r\n\tNext nVias\r\n\t\r\n\tMaFisEnd()\r\n\t\r\n\t\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Grava no SC7 as Reemissoes e atualiza o Flag de impressao.   ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\r\n\t\t\r\n\tdbSelectArea(\"SC7\")\r\n\tIf Len(aRecnoSave) > 0\r\n\t\tFor nX :=1 to Len(aRecnoSave)\r\n\t\t\tdbGoto(aRecnoSave[nX])\r\n\t\t\tIf(SC7->C7_QTDREEM >= 99)\t\r\n\t\t\t\tIf nRet == 1\r\n\t\t\t\t\tRecLock(\"SC7\",.F.)\r\n\t\t\t\t\tSC7->C7_EMITIDO := \"S\"\r\n\t\t\t\t\tMsUnLock()\r\n\t\t\t\tElseif nRet == 2\r\n\t\t\t\t\tRecLock(\"SC7\",.F.)\r\n\t\t\t\t\tSC7->C7_QTDREEM := 1\r\n\t\t\t\t\tSC7->C7_EMITIDO := \"S\"\r\n\t\t\t\t\tMsUnLock()\r\n\t\t\t\tElseif nRet == 3\r\n\t\t\t\t\t//cancelar\r\n\t\t\t\tEndif\r\n\t\t\tElse\r\n\t\t\t\tRecLock(\"SC7\",.F.)\r\n\t\t\t\tSC7->C7_QTDREEM := (SC7->C7_QTDREEM + 1)\r\n\t\t\t\tSC7->C7_EMITIDO := \"S\"\r\n\t\t\t\tMsUnLock()\r\n\t\t\tEndif\r\n\t\tNext nX\r\n\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t//³ Reposiciona o SC7 com base no ultimo elemento do aRecnoSave. ³\r\n\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\tdbGoto(aRecnoSave[Len(aRecnoSave)])\r\n\tEndif\r\n\t\r\n\tAadd(aPedMail,aPedido)\r\n\t\r\n\taRecnoSave := {}\r\n\t\r\n\tdbSelectArea(\"SC7\")\r\n\tdbSkip()\r\n\t\r\nEndDo\r\n\r\noSection2:Finish()\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Executa o ponto de entrada M110MAIL quando a impressao for   ³\r\n//³ enviada por email, fornecendo um Array para o usuario conten ³\r\n//³ do os pedidos enviados para possivel manipulacao.            ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf ExistBlock(\"M110MAIL\")\r\n\tlEnvMail := (oReport:nDevice == 3)\r\n\tIf lEnvMail\r\n\t\tExecblock(\"M110MAIL\",.F.,.F.,{aPedMail})\r\n\tEndIf\r\nEndIf\r\n\r\nIf lAuto .And. !lImpri\r\n\tAviso(STR0104,STR0105,{\"OK\"})\r\nEndif\r\n\r\ndbSelectArea(\"SC7\")\r\ndbClearFilter()\r\ndbSetOrder(1)\r\n\r\nReturn\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Programa  ³CabecPCxAE³ Autor ³Alexandre Inacio Lemes ³Data  ³06/09/2006³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Emissao do Pedido de Compras / Autorizacao de Entrega      ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ CabecPCxAE(ExpO1,ExpO2,ExpN1,ExpN2)                        ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ ExpO1 = Objeto oReport                      \t              ³±±\r\n±±³          ³ ExpO2 = Objeto da sessao1 com o cabec                      ³±±\r\n±±³          ³ ExpN1 = Numero de Vias                                     ³±±\r\n±±³          ³ ExpN2 = Numero de Pagina                                   ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Retorno   ³Nenhum                                                      ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function CabecPCxAE(oReport,oSection1,nVias,nPagina)\r\n\r\nLocal cMoeda\t\t:= IIf( mv_par12 < 10 , Str(mv_par12,1) , Str(mv_par12,2) )\r\nLocal nLinPC\t\t:= 0\r\nLocal nTpImp\t  \t:= IIF(ValType(oReport:nDevice)!=Nil,oReport:nDevice,0) // Tipo de Impressao\r\nLocal nPageWidth\t:= IIF(nTpImp==1.Or.nTpImp==6,2435,2435)\r\nLocal cCident\t\t:= IIF(len(SM0->M0_CIDENT)>20,Substr(SM0->M0_CIDENT,1,15),SM0->M0_CIDENT)\r\nLocal cCGC\t\t\t:= \"\"\r\nPublic nRet\t\t:= 0\r\n\r\nIf Val(cMoeda) == 0\r\n\tcMoeda := \"1\"\r\nEndif\r\n\r\nTRPosition():New(oSection1,\"SA2\",1,{ || xFilial(\"SA2\") + SC7->C7_FORNECE + SC7->C7_LOJA })\r\ncBitmap := R110Logo()\r\n\r\nSA2->(dbSetOrder(1))\r\nSA2->(dbSeek(xFilial(\"SA2\") + SC7->C7_FORNECE + SC7->C7_LOJA))\r\n\r\noSection1:Init()\r\n\r\noReport:Box( 010 , 010 ,  260 , 1000 )\r\noReport:Box( 010 , 1010,  260 , nPageWidth-2 ) \r\n\r\noReport:PrintText( If(nPagina > 1,(STR0033),\" \"),,oSection1:Cell(\"M0_NOMECOM\"):ColPos())\r\n\r\nnLinPC := oReport:Row()\r\noReport:PrintText( If( mv_par08 == 1 , (STR0068), (STR0069) ) + \" - \" + GetMV(\"MV_MOEDA\"+cMoeda) ,nLinPC,1030 )\r\noReport:PrintText( If( mv_par08 == 1 , SC7->C7_NUM, SC7->C7_NUMSC + \"/\" + SC7->C7_NUM ) + \" /\" + Ltrim(Str(nPagina,2)) ,nLinPC,1910 )\r\noReport:SkipLine()\r\n\r\n\r\nnLinPC := oReport:Row()\r\nIf(SC7->C7_QTDREEM >= 99)\t\r\n\tnRet := Aviso(\"TOTVS\", STR0125 +chr(13)+chr(10)+ \"1- \" + STR0126 +chr(13)+chr(10)+ \"2- \" + STR0127 +chr(13)+chr(10)+ \"3- \" + STR0128,{\"1\", \"2\", \"3\"},2)\r\n\tIf(nRet == 1)\r\n\t\toReport:PrintText( Str(SC7->C7_QTDREEM,2) + STR0034 + Str(nVias,2) + STR0035 ,nLinPC,1910 )\r\n\tElseif(nRet == 2)\r\n\t\toReport:PrintText( \"1\" + STR0034 + Str(nVias,2) + STR0035 ,nLinPC,1910 )\r\n\tElseif(nRet == 3)\r\n\t\toReport:CancelPrint()\r\n\tEndif\r\nElse\t\t\r\n\toReport:PrintText( If( SC7->C7_QTDREEM > 0, Str(SC7->C7_QTDREEM+1,2) , \"1\" ) + STR0034 + Str(nVias,2) + STR0035 ,nLinPC,1910 )\r\nEndif                                             \r\n\r\noReport:SkipLine()\r\n\r\n_cFileLogo\t:= GetSrvProfString('Startpath','') + cBitmap\r\noReport:SayBitmap(25,25,_cFileLogo,150,60) // insere o logo no relatorio\r\n\r\nnLinPC := oReport:Row()\r\noReport:PrintText(STR0087 + SM0->M0_NOMECOM,nLinPC,15)  // \"Empresa:\"\r\noReport:PrintText(STR0106 + Substr(SA2->A2_NOME,1,50) + \" \" + STR0107 + SA2->A2_COD + \" \" + STR0108 + SA2->A2_LOJA ,nLinPC,1025)\r\noReport:SkipLine()\r\n\r\nnLinPC := oReport:Row()\r\noReport:PrintText(STR0088 + SM0->M0_ENDENT,nLinPC,15)\r\noReport:PrintText(STR0088 + Substr(SA2->A2_END,1,49) + \" \" + STR0109 + Substr(SA2->A2_BAIRRO,1,25),nLinPC,1025)\r\noReport:SkipLine()\r\n\r\nIf cPaisLoc == \"BRA\"\r\n\tcCGC\t:= Transform(SA2->A2_CGC,Iif(SA2->A2_TIPO == 'F',Substr(PICPES(SA2->A2_TIPO),1,17),Substr(PICPES(SA2->A2_TIPO),1,21))) \r\nElse  \r\n\tcCGC\t:= SA2->A2_CGC\r\nEndIf   \r\n        \r\nnLinPC := oReport:Row()\r\noReport:PrintText(STR0089 + Trans(SM0->M0_CEPENT,PesqPict(\"SA2\",\"A2_CEP\"))+Space(2)+STR0090 + \"  \" + RTRIM(SM0->M0_CIDENT) + \" \" + STR0091 + SM0->M0_ESTENT ,nLinPC,15)\r\noReport:PrintText(STR0110+Left(SA2->A2_MUN, 30)+\" \"+STR0111+SA2->A2_EST+\" \"+STR0112+SA2->A2_CEP+\" \"+STR0124+\":\"+cCGC,nLinPC,1025)\r\noReport:SkipLine()\r\n\r\nnLinPC := oReport:Row()\r\noReport:PrintText(STR0092 + SM0->M0_TEL + Space(2) + STR0093 + SM0->M0_FAX ,nLinPC,15)\r\noReport:PrintText(STR0094 + \"(\"+Substr(SA2->A2_DDD,1,3)+\") \"+Substr(SA2->A2_TEL,1,15) + \" \"+STR0114+\"(\"+Substr(SA2->A2_DDD,1,3)+\") \"+SubStr(SA2->A2_FAX,1,15)+\" \"+If( cPaisLoc$\"ARG|POR|EUA\",space(11) , STR0095 )+If( cPaisLoc$\"ARG|POR|EUA\",space(18), SA2->A2_INSCR ),nLinPC,1025)\r\noReport:SkipLine()\r\n\r\nnLinPC := oReport:Row()\r\noReport:PrintText(STR0124 + Transform(SM0->M0_CGC,PesqPict(\"SA2\",\"A2_CGC\")) ,nLinPC,15)\r\nIf cPaisLoc == \"BRA\"\r\n\toReport:PrintText(Space(2) + STR0041 + InscrEst() ,nLinPC,415)\r\nEndif\r\noReport:SkipLine()\r\noReport:SkipLine()\r\n\r\noSection1:Finish()\r\n\r\nReturn\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ MATR110R3³ Autor ³ Wagner Xavier         ³ Data ³ 05.09.91 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Emissao do Pedido de Compras                               ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ Generico                                                   ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ ATUALIZACOES SOFRIDAS DESDE A CONSTRUCAO INICIAL.                     ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ PROGRAMADOR  ³ DATA   ³ BOPS ³  MOTIVO DA ALTERACAO                   ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³              ³        ³      ³                                        ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Descri‡ao ³ PLANO DE MELHORIA CONTINUA        ³Programa: MATR110R3.PRX ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ITEM PMC  ³ Responsavel              ³ Data          |BOPS             ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³      01  ³                          ³               ³                 ³±±\r\n±±³      02  ³ Marcos V. Ferreira       ³ 01/02/2006    ³                 ³±±\r\n±±³      03  ³                          ³               ³                 ³±±\r\n±±³      04  ³ Ricardo Berti            ³ 03/05/2006    ³00000097026      ³±±\r\n±±³      05  ³                          ³               ³                 ³±±\r\n±±³      06  ³ Marcos V. Ferreira       ³ 01/02/2006    ³                 ³±±\r\n±±³      07  ³ Ricardo Berti            ³ 03/05/2006    ³00000097026      ³±±\r\n±±³      08  ³ Flavio Luiz Vicco        ³ 07/04/2006    ³00000094742      ³±±\r\n±±³      09  ³                          ³               ³                 ³±±\r\n±±³      10  ³ Flavio Luiz Vicco        ³ 07/04/2006    ³00000094742      ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nUser Function ITMMATR110R3(cAlias,nReg,nOpcx)\r\n\r\nLOCAL wnrel\t\t:= \"MATR110\"\r\nLOCAL cDesc1\t:= STR0001\t//\"Emissao dos pedidos de compras ou autorizacoes de entrega\"\r\nLOCAL cDesc2\t:= STR0002\t//\"cadastradados e que ainda nao foram impressos\"\r\nLOCAL cDesc3\t:= \" \"\r\nLOCAL cString\t:= \"SC7\"\r\nLocal lComp\t\t:= .T.\t// Ativado habilita escolher modo RETRATO / PAISAGEM\r\nLocal cUserId   := RetCodUsr()\r\nLocal cCont     := Nil\r\n\r\nPRIVATE lAuto\t\t:= (nReg!=Nil)\r\nPRIVATE Tamanho\t\t:= \"G\"\r\nPRIVATE titulo\t \t:=STR0003\t\t\t\t\t\t\t\t\t\t//\"Emissao dos Pedidos de Compras ou Autorizacoes de Entrega\"\r\nPRIVATE aReturn \t:= {STR0004, 1,STR0005, 1, 2, 1, \"\",0 }\t\t//\"Zebrado\"###\"Administracao\"\r\nPRIVATE nomeprog\t:=\"MATR110\"\r\nPRIVATE nLastKey\t:= 0\r\nPRIVATE nBegin\t\t:= 0\r\nPRIVATE nDifColCC   := 0\r\nPRIVATE aLinha\t\t:= {}\r\nPRIVATE aSenhas\t\t:= {}\r\nPRIVATE aUsuarios\t:= {}\r\nPRIVATE M_PAG\t\t:= 1\r\nIf Type(\"lPedido\") != \"L\"\r\n\tlPedido := .F.\r\nEndif\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Variaveis utilizadas para parametros                         ³\r\n//³ mv_par01               Do Pedido                             ³\r\n//³ mv_par02               Ate o Pedido                          ³\r\n//³ mv_par03               A partir da data de emissao           ³\r\n//³ mv_par04               Ate a data de emissao                 ³\r\n//³ mv_par05               Somente os Novos                      ³\r\n//³ mv_par06               Campo Descricao do Produto    \t     ³\r\n//³ mv_par07               Unidade de Medida:Primaria ou Secund. ³\r\n//³ mv_par08               Imprime ? Pedido Compra ou Aut. Entreg³\r\n//³ mv_par09               Numero de vias                        ³\r\n//³ mv_par10               Pedidos ? Liberados Bloqueados Ambos  ³\r\n//³ mv_par11               Impr. SC's Firmes, Previstas ou Ambas ³\r\n//³ mv_par12               Qual a Moeda ?                        ³\r\n//³ mv_par13               Endereco de Entrega                   ³\r\n//³ mv_par14               todas ou em aberto ou atendidos       ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nPergunte(\"MTR110\",.F.)\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Verifica se no SX3 o C7_CC esta com tamanho 9 (Default) se igual a 9 muda o tamanho do relatorio           ³\r\n//³ para Medio possibilitando a impressao em modo Paisagem ou retrato atraves da reducao na variavel nDifColCC ³\r\n//³ se o tamanho do C7_CC no SX3 estiver > que 9 o relatorio sera impresso comprrimido com espaco para o campo ³\r\n//³ C7_CC centro de custo para ate 20 posicoes,Obs.desabilitando a selecao do modo de impresso retrato/paisagem³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf TamSx3(\"C7_CC\")[1] == 9\r\n\tnDifColCC := 11\r\n\tTamanho   := \"M\"\r\nElse\r\n\tlComp\t  := .F.   // C.Custo c/ tamanho maior que 9, sempre PAISAGEM\r\nEndIf\r\n\r\nwnrel:=SetPrint(cString,wnrel,If(lAuto,Nil,\"MTR110\"),@Titulo,cDesc1,cDesc2,cDesc3,.F.,,lComp,Tamanho,,!lAuto)\r\n\r\nIf nLastKey <> 27\r\n\r\n\tSetDefault(aReturn,cString)\r\n\r\n\tIf lAuto\r\n\t\tmv_par08 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"08\"),If(cCont == Nil,SC7->C7_TIPO,cCont) })\r\n\tEndIf\r\n\r\n\tIf lPedido\r\n\t\tmv_par12 := MAX(SC7->C7_MOEDA,1)\r\n\tEndIf\r\n\r\n\tIf mv_par08 == 1 .OR. mv_par08 == 3\r\n\t\tRptStatus({|lEnd| C110PC(@lEnd,wnRel,cString,nReg)},titulo)\r\n\tElse\r\n\t\tRptStatus({|lEnd| C110AE(@lEnd,wnRel,cString,nReg)},titulo)\r\n\tEndIf\r\n\r\n\tlPedido := .F.\r\n\t\r\nElse \r\n\tdbClearFilter()\r\nEndIf\r\n\r\nReturn .T.\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ C110PC   ³ Autor ³ Cristina M. Ogura     ³ Data ³ 09.11.95 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Chamada do Relatorio                                       ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MATR110\t\t\t                                          ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function C110PC(lEnd,WnRel,cString,nReg)\r\nLocal nReem\r\nLocal nOrder\r\nLocal cCondBus\r\nLocal nSavRec\r\nLocal aPedido := {}\r\nLocal aPedMail:= {}\r\nLocal aSavRec := {}\r\nLocal nLinObs := 0\r\nLocal i       := 0\r\nLocal ncw     := 0\r\nLocal cFiltro := \"\"\r\nLocal cUserId := RetCodUsr()\r\nLocal cCont   := Nil\r\nLocal lImpri  := .F.\r\nLocal lC7OBSChar  := Type( \"SC7->C7_OBS\" ) == \"C\"\r\n\r\nPrivate cCGCPict, cCepPict\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³Definir as pictures                                           ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\ncCepPict:=PesqPict(\"SA2\",\"A2_CEP\")\r\ncCGCPict:=PesqPict(\"SA2\",\"A2_CGC\")\r\n\r\nIf nDifColCC < 11\r\n\tlimite   := 139\r\nElse\r\n\tlimite   := 129\r\nEndif\r\n\r\nli       := 80\r\nnDescProd:= 0\r\nnTotal   := 0\r\nnTotMerc := 0\r\nNumPed   := Space(6)\r\n\r\nIf lAuto\r\n\tdbSelectArea(\"SC7\")\r\n\tdbGoto(nReg)\r\n\tSetRegua(1)\r\n\tmv_par01 := C7_NUM\r\n\tmv_par02 := C7_NUM\r\n\tmv_par03 := C7_EMISSAO\r\n\tmv_par04 := C7_EMISSAO\r\n\tmv_par05 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"05\"),If(cCont == Nil,2,cCont) })\r\n   \tmv_par08 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"08\"),If(cCont == Nil,C7_TIPO,cCont) })\r\n\tmv_par09 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"09\"),If(cCont == Nil,1,cCont) })\r\n  \tmv_par10 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"10\"),If(cCont == Nil,3,cCont) }) \r\n\tmv_par11 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"11\"),If(cCont == Nil,3,cCont) }) \r\n  \tmv_par14 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"14\"),If(cCont == Nil,1,cCont) }) \r\nEndIf\r\n\r\nIf ( cPaisLoc$\"ARG|POR|EUA\" )\r\n\tcCondBus\t:=\t\"1\"+strzero(val(mv_par01),6)\r\n\tnOrder\t:=\t10\r\n\tnTipo\t\t:= 1\r\nElse\r\n\tcCondBus\t:=mv_par01\r\n\tnOrder\t:=\t1\r\nEndIf\r\n\r\nIf mv_par14 == 2\r\n\tcFiltro := \"SC7->C7_QUANT-SC7->C7_QUJE <= 0 .Or. !EMPTY(SC7->C7_RESIDUO)\"\r\nElseif mv_par14 == 3\r\n\tcFiltro := \"SC7->C7_QUANT > SC7->C7_QUJE\"\r\nEndIf\r\n\r\ndbSelectArea(\"SC7\")\r\ndbSetOrder(nOrder)\r\nSetRegua(RecCount())\r\ndbSeek(xFilial(\"SC7\")+cCondBus,.T.)\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Faz manualmente porque nao chama a funcao Cabec()                 ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n@ 0,0 PSay AvalImp(Iif(nDifColCC < 11,220,132))\r\n\r\nWhile !Eof() .And. C7_FILIAL = xFilial(\"SC7\") .And. C7_NUM >= mv_par01 .And. ;\r\n\t\tC7_NUM <= mv_par02\r\n\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Cria as variaveis para armazenar os valores do pedido        ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tnOrdem   := 1\r\n\tnReem    := 0\r\n\tcObs01   := \" \"\r\n\tcObs02   := \" \"\r\n\tcObs03   := \" \"\r\n\tcObs04   := \" \"\r\n\r\n\tIf\tC7_EMITIDO == \"S\" .And. mv_par05 == 1\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndif\r\n\tIf\t(C7_CONAPRO <> \"B\" .And. mv_par10 == 2) .Or.;\r\n\t\t(C7_CONAPRO <> \"L\" .And. mv_par10 == 1)\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndif\r\n\tIf\t(C7_EMISSAO < mv_par03) .Or. (C7_EMISSAO > mv_par04)\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndif\r\n\tIf\tC7_TIPO == 2\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndIf\r\n\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Consiste este item. EM ABERTO                                ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tIf mv_par14 == 2\r\n\t\tIf SC7->C7_QUANT-SC7->C7_QUJE <= 0 .Or. !EMPTY(SC7->C7_RESIDUO)\r\n\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\tdbSkip()\r\n\t\t\tLoop\r\n\t\tEndif\r\n\tEndif\r\n\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Consiste este item. ATENDIDOS                                ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tIf mv_par14 == 3\r\n\t\tIf SC7->C7_QUANT > SC7->C7_QUJE\r\n\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\tdbSkip()\r\n\t\t\tLoop\r\n\t\tEndif\r\n\tEndif\r\n\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Filtra Tipo de SCs Firmes ou Previstas                       ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tIf !MtrAValOP(mv_par11, 'SC7')\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndIf\r\n\r\n\tMaFisEnd()\r\n\tR110FIniPC(SC7->C7_NUM,,,cFiltro)\r\n\r\n\tFor ncw := 1 To mv_par09\t\t// Imprime o numero de vias informadas\r\n\r\n\t\tImpCabec(ncw)\r\n\r\n\t\tnTotal   := 0\r\n\t\tnTotMerc\t:= 0\r\n\t\tnDescProd:= 0\r\n\t\tnReem    := SC7->C7_QTDREEM + 1\r\n\t\tnSavRec  := SC7->(Recno())\r\n\t\tNumPed   := SC7->C7_NUM\r\n\t\tnLinObs  := 0\r\n\t\taPedido  := {SC7->C7_FILIAL,SC7->C7_NUM,SC7->C7_EMISSAO,SC7->C7_FORNECE,SC7->C7_LOJA,SC7->C7_TIPO}\r\n\r\n\t\tWhile !Eof() .And. C7_FILIAL = xFilial(\"SC7\") .And. C7_NUM == NumPed\r\n\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Consiste este item. EM ABERTO                                ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf mv_par14 == 2\r\n\t\t\t\tIf SC7->C7_QUANT-SC7->C7_QUJE <= 0 .Or. !EMPTY(SC7->C7_RESIDUO)\r\n\t\t\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\t\t\tdbSkip()\r\n\t\t\t\t\tLoop\r\n\t\t\t\tEndif\r\n\t\t\tEndif\r\n\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Consiste este item. ATENDIDOS                                ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf mv_par14 == 3\r\n\t\t\t\tIf SC7->C7_QUANT > SC7->C7_QUJE\r\n\t\t\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\t\t\tdbSkip()\r\n\t\t\t\t\tLoop\r\n\t\t\t\tEndif\r\n\t\t\tEndif\r\n\r\n\t\t\tIf Ascan(aSavRec,Recno()) == 0\t\t// Guardo recno p/gravacao\r\n\t\t\t\tAADD(aSavRec,Recno())\r\n\t\t\tEndif\r\n\t\t\tIf lEnd\r\n\t\t\t\t@PROW()+1,001 PSAY STR0006\t//\"CANCELADO PELO OPERADOR\"\r\n\t\t\t\tGoto Bottom\r\n\t\t\t\tExit\r\n\t\t\tEndif\r\n\r\n\t\t\tIncRegua()\r\n\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Verifica se havera salto de formulario                       ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf li > 56\r\n\t\t\t\tnOrdem++\r\n\t\t\t\tImpRodape()\t\t\t// Imprime rodape do formulario e salta para a proxima folha\r\n\t\t\t\tImpCabec(ncw)\r\n\t\t\tEndif\r\n\r\n\t\t\tli++\r\n\r\n\t\t\t@ li,001 PSAY \"|\"\r\n\t\t\t@ li,002 PSAY C7_ITEM  \t\tPicture PesqPict(\"SC7\",\"C7_ITEM\")\r\n\t\t\t@ li,006 PSAY \"|\"\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Pesquisa Descricao do Produto                                ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tImpProd()\r\n\r\n\t\t\tIf SC7->C7_DESC1 != 0 .or. SC7->C7_DESC2 != 0 .or. SC7->C7_DESC3 != 0\r\n\t\t\t\tnDescProd+= CalcDesc(SC7->C7_TOTAL,SC7->C7_DESC1,SC7->C7_DESC2,SC7->C7_DESC3)\r\n\t\t\tElse\r\n\t\t\t\tnDescProd+=SC7->C7_VLDESC\r\n\t\t\tEndif\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Inicializacao da Observacao do Pedido.                       ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf lC7OBSChar .AND. !Empty(SC7->C7_OBS) .And. nLinObs < 5\r\n\t\t\t\tIf !(SC7->C7_OBS $ SC7->C7_OBSM) \r\n\t\t\t\t\tnLinObs++\r\n\t\t\t\t\tcVar:=\"cObs\"+StrZero(nLinObs,2)\r\n\t\t\t\t\tEval(MemVarBlock(cVar),Alltrim(SC7->C7_OBS))\r\n\t\t\t\tEndIf\r\n\t\t\tEndif\r\n\t\t\t\r\n\t\t\tIf !Empty(SC7->C7_OBSM) .And. nLinObs < 5\r\n\t\t\t\tnLinObs++\r\n\t\t\t\tcVar:=\"cObs\"+StrZero(nLinObs,2)\r\n\t\t\t\tEval(MemVarBlock(cVar),Alltrim(SC7->C7_OBSM))\r\n\t\t\tEndif\r\n\t\t\t\r\n\t\t\tlImpri  := .T.\r\n\t\t\tdbSkip()\r\n\t\tEndDo\r\n\r\n\t\tdbGoto(nSavRec)\r\n\r\n\t\tIf li>38\r\n\t\t\tnOrdem++\r\n\t\t\tImpRodape()\t\t// Imprime rodape do formulario e salta para a proxima folha\r\n\t\t\tImpCabec(ncw)\r\n\t\tEndif\r\n\r\n\t\tFinalPed(nDescProd)\t\t// Imprime os dados complementares do PC\r\n\r\n\tNext\r\n\r\n\tMaFisEnd()\r\n\r\n\tIf Len(aSavRec)>0\r\n\t\tFor i:=1 to Len(aSavRec)\r\n\t\t\tdbGoto(aSavRec[i])\r\n\t\t\tRecLock(\"SC7\",.F.)  //Atualizacao do flag de Impressao\r\n\t\t\tReplace C7_QTDREEM With (C7_QTDREEM+1)\r\n\t\t\tReplace C7_EMITIDO With \"S\"\r\n\t\t\tMsUnLock()\r\n\t\tNext\r\n\t\tdbGoto(aSavRec[Len(aSavRec)])\t\t// Posiciona no ultimo elemento e limpa array\r\n\tEndif\r\n\r\n\tAadd(aPedMail,aPedido)\r\n\r\n\taSavRec := {}\r\n\r\n\tdbSkip()\r\nEndDo\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Executa o ponto de entrada M110MAIL quando a impressao for   ³\r\n//³ enviada por email, fornecendo um Array para o usuario conten ³\r\n//³ do os pedidos enviados para possivel manipulacao.            ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf ExistBlock(\"M110MAIL\")\r\n\tlEnvMail := HasEmail(,,,,.F.)\r\n\tIf lEnvMail\r\n\t\tExecblock(\"M110MAIL\",.F.,.F.,{aPedMail})\r\n\tEndIf\r\nEndIf\r\n\r\nIf lAuto .And. !lImpri\r\n\tAviso(STR0104,STR0105,{\"OK\"})\r\nEndif\r\n\r\ndbSelectArea(\"SC7\")\r\ndbClearFilter()\r\ndbSetOrder(1)\r\n\r\ndbSelectArea(\"SX3\")\r\ndbSetOrder(1)\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Se em disco, desvia para Spool                               ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf aReturn[5] == 1    // Se Saida para disco, ativa SPOOL\r\n\tSet Printer TO\r\n\tdbCommitAll()\r\n\tourspool(wnrel)\r\nEndif\r\n\r\nMS_FLUSH()\r\n\r\nReturn .T.\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ C110AE   ³ Autor ³ Cristina M. Ogura     ³ Data ³ 09.11.95 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Chamada do Relatorio                                       ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MATR110\t\t\t                                          ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function C110AE(lEnd,WnRel,cString,nReg)\r\nLocal nReem\r\nLocal nSavRec,aSavRec := {}\r\nLocal aPedido := {}\r\nLocal aPedMail:= {}\r\nLocal nLinObs := 0\r\nLocal ncw     := 0\r\nLocal i       := 0\r\nLocal cFiltro := \"\"\r\nLocal cUserId := RetCodUsr()\r\nLocal lImpri  := .F.\r\nLocal lC7OBSChar  := Type( \"SC7->C7_OBS\" ) == \"C\"\r\n\r\nPrivate cCGCPict, cCepPict\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³Definir as pictures                                           ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\ncCepPict:=PesqPict(\"SA2\",\"A2_CEP\")\r\ncCGCPict:=PesqPict(\"SA2\",\"A2_CGC\")\r\n\r\nIf nDifColCC < 11\r\n\tlimite   := 139\r\nElse\r\n\tlimite   := 129\r\nEndif\r\n\r\nli       := 80\r\nnDescProd:= 0\r\nnTotal   := 0\r\nnTotMerc := 0\r\nNumPed   := Space(6)\r\n\r\nIf !lAuto\r\n\tdbSelectArea(\"SC7\")\r\n\tdbSetOrder(10)\r\n\tdbSeek(xFilial(\"SC7\")+\"2\"+mv_par01,.T.)\r\nElse\r\n\tdbSelectArea(\"SC7\")\r\n\tdbGoto(nReg)\r\n\tmv_par01 := C7_NUM\r\n\tmv_par02 := C7_NUM\r\n\tmv_par03 := C7_EMISSAO\r\n\tmv_par04 := C7_EMISSAO\r\n\tmv_par05 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"05\"),If(cCont == Nil,2,cCont) })\r\n\tmv_par08 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"08\"),If(cCont == Nil,C7_TIPO,cCont) })\r\n\tmv_par09 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"09\"),If(cCont == Nil,1,cCont) })\r\n\tmv_par10 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"10\"),If(cCont == Nil,3,cCont) }) \r\n\tmv_par11 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"11\"),If(cCont == Nil,3,cCont) }) \r\n  \tmv_par14 := Eval({|| cCont:=ChkPergUs(cUserId,\"MTR110\",\"14\"),If(cCont == Nil,1,cCont) }) \r\n\r\n\tdbSelectArea(\"SC7\")\r\n\tdbSetOrder(10)\r\n\tdbSeek(xFilial(\"SC7\")+\"2\"+mv_par01,.T.)\r\nEndIf\r\n\r\nIf mv_par14 == 2\r\n\tcFiltro := \"SC7->C7_QUANT-SC7->C7_QUJE <= 0 .Or. !EMPTY(SC7->C7_RESIDUO)\"\r\nElseif mv_par14 == 3\r\n\tcFiltro := \"SC7->C7_QUANT > SC7->C7_QUJE\"\r\nEndIf\r\n\r\nSetRegua(Reccount())\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Faz manualmente porque nao chama a funcao Cabec()                 ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n@ 0,0 PSay AvalImp(Iif(nDifColCC < 11,220,132))\r\nWhile !Eof().And.C7_FILIAL = xFilial(\"SC7\") .And. C7_NUM >= mv_par01 .And. C7_NUM <= mv_par02\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Cria as variaveis para armazenar os valores do pedido        ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tnOrdem   := 1\r\n\tnReem    := 0\r\n\tcObs01   := \" \"\r\n\tcObs02   := \" \"\r\n\tcObs03   := \" \"\r\n\tcObs04   := \" \"\r\n\r\n\tIf\tC7_EMITIDO == \"S\" .And. mv_par05 == 1\r\n\t\tdbSelectArea(\"SC7\")\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndif\r\n\tIf\t(C7_CONAPRO <> \"B\" .And. mv_par10 == 2) .Or.;\r\n\t\t(C7_CONAPRO <> \"L\" .And. mv_par10 == 1)\r\n\t\tdbSelectArea(\"SC7\")\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndif\r\n\tIf\t(SC7->C7_EMISSAO < mv_par03) .Or. (SC7->C7_EMISSAO > mv_par04)\r\n\t\tdbSelectArea(\"SC7\")\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndif\r\n\tIf\tSC7->C7_TIPO != 2\r\n\t\tdbSelectArea(\"SC7\")\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndIf\r\n\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Consiste este item. EM ABERTO                                ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tIf mv_par14 == 2\r\n\t\tIf SC7->C7_QUANT-SC7->C7_QUJE <= 0 .Or. !EMPTY(SC7->C7_RESIDUO)\r\n\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\tdbSkip()\r\n\t\t\tLoop\r\n\t\tEndif\r\n\tEndif\r\n\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Consiste este item. ATENDIDOS                                ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tIf mv_par14 == 3\r\n\t\tIf SC7->C7_QUANT > SC7->C7_QUJE\r\n\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\tdbSkip()\r\n\t\t\tLoop\r\n\t\tEndif\r\n\tEndif\r\n\r\n\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t//³ Filtra Tipo de SCs Firmes ou Previstas                       ³\r\n\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\tIf !MtrAValOP(mv_par11, 'SC7')\r\n\t\tdbSelectArea(\"SC7\")\r\n\t\tdbSkip()\r\n\t\tLoop\r\n\tEndIf\r\n\r\n\tMaFisEnd()\r\n\tR110FIniPC(SC7->C7_NUM,,,cFiltro)\r\n\r\n\tFor ncw := 1 To mv_par09\t\t// Imprime o numero de vias informadas\r\n\r\n\t\tImpCabec(ncw)\r\n\r\n\t\tnTotal   := 0\r\n\t\tnTotMerc := 0\r\n\r\n\t\tnDescProd:= 0\r\n\t\tnReem    := SC7->C7_QTDREEM + 1\r\n\t\tnSavRec  := SC7->(Recno())\r\n\t\tNumPed   := SC7->C7_NUM\r\n\t\tnLinObs := 0\r\n\t\taPedido  := {SC7->C7_FILIAL,SC7->C7_NUM,SC7->C7_EMISSAO,SC7->C7_FORNECE,SC7->C7_LOJA,SC7->C7_TIPO}\r\n\r\n\t\tWhile !Eof() .And. C7_FILIAL = xFilial(\"SC7\") .And. C7_NUM == NumPed\r\n\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Consiste este item. EM ABERTO                                ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf mv_par14 == 2\r\n\t\t\t\tIf SC7->C7_QUANT-SC7->C7_QUJE <= 0 .Or. !EMPTY(SC7->C7_RESIDUO)\r\n\t\t\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\t\t\tdbSkip()\r\n\t\t\t\t\tLoop\r\n\t\t\t\tEndif\r\n\t\t\tEndif\r\n\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Consiste este item. ATENDIDOS                                ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf mv_par14 == 3\r\n\t\t\t\tIf SC7->C7_QUANT > SC7->C7_QUJE\r\n\t\t\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\t\t\tdbSkip()\r\n\t\t\t\t\tLoop\r\n\t\t\t\tEndif\r\n\t\t\tEndif\r\n\r\n\t\t\tIf Ascan(aSavRec,Recno()) == 0\t\t// Guardo recno p/gravacao\r\n\t\t\t\tAADD(aSavRec,Recno())\r\n\t\t\tEndif\r\n\r\n\t\t\tIf lEnd\r\n\t\t\t\t@PROW()+1,001 PSAY STR0006\t\t//\"CANCELADO PELO OPERADOR\"\r\n\t\t\t\tGoto Bottom\r\n\t\t\t\tExit\r\n\t\t\tEndif\r\n\r\n\t\t\tIncRegua()\r\n\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Verifica se havera salto de formulario                       ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf li > 56\r\n\t\t\t\tnOrdem++\r\n\t\t\t\tImpRodape()\t\t// Imprime rodape do formulario e salta para a proxima folha\r\n\t\t\t\tImpCabec(ncw)\r\n\t\t\tEndif\r\n\t\t\tli++\r\n\t\t\t@ li,001 PSAY \"|\"\r\n\t\t\t@ li,002 PSAY SC7->C7_ITEM  \tPicture PesqPict(\"SC7\",\"C7_ITEM\")\r\n\t\t\t@ li,006 PSAY \"|\"\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Pesquisa Descricao do Produto                                ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tImpProd()\t\t// Imprime dados do Produto\r\n\r\n\t\t\tIf SC7->C7_DESC1 != 0 .or. SC7->C7_DESC2 != 0 .or. SC7->C7_DESC3 != 0\r\n\t\t\t\tnDescProd+= CalcDesc(SC7->C7_TOTAL,SC7->C7_DESC1,SC7->C7_DESC2,SC7->C7_DESC3)\r\n\t\t\tElse\r\n\t\t\t\tnDescProd+=SC7->C7_VLDESC\r\n\t\t\tEndif\r\n\t\t\t//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n\t\t\t//³ Inicializacao da Observacao do Pedido.                       ³\r\n\t\t\t//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\n\t\t\tIf lC7OBSChar .AND. !Empty(SC7->C7_OBS) .And. nLinObs < 5\r\n\t\t\t\tnLinObs++\r\n\t\t\t\tcVar:=\"cObs\"+StrZero(nLinObs,2)\r\n\t\t\t\tEval(MemVarBlock(cVar),Alltrim(SC7->C7_OBS))\r\n\t\t\tEndif\r\n\t\t\t\r\n\t\t\tIf !EMPTY(SC7->C7_OBSM) .And. nLinObs < 5\r\n\t\t\t\tnLinObs++\r\n\t\t\t\tcVar:=\"cObs\"+StrZero(nLinObs,2)\r\n\t\t\t\tEval(MemVarBlock(cVar),Alltrim(SC7->C7_OBSM))\r\n\t\t\tEndif\r\n\t\t\t\r\n\t\t\tlImpri  := .T.\r\n\t\t\tdbSelectArea(\"SC7\")\r\n\t\t\tdbSkip()\r\n\t\tEndDo\r\n\r\n\t\tdbGoto(nSavRec)\r\n\t\tIf li>38\r\n\t\t\tnOrdem++\r\n\t\t\tImpRodape()\t\t// Imprime rodape do formulario e salta para a proxima folha\r\n\t\t\tImpCabec(ncw)\r\n\t\tEndif\r\n\r\n\t\tFinalAE(nDescProd)\t\t// dados complementares da Autorizacao de Entrega\r\n\tNext\r\n\r\n\tMaFisEnd()\r\n\r\n\tIf Len(aSavRec)>0\r\n\t\tdbGoto(aSavRec[Len(aSavRec)])\r\n\t\tFor i:=1 to Len(aSavRec)\r\n\t\t\tdbGoto(aSavRec[i])\r\n\t\t\tRecLock(\"SC7\",.F.)  //Atualizacao do flag de Impressao\r\n\t\t\tReplace C7_EMITIDO With \"S\"\r\n\t\t\tReplace C7_QTDREEM With (C7_QTDREEM+1)\r\n\t\t\tMsUnLock()\r\n\t\tNext\r\n\tEndif\r\n\r\n\tAadd(aPedMail,aPedido)\r\n\r\n\taSavRec := {}\r\n\r\n\tdbSelectArea(\"SC7\")\r\n\tdbSkip()\r\nEnd\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Executa o ponto de entrada M110MAIL quando a impressao for   ³\r\n//³ enviada por email, fornecendo um Array para o usuario conten ³\r\n//³ do os pedidos enviados para possivel manipulacao.            ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf ExistBlock(\"M110MAIL\")\r\n\tlEnvMail := HasEmail(,,,,.F.)\r\n\tIf lEnvMail\r\n\t\tExecblock(\"M110MAIL\",.F.,.F.,{aPedMail})\r\n\tEndIf\r\nEndIf\r\n\r\nIf lAuto .And. !lImpri\r\n\tAviso(STR0104,STR0105,{\"OK\"})\r\nEndif\r\n\r\ndbSelectArea(\"SC7\")\r\ndbClearFilter()\r\ndbSetOrder(1)\r\n\r\ndbSelectArea(\"SX3\")\r\ndbSetOrder(1)\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Se em disco, desvia para Spool                               ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf aReturn[5] == 1    // Se Saida para disco, ativa SPOOL\r\n\tSet Printer TO\r\n\tCommit\r\n\tourspool(wnrel)\r\nEndif\r\n\r\nMS_FLUSH()\r\n\r\nReturn .T.\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ ImpProd  ³ Autor ³ Wagner Xavier         ³ Data ³          ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Pesquisar e imprimir  dados Cadastrais do Produto.         ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ ImpProd(Void)                                              ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function ImpProd()\r\n******************************************************************************\r\n*\r\n*\r\n******\r\n\r\nLOCAL nBegin   := 0, cDescri := \"\", nLinha:=0\r\nLOCAL nTamDesc := 26\r\nLOCAL aColuna  := Array(8)\r\nLOCAL nTamProd := 15\r\n\r\nIf Empty(mv_par06)\r\n\tmv_par06 := \"B1_DESC\"\r\nEndIf\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Impressao da descricao generica do Produto.                  ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf AllTrim(mv_par06) == \"B1_DESC\"\r\n\tdbSelectArea(\"SB1\")\r\n\tdbSetOrder(1)\r\n\tdbSeek( xFilial(\"SB1\")+SC7->C7_PRODUTO )\r\n\tcDescri := Alltrim(SB1->B1_DESC)\r\n\tdbSelectArea(\"SC7\")\r\nEndIf\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Impressao da descricao cientifica do Produto.                ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf AllTrim(mv_par06) == \"B5_CEME\"\r\n\tdbSelectArea(\"SB5\")\r\n\tdbSetOrder(1)\r\n\tIf dbSeek( xFilial(\"SB5\")+SC7->C7_PRODUTO )\r\n\t\tcDescri := Alltrim(B5_CEME)\r\n\tEndIf\r\n\tdbSelectArea(\"SC7\")\r\nEndIf\r\n\r\ndbSelectArea(\"SC7\")\r\nIf AllTrim(mv_par06) == \"C7_DESCRI\"\r\n\tcDescri := Alltrim(SC7->C7_DESCRI)\r\nEndIf\r\n\r\nIf Empty(cDescri)\r\n\tdbSelectArea(\"SB1\")\r\n\tdbSetOrder(1)\r\n\tMsSeek( xFilial(\"SB1\")+SC7->C7_PRODUTO )\r\n\tcDescri := Alltrim(SB1->B1_DESC)\r\n\tdbSelectArea(\"SC7\")\r\nEndIf\r\n\r\ndbSelectArea(\"SA5\")\r\ndbSetOrder(1)\r\nIf dbSeek(xFilial(\"SA5\")+SC7->C7_FORNECE+SC7->C7_LOJA+SC7->C7_PRODUTO).And. !Empty(SA5->A5_CODPRF)\r\n\tcDescri := cDescri + \" (\"+Alltrim(A5_CODPRF)+\")\"\r\nEndIf\r\n\r\ndbSelectArea(\"SC7\")\r\naColuna[1] :=  49\r\naColuna[2] :=  52\r\naColuna[3] :=  65\r\naColuna[4] :=  80\r\naColuna[5] :=  86\r\naColuna[6] := 103\r\naColuna[7] := 114\r\nacoluna[8] := 142 - nDifColCC\r\n\r\nIf Len(cDescri) > Len(SC7->C7_PRODUTO)\r\n\tnLinha:= MLCount(cDescri,nTamDesc)    \r\nElse\r\n\tnLinha:= MLCount(SC7->C7_PRODUTO,nTamProd) \r\nEndIf\r\n\r\n@ li,007 PSAY MemoLine(SC7->C7_PRODUTO,nTamProd,1)\r\n@ li,022 PSAY \"|\"\r\n@ li,023 PSAY MemoLine(cDescri,nTamDesc,1)\r\n\r\nImpCampos()\r\nFor nBegin := 2 To nLinha\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,006 PSAY \"|\"    \r\n\t@ li,007 PSAY MemoLine(SC7->C7_PRODUTO,nTamProd,nBegin)\r\n\t@ li,022 PSAY \"|\"\r\n\t@ li,023 PSAY Memoline(cDescri,nTamDesc,nBegin)\r\n\t@ li,aColuna[1] PSAY \"|\"\r\n\t@ li,acoluna[2] PSAY \"|\"\r\n\t@ li,acoluna[3] PSAY \"|\"\r\n\t@ li,aColuna[4] PSAY \"|\"\r\n\r\n\tIf mv_par08 == 1 .OR. mv_par08 == 3\r\n\t\tIf cPaisLoc == \"BRA\"\r\n\t\t\t@ li,aColuna[5] PSAY \"|\"\r\n\t\tElse\r\n\t\t\t@ li,aColuna[5] PSAY \" \"\r\n\t\tEndIf\r\n\t\t@ li,aColuna[6] PSAY \"|\"\r\n\t\t@ li,114 PSAY \"|\"\r\n\t\t@ li,135 - nDIfColCC PSAY \"|\"\r\n\t\t@ li,aColuna[8] PSAY \"|\"\r\n\tElse\r\n\t\t@ li,097 PSAY \"|\"\r\n\t\t@ li,108 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tEndIf\r\nNext nBegin\r\n\r\nReturn NIL\r\n\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ ImpCampos³ Autor ³ Wagner Xavier         ³ Data ³          ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Imprimir dados Complementares do Produto no Pedido.        ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ ImpCampos(Void)                                            ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function ImpCampos()\r\n\r\nLOCAL aColuna[6]\r\nLocal nTxMoeda := IIF(SC7->C7_TXMOEDA > 0,SC7->C7_TXMOEDA,Nil)\r\ndbSelectArea(\"SC7\")\r\n\r\naColuna[1] :=  49\r\naColuna[2] :=  52\r\naColuna[3] :=  65\r\naColuna[4] :=  80\r\naColuna[5] :=  86\r\naColuna[6] := 103\r\n\r\n@ li,aColuna[1] PSAY \"|\"\r\nIf MV_PAR07 == 2 .And. !Empty(SC7->C7_SEGUM)\r\n\t@ li,PCOL() PSAY SC7->C7_SEGUM Picture PesqPict(\"SC7\",\"C7_UM\")\r\nElse\r\n\t@ li,PCOL() PSAY SC7->C7_UM    Picture PesqPict(\"SC7\",\"C7_UM\")\r\nEndIf\r\n@ li,aColuna[2] PSAY \"|\"\r\nIf MV_PAR07 == 2 .And. !Empty(SC7->C7_QTSEGUM)\r\n\t@ li,PCOL() PSAY SC7->C7_QTSEGUM Picture PesqPictQt(\"C7_QUANT\",13)\r\nElse\r\n\t@ li,PCOL() PSAY SC7->C7_QUANT   Picture PesqPictQt(\"C7_QUANT\",13)\r\nEndIf\r\n@ li,aColuna[3] PSAY \"|\"\r\nIf MV_PAR07 == 2 .And. !Empty(SC7->C7_QTSEGUM)\r\n\t@ li,PCOL()\tPSAY xMoeda(((SC7->C7_PRECO*SC7->C7_QUANT)/SC7->C7_QTSEGUM),SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture PesqPict(\"SC7\",\"C7_PRECO\",14)\r\nElse\r\n\t@ li,PCOL() PSAY xMoeda(SC7->C7_PRECO,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture PesqPict(\"SC7\",\"C7_PRECO\",14)\r\nEndIf\r\n@ li,aColuna[4] PSAY \"|\"\r\n\r\nIf mv_par08 == 1 .OR. mv_par08 == 3\r\n\tIf cPaisLoc == \"BRA\"\r\n\t\t@ li,    PCOL() PSAY SC7->C7_IPI Picture PesqPictQt(\"C7_IPI\",5)\r\n\t\t@ li,    aColuna[5] PSAY \"|\"\r\n\tElse\r\n\t\t@ li,    PCOL() \tPSAY \"  \"\r\n\t\t@ li,aColuna[5]-2 \tPSAY \" \"\r\n\t\t@ li,    PCOL() \tPSAY \" \"\r\n\tEndIf\r\n\t@ li,    PCOL() PSAY xMoeda(SC7->C7_TOTAL,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture PesqPict(\"SC7\",\"C7_TOTAL\",16,MV_PAR12)\r\n\t@ li,aColuna[6] PSAY \"|\"\r\n\t@ li,    PCOL() PSAY SC7->C7_DATPRF Picture PesqPict(\"SC7\",\"C7_DATPRF\")\r\n\t@ li,114 PSAY \"|\"\r\n\t@ li,PCOL() PSAY SC7->C7_CC         Picture PesqPict(\"SC7\",\"C7_CC\",20)\r\n\t@ li,135 - nDifColCC PSAY \"|\"\r\n\t@ li,  PCOL() PSAY SC7->C7_NUMSC\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nElse\r\n\t@ li,  PCOL() PSAY xMoeda(SC7->C7_TOTAL,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture PesqPict(\"SC7\",\"C7_TOTAL\",16,MV_PAR12)\r\n\t@ li,     097 PSAY \"|\"\r\n\t@ li,  PCOL() PSAY SC7->C7_DATPRF   Picture PesqPict(\"SC7\",\"C7_DATPRF\")\r\n\t@ li,     108 PSAY \"|\"\r\n\t// Tenta imprimir OP\r\n\tIf !Empty(SC7->C7_OP)\r\n\t\t@ li,  PCOL() PSAY STR0065\r\n\t\t@ li,  PCOL() PSAY SC7->C7_OP\r\n\t// Caso Op esteja vazia imprime Centro de Custos\r\n\tElseIf !Empty(SC7->C7_CC)\r\n\t\t@ li,  PCOL() PSAY STR0066\r\n\t\t@ li,PCOL() PSAY SC7->C7_CC     Picture PesqPict(\"SC7\",\"C7_CC\",20)\r\n\tEndIf\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nEndIf\r\n\r\nnTotal  :=nTotal+SC7->C7_TOTAL\r\nnTotMerc:=MaFisRet(,\"NF_TOTAL\")\r\nReturn .T.\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ FinalPed ³ Autor ³ Wagner Xavier         ³ Data ³          ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Imprime os dados complementares do Pedido de Compra        ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ FinalPed(Void)                                             ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function FinalPed(nDescProd)\r\n\r\nLocal nk\t\t:= 1,nG\r\nLocal nX\t\t:= 0\r\nLocal nQuebra\t:= 0\r\nLocal nTotDesc\t:= nDescProd\r\nLocal lNewAlc\t:= .F.\r\nLocal lLiber \t:= .F.\r\nLocal lRejeit\t:= .F.\r\nLocal lImpLeg\t:= .T.\r\nLocal lImpLeg2\t:= .F.\r\nLocal lImpLeg3\t:= .F.\r\nLocal cComprador:=\"\"\r\nLOcal cAlter\t:=\"\"\r\nLocal cAprov\t:=\"\"\r\nLocal nTotIpi\t:= MaFisRet(,'NF_VALIPI')\r\nLocal nTotIcms\t:= MaFisRet(,'NF_VALICM')\r\nLocal nTotDesp\t:= MaFisRet(,'NF_DESPESA')\r\nLocal nTotFrete\t:= MaFisRet(,'NF_FRETE')\r\nLocal nTotalNF\t:= MaFisRet(,'NF_TOTAL')\r\nLocal nTotSeguro:= MaFisRet(,'NF_SEGURO')\r\nLocal aValIVA   := MaFisRet(,\"NF_VALIMP\")\r\nLocal nValIVA   :=0\r\nLocal aColuna   := Array(8), nTotLinhas\r\nLocal nTxMoeda  := IIF(SC7->C7_TXMOEDA > 0,SC7->C7_TXMOEDA,Nil)\r\n\r\nIf cPaisLoc <> \"BRA\" .And. !Empty(aValIVA)\r\n\tFor nG:=1 to Len(aValIVA)\r\n\t\tnValIVA+=aValIVA[nG]\r\n\tNext\r\nEndif\r\n\r\ncMensagem:= Formula(C7_MSG)\r\n\r\nIf !Empty(cMensagem)\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,002 PSAY Padc(cMensagem,129)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nEndif\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n\r\naColuna[1] :=  49\r\naColuna[2] :=  52\r\naColuna[3] :=  65\r\naColuna[4] :=  80\r\naColuna[5] :=  86\r\naColuna[6] := 103\r\nacoluna[7] := 114\r\naColuna[8] := 142 - nDifColCC\r\nnTotLinhas :=  39\r\n\r\nWhile li<nTotLinhas\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,006 PSAY \"|\"\r\n\t@ li,022 PSAY \"|\"\r\n\t@ li,022 + nk PSAY \"*\"\r\n\tnk := IIf( nk == 42 , 1 , nk + 1 )\r\n\t@ li,aColuna[1] PSAY \"|\"\r\n\t@ li,aColuna[2] PSAY \"|\"\r\n\t@ li,aColuna[3] PSAY \"|\"\r\n\t@ li,aColuna[4] PSAY \"|\"\r\n\tIf cPaisLoc == \"BRA\"\r\n\t\t@ li,aColuna[5] PSAY \"|\"\r\n\tEndIf\r\n\t@ li,aColuna[6] PSAY \"|\"\r\n\t@ li,114 PSAY \"|\"\r\n\t@ li,135 - nDifColCC PSAY \"|\"\r\n\t@ li,aColuna[8] PSAY \"|\"\r\n\tli++\r\nEndDo\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,015 PSAY STR0007\t\t//\"D E S C O N T O S -->\"\r\n@ li,037 PSAY C7_DESC1 Picture \"999.99\"\r\n@ li,046 PSAY C7_DESC2 Picture \"999.99\"\r\n@ li,055 PSAY C7_DESC3 Picture \"999.99\"\r\n\r\n@ li,068 PSAY xMoeda(nTotDesc,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture PesqPict(\"SC7\",\"C7_VLDESC\",14, MV_PAR12)\r\n\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Posiciona o Arquivo de Empresa SM0.                          ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\ncAlias := Alias()\r\ndbSelectArea(\"SM0\")\r\ndbSetOrder(1)   // forca o indice na ordem certa\r\nnRegistro := Recno()\r\ndbSeek(SUBS(cNumEmp,1,2)+SC7->C7_FILENT)\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Imprime endereco de entrega do SM0 somente se o MV_PAR13 =\" \"³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf Empty(MV_PAR13)\r\n\t//\"Local de Entrega  : \" -- //\"CEP :\"\r\n\t@ li,003 PSAY STR0008 + AllTrim(SM0->M0_ENDENT) + \" - \" + AllTrim(SM0->M0_CIDENT) + \" - \" + Alltrim(SM0->M0_ESTENT) + \" - \" + STR0009 + Trans(Alltrim(SM0->M0_CEPENT),cCepPict)\r\nElse\r\n\t@ li,003 PSAY STR0008 + MV_PAR13\t\t//\"Local de Entrega  : \" imprime o endereco digitado na pergunte\r\nEndif\r\n\r\n@ li,142 - nDifColCC PSAY \"|\"\r\ndbGoto(nRegistro)\r\ndbSelectArea( cAlias )\r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n//\"Local de Cobranca : \"\r\n@ li,003 PSAY STR0010 + Alltrim(SM0->M0_ENDCOB) + \" - \" + Alltrim(SM0->M0_CIDCOB) + \" - \" + Alltrim(SM0->M0_ESTCOB) + \" - \" +\tSTR0009 + Trans(Alltrim(SM0->M0_CEPCOB),cCepPict)\r\n@ li,141 - nDifColCC PSAY \" |\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,141 - nDifColCC PSAY \"|\"\r\n\r\ndbSelectArea(\"SE4\")\r\ndbSetOrder(1)\r\ndbSeek(xFilial(\"SE4\")+SC7->C7_COND)\r\ndbSelectArea(\"SC7\")\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY STR0011+SubStr(SE4->E4_CODIGO,1,40)\t\t//\"Condicao de Pagto \"\r\n@ li,061 PSAY STR0012\t\t//\"|Data de Emissao|\"\r\n@ li,079 PSAY STR0013\t\t//\"Total das Mercadorias : \" \r\n@ li,108 PSAY xMoeda(nTotal,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotal,14,MsDecimais(MV_PAR12))\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY SubStr(SE4->E4_DESCRI,1,34)\r\n@ li,061 PSAY \"|\"\r\n@ li,066 PSAY SC7->C7_EMISSAO\r\n@ li,077 PSAY \"|\"\r\nIf cPaisLoc<>\"BRA\"\r\n\t@ li,079 PSAY OemtoAnsi(STR0063)\t//\"Total de los Impuestos : \"\r\n\t@ li,108 PSAY xMoeda(nValIVA,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nValIVA,14,MsDecimais(MV_PAR12))\r\nElse\r\n\t@ li,079 PSAY STR0064\t\t//\"Total com Impostos : \"\r\n\t@ li,108 PSAY xMoeda(nTotMerc,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotMerc,14,MsDecimais(MV_PAR12))\r\nEndif\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",53)\r\n@ li,055 PSAY Replicate(\"-\",86 - nDifColCC)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\ndbSelectArea(\"SM4\")\r\ndbSetOrder(1)\r\ndbSeek(xFilial(\"SM4\")+SC7->C7_REAJUST)\r\ndbSelectArea(\"SC7\")\r\n\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY STR0014\t\t//\"Reajuste :\"\r\n@ li,014 PSAY SC7->C7_REAJUST Picture PesqPict(\"SC7\",\"C7_REAJUST\",,MV_PAR12)\r\n@ li,018 PSAY SM4->M4_DESCR\r\n\r\nIf cPaisLoc == \"BRA\"\r\n\t@ li,054 PSAY STR0015\t\t//\"| IPI   :\"\r\n\t@ li,064 PSAY xMoeda(nTotIPI,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotIpi,14,MsDecimais(MV_PAR12))\r\n\t@ li,088 PSAY \"| ICMS   : \"\r\n\t@ li,100 PSAY xMoeda(nTotIcms,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotIcms,14,MsDecimais(MV_PAR12))\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nElse\t\r\n\t@ li,054 PSAY \"|\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nEndIf\r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",52)\r\n@ li,054 PSAY (STR0049) //\"| Frete :\"\r\n@ li,064 PSAY xMoeda(nTotFrete,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotFrete,14,MsDecimais(MV_PAR12))\r\n@ li,088 PSAY (STR0058) //\"| Despesas :\"\r\n@ li,100 PSAY xMoeda(nTotDesp,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotDesp,14,MsDecimais(MV_PAR12))\r\n\r\n@ li,142 - nDifColCC PSAY \"|\"\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Inicializar campos de Observacoes.                           ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf Empty(cObs02) .Or. cObs01 == cObs02\r\n\t\t\t\r\n\tcObs02 := \"\"\r\n\tIf Len(cObs01) > 50\r\n\t\tcObs := cObs01\r\n\t\tcObs01 := Substr(cObs,1,50)\r\n\t\tFor nX := 2 To 4\r\n\t\t\tcVar  := \"cObs\"+StrZero(nX,2)\r\n\t\t\t&cVar := Substr(cObs,(50*(nX-1))+1,50)\r\n\t\tNext\r\n\tEndIf\r\nElse\r\n\tcObs01:= Substr(cObs01,1,IIf(Len(cObs01)<50,Len(cObs01),50))\r\n\tcObs02:= Substr(cObs02,1,IIf(Len(cObs02)<50,Len(cObs02),50))\r\n\tcObs03:= Substr(cObs03,1,IIf(Len(cObs03)<50,Len(cObs03),50))\r\n\tcObs04:= Substr(cObs04,1,IIf(Len(cObs04)<50,Len(cObs04),50))\r\nEndIf\r\n\r\ndbSelectArea(\"SC7\")\r\nIf !Empty(SC7->C7_APROV) .Or. (Empty(SC7->C7_APROV) .And. SCR->CR_TIPO == \"IP\")\r\n\tlNewAlc := .T.\r\n\tcComprador := UsrFullName(SC7->C7_USER)\r\n\tIf C7_CONAPRO != \"B\"\r\n\t\tIF C7_CONAPRO == \"R\"\r\n\t\t\tlRejeit\t  := .T.\r\n\t\tElse\r\n\t\t\tlLiber    := .T.\r\n\t\tEndIf\r\n\tEndIf\r\n\tdbSelectArea(\"SCR\")\r\n\tdbSetOrder(1)\r\n\tdbSeek(xFilial(\"SCR\")+\"PC\"+SC7->C7_NUM)\r\n\tWhile !Eof() .And. SCR->CR_FILIAL+Alltrim(SCR->CR_NUM)==xFilial(\"SCR\")+Alltrim(SC7->C7_NUM) .And. SCR->CR_TIPO $ \"PC|AE|IP\"\r\n\t\tcAprov += AllTrim(UsrFullName(SCR->CR_USER))+\" [\"\r\n        Do Case\r\n        \tCase SCR->CR_STATUS==\"02\" //Pendente\r\n        \t\tcAprov += \"BLQ\"\r\n        \tCase SCR->CR_STATUS==\"03\" //Liberado\r\n        \t\tcAprov += \"Ok\"\r\n        \tCase SCR->CR_STATUS==\"04\" //Bloqueado\r\n        \t\tcAprov += \"BLQ\"\r\n\t\t\tCase SCR->CR_STATUS==\"05\" //Nivel Liberado\r\n\t\t\t\tcAprov += \"##\"\r\n\t\t\tCase SCR->CR_STATUS==\"06\" //Rejeitado\r\n\t\t\t\tcAprov += \"REJ\"\r\n\t\t\tOtherWise                 //Aguar.Lib\r\n\t\t\t\tcAprov += \"??\"\r\n\t\tEndCase\r\n\t\tcAprov += \"] - \"\r\n\t\tdbSelectArea(\"SCR\")\r\n\t\tdbSkip()\r\n\tEnddo\r\n\tIf !Empty(SC7->C7_GRUPCOM)\r\n\t\tdbSelectArea(\"SAJ\")\r\n\t\tdbSetOrder(1)\r\n\t\tdbSeek(xFilial(\"SAJ\")+SC7->C7_GRUPCOM)\r\n\t\tWhile !Eof() .And. SAJ->AJ_FILIAL+SAJ->AJ_GRCOM == xFilial(\"SAJ\")+SC7->C7_GRUPCOM\r\n\t\t\tIf SAJ->AJ_USER != SC7->C7_USER\r\n\t\t\t\tIf SAJ->(FieldPos(\"AJ_MSBLQL\") > 0)\r\n\t\t\t\t\tIf SAJ->AJ_MSBLQL == \"1\"\r\n\t\t\t\t\t\tdbSkip()\r\n\t\t\t\t\t\tLOOP\r\n\t\t\t\t\tEndIf \r\n\t\t\t\tEndIf\r\n\t\t\t\tcAlter += AllTrim(UsrFullName(SAJ->AJ_USER))+\"/\"\r\n\t\t\tEndIf\r\n\t\t\tdbSelectArea(\"SAJ\")\r\n\t\t\tdbSkip()\r\n\t\tEndDo\r\n\tEndIf\r\nEndIf\r\n\r\nli++\r\n@ li,001 PSAY STR0016\t\t//\"| Observacoes\"\r\n@ li,054 PSAY STR0017\t\t//\"| Grupo :\"\r\n@ li,088 PSAY STR0059      //\"| SEGURO :\"\r\n@ li,100 PSAY xMoeda(nTotSeguro,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotSeguro,14,MsDecimais(MV_PAR12))\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY cObs01\r\n@ li,054 PSAY \"|\"+Replicate(\"-\",86 - nDifColCC)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY cObs02\r\n@ li,054 PSAY STR0018\t\t//\"| Total Geral : \"\r\n\r\nIf !lNewAlc\r\n\t@ li,094 PSAY xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotalNF,14,MsDecimais(MV_PAR12))\r\nElse\r\n\tIf lLiber\r\n\t\t@ li,094 PSAY xMoeda(nTotalNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotalNF,14,MsDecimais(MV_PAR12))\r\n\tElse\r\n\t\t@ li,080 PSAY (IF(lRejeit,STR0130,STR0051))\r\n\tEndIf\r\nEndIf\r\n\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY cObs03\r\n@ li,054 PSAY \"|\"+Replicate(\"-\",86 - nDifColCC)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n\r\nIf !lNewAlc\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,003 PSAY cObs04\r\n\t@ li,054 PSAY \"|\"\r\n\t@ li,061 PSAY STR0019\t\t//\"|           Liberacao do Pedido\"\r\n\t@ li,102 PSAY STR0020\t\t//\"| Obs. do Frete: \"\r\n\t@ li,119 PSAY Substr(RetTipoFrete(SC7->C7_TPFRETE),3,10)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY \"|\"+Replicate(\"-\",59)\r\n\t@ li,061 PSAY \"|\"\r\n\t@ li,102 PSAY \"|\"\r\n\tIf !Empty(Substr(RetTipoFrete(SC7->C7_TPFRETE),13))\r\n\t\t@ li,104 PSAY Substr(RetTipoFrete(SC7->C7_TPFRETE),13)\r\n\tEndIf\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\r\n\tli++\r\n\tcLiberador := \"\"\r\n\tnPosicao := 0\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,007 PSAY STR0021\t\t//\"Comprador\"\r\n\t@ li,021 PSAY \"|\"\r\n\t@ li,028 PSAY STR0022\t\t//\"Gerencia\"\r\n\t@ li,041 PSAY \"|\"\r\n\t@ li,046 PSAY STR0023\t\t//\"Diretoria\"\r\n\t@ li,061 PSAY \"|     ------------------------------\"\r\n\t@ li,102 PSAY \"|\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,021 PSAY \"|\"\r\n\t@ li,041 PSAY \"|\"\r\n\t@ li,061 PSAY \"|     \" + R110Center(cLiberador) // 30 posicoes\r\n\t@ li,102 PSAY \"|\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,002 PSAY Replicate(\"-\",limite)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY STR0024\t\t//\"|   NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero do nosso Pedido de Compras.\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,002 PSAY Replicate(\"-\",limite)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nElse\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,003 PSAY cObs04\r\n\t@ li,054 PSAY \"|\"\r\n\t@ li,059 PSAY IF(lLiber,STR0050,IF(lRejeit,STR0130,STR0051))\t\t//\"     P E D I D O   L I B E R A D O\"#\"|     P E D I D O   B L O Q U E A D O !!!\"\r\n\t@ li,102 PSAY STR0020\t\t//\"| Obs. do Frete: \"\r\n\t@ li,119 PSAY Substr(RetTipoFrete(SC7->C7_TPFRETE),3,10)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY \"|\"+Replicate(\"-\",99)\r\n\t@ li,102 PSAY \"|\"\r\n\tIf !Empty(Substr(RetTipoFrete(SC7->C7_TPFRETE),13))\r\n\t\t@ li,104 PSAY Substr(RetTipoFrete(SC7->C7_TPFRETE),13)\r\n\tEndIf\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,003 PSAY STR0052\t\t//\"Comprador Responsavel :\"\r\n\t@ li,027 PSAY Substr(cComprador,1,60)\r\n\t@ li,088 PSAY \"|\"\r\n\t@ li,089 PSAY STR0060      //\"BLQ:Bloqueado\"\r\n\t@ li,102 PSAY \"|\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\tnAuxLin := Len(cAlter)\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,003 PSAY STR0053\t\t//\"Compradores Alternativos :\"\r\n\tWhile nAuxLin > 0 .Or. lImpLeg\r\n\t\t@ li,029 PSAY Substr(cAlter,Len(cAlter)-nAuxLin+1,60)\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\tIf lImpLeg\r\n\t\t\t@ li,089 PSAY STR0061   //\"Ok:Liberado\"\r\n\t\t\tlImpLeg := .F.\r\n\t\tEndIf\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\tnAuxLin -= 60\r\n\t\tli++\r\n\tEndDo\r\n\tnAuxLin := Len(cAprov)\r\n\tlImpLeg := .T.\r\n\tWhile nAuxLin > 0\t.Or. lImpLeg\r\n\t\t@ li,001 PSAY \"|\"\r\n\t\tIf lImpLeg  // Imprimir soh a 1a vez\r\n\t\t\t@ li,003 PSAY STR0054\t\t//\"Aprovador(es) :\"\r\n\t\tEndIf\r\n\t\t@ li,018 PSAY Substr(cAprov,Len(cAprov)-nAuxLin+1,70)\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\tIf lImpLeg3   // Imprimir soh a 3a vez\r\n\t\t\t@ li,089 PSAY STR0131 //\"REJ:REJEITADO\"\r\n\t\t\tlImpLeg3 := .F.\r\n\t\tEndIf\r\n\t\tIf lImpLeg2  // Imprimir soh a 2a vez\r\n\t\t\t@ li,089 PSAY STR0067 //\"##:Nivel.Lib\"\r\n\t\t\tlImpLeg2 := .F.\r\n\t\t\tlImpLeg3 := .T.\r\n\t\tEndIf\r\n\t\tIf lImpLeg   // Imprimir soh a 1a vez\r\n\t\t\t@ li,089 PSAY STR0062  //\"??:Aguar.Lib\"\r\n\t\t\tlImpLeg  := .F.\r\n\t\t\tlImpLeg2 := .T.\r\n\t\tEndIf\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\tnAuxLin -=70\r\n\t\tli++\r\n\tEndDo\r\n\tIf lImpLeg2\r\n\t\tlImpLeg2 := .F.\r\n\t\tlImpLeg3 := .T.\r\n\t\t@ li,001 PSAY \"|\"\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\t@ li,089 PSAY STR0067 //\"##:Nivel Lib\"\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\tli++\r\n    EndIf\r\n\tIf lImpLeg3\r\n\t\tlImpLeg3 := .F.\r\n\t\t@ li,001 PSAY \"|\"\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\t@ li,089 PSAY STR0131 //\"REJ:REJEITADO\"\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\tli++\r\n\tEndIf\t\r\n\tIf nAuxLin == 0\r\n\t\tli++\r\n\tEndIf\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,002 PSAY Replicate(\"-\",limite)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY STR0024\t\t//\"|   NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero do nosso Pedido de Compras.\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,002 PSAY Replicate(\"-\",limite)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nEndIf\r\n\r\nReturn .T.\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ FinalAE  ³ Autor ³ Cristina Ogura        ³ Data ³ 05.04.96 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Imprime os dados complementares da Autorizacao de Entrega  ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ FinalAE(Void)                                              ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function FinalAE(nDescProd)\r\nLocal nk := 1\r\nLocal nX := 0\r\nLocal nTotDesc:= nDescProd\r\nLocal nTotNF\t:= MaFisRet(,'NF_TOTAL')\r\nLocal nTxMoeda := IIF(SC7->C7_TXMOEDA > 0,SC7->C7_TXMOEDA,Nil)\r\nLocal cComprador:=\"\"\r\nLOcal cAlter\t:=\"\"\r\nLocal cAprov\t:=\"\"\r\nLocal lImpLeg\t:= .T.\r\nLocal lImpLeg2\t:= .F.\r\nLocal lImpLeg3  := .F.\r\n\r\ncMensagem:= Formula(C7_MSG)                                   \r\n\r\nIf !Empty(cMensagem)\r\n\tli++\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,002 PSAY Padc(cMensagem,129)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\nEndif\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\nWhile li<39\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,006 PSAY \"|\"\r\n\t@ li,022 PSAY \"|\"\r\n\t@ li,022 + nk PSAY \"*\"\r\n\tnk := IIf( nk == 32 , 1 , nk + 1 )\r\n\t@ li,049 PSAY \"|\"\r\n\t@ li,052 PSAY \"|\"\r\n\t@ li,065 PSAY \"|\"\r\n\t@ li,080 PSAY \"|\"\r\n\t@ li,097 PSAY \"|\"\r\n\t@ li,108 PSAY \"|\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\nEndDo\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Posiciona o Arquivo de Empresa SM0.                          ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\ncAlias := Alias()\r\ndbSelectArea(\"SM0\")\r\ndbSetOrder(1)   // forca o indice na ordem certa\r\nnRegistro := Recno()\r\ndbSeek(SUBS(cNumEmp,1,2)+SC7->C7_FILENT)\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Imprime endereco de entrega do SM0 somente se o MV_PAR13 =\" \"³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf Empty(MV_PAR13)\r\n\t//\"Local de Entrega  : \" -- //\"CEP :\"\r\n\t@ li,003 PSAY STR0008 + AllTrim(SM0->M0_ENDENT) + \" - \" + AllTrim(SM0->M0_CIDENT) + \" - \" + Alltrim(SM0->M0_ESTENT) + \" - \" + STR0009 + Trans(Alltrim(SM0->M0_CEPENT),cCepPict)\r\nElse\r\n\t@ li,003 PSAY STR0008 + MV_PAR13\t\t//\"Local de Entrega  : \" imprime o endereco digitado na pergunte\r\nEndif\r\n\r\n@ li,142 - nDifColCC PSAY \" |\"\r\ndbGoto(nRegistro)\r\ndbSelectArea(cAlias)\r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n//\"Local de Cobranca : \"\r\n@ li,003 PSAY STR0010 + Alltrim(SM0->M0_ENDCOB) + \" - \" + Alltrim(SM0->M0_CIDCOB) + \" - \" + Alltrim(SM0->M0_ESTCOB) + \" - \" +\tSTR0009 + Trans(Alltrim(SM0->M0_CEPCOB),cCepPict)\r\n@ li,142 - nDifColCC PSAY \" |\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\n\r\ndbSelectArea(\"SE4\")\r\ndbSetOrder(1)\r\ndbSeek(xFilial(\"SE4\")+SC7->C7_COND)\r\ndbSelectArea(\"SC7\")\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY STR0011+SubStr(SE4->E4_CODIGO,1,15)\t\t//\"Condicao de Pagto \"\r\n@ li,038 PSAY STR0012\t\t// \"|Data de Emissao|\"\r\n@ li,056 PSAY STR0013\t\t// \"Total das Mercadorias : \"\r\n@ li,094 PSAY xMoeda(nTotal,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotal,14,MsDecimais(MV_PAR12))\r\n\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY SubStr(SE4->E4_DESCRI,1,34)\r\n@ li,038 PSAY \"|\"\r\n@ li,043 PSAY SC7->C7_EMISSAO\r\n@ li,054 PSAY \"|\"\r\n@ li,056 PSAY STR0064\t\t// \"Total com Impostos : \"\r\n@ li,094 PSAY xMoeda(nTotMerc,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda) Picture tm(nTotMerc,14,MsDecimais(MV_PAR12))\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",52)\r\n@ li,054 PSAY \"|\"\r\n@ li,055 PSAY Replicate(\"-\",86 - nDifColCC)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\ndbSelectArea(\"SM4\")\r\ndbSeek(xFilial(\"SM4\")+SC7->C7_REAJUST)\r\ndbSelectArea(\"SC7\")\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY STR0014\t\t//\"Reajuste :\"\r\n@ li,014 PSAY SC7->C7_REAJUST Picture PesqPict(\"SC7\",\"C7_REAJUST\",,MV_PAR12)\r\n@ li,018 PSAY SM4->M4_DESCR\r\n@ li,054 PSAY STR0018\t\t//\"| Total Geral : \"\r\n\r\n@ li,094 PSAY xMoeda(nTotNF,SC7->C7_MOEDA,MV_PAR12,SC7->C7_DATPRF,MsDecimais(SC7->C7_MOEDA),nTxMoeda)      Picture tm(nTotNF,14,MsDecimais(MV_PAR12))\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Inicializar campos de Observacoes.                           ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf Empty(cObs02) .Or. cObs01 == cObs02\r\n\t\t\t\r\n\tcObs02 := \"\"\r\n\tIf Len(cObs01) > 50\r\n\t\tcObs \t:= cObs01\r\n\t\tcObs01:= Substr(cObs,1,50)\r\n\t\tFor nX := 2 To 4\r\n\t\t\tcVar  := \"cObs\"+StrZero(nX,2)\r\n\t\t\t&cVar := Substr(cObs,(50*(nX-1))+1,50)\r\n\t\tNext\r\n\tEndIf\r\nElse\r\n\tcObs01:= Substr(cObs01,1,IIf(Len(cObs01)<50,Len(cObs01),50))\r\n\tcObs02:= Substr(cObs02,1,IIf(Len(cObs02)<50,Len(cObs02),50))\r\n\tcObs03:= Substr(cObs03,1,IIf(Len(cObs03)<50,Len(cObs03),50))\r\n\tcObs04:= Substr(cObs04,1,IIf(Len(cObs04)<50,Len(cObs04),50))\r\nEndIf\r\n\r\nli++\r\n@ li,001 PSAY STR0025\t//\"| Observacoes\"\r\n@ li,054 PSAY STR0026\t//\"| Comprador    \"\r\n@ li,070 PSAY STR0027\t//\"| Gerencia     \"\r\n@ li,085 PSAY STR0028\t//\"| Diretoria    \"\r\n@ li,142 - nDifColCC PSAY \"|\"\r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY cObs01\r\n@ li,054 PSAY \"|\"\r\n@ li,070 PSAY \"|\"\r\n@ li,085 PSAY \"|\"\r\n@ li,142 - nDifColCC PSAY \"|\"\r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY cObs02\r\n@ li,054 PSAY \"|\"\r\n@ li,070 PSAY \"|\"\r\n@ li,085 PSAY \"|\"\r\n@ li,142 - nDifColCC PSAY \"|\"\r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY cObs03\r\n@ li,054 PSAY \"|\"\r\n@ li,070 PSAY \"|\"\r\n@ li,085 PSAY \"|\"\r\n@ li,142 - nDifColCC PSAY \"|\"\r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,003 PSAY cObs04\r\n@ li,054 PSAY \"|\"\r\n@ li,070 PSAY \"|\"\r\n@ li,085 PSAY \"|\"\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Lista de Aprovadores   ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\ndbSelectArea(\"SC7\")\r\nlNewAlc := .F.\r\nIf !Empty(C7_APROV)   \r\n\tlNewAlc := .T.\r\n\tcComprador := UsrFullName(SC7->C7_USER)\r\n\tIf C7_CONAPRO != \"B\"\r\n\t\tIF C7_CONAPRO == \"R\"\r\n\t\t\tlRejeit\t  := .T.\r\n\t\tElse\r\n\t\t\tlLiber    := .T.\r\n\t\tEndIf\r\n\tEndIf\r\n\tdbSelectArea(\"SCR\")\r\n\tdbSetOrder(1)\r\n\tdbSeek(xFilial(\"SCR\")+\"AE\"+SC7->C7_NUM)\r\n\tWhile !Eof() .And. SCR->CR_FILIAL+Alltrim(SCR->CR_NUM)==xFilial(\"SCR\")+Alltrim(SC7->C7_NUM) .And. SCR->CR_TIPO == \"AE\"\r\n\t\tcAprov += AllTrim(UsrFullName(SCR->CR_USER))+\" [\"\r\n        Do Case\r\n        \tCase SCR->CR_STATUS==\"03\" //Liberado\r\n        \t\tcAprov += \"Ok\"\r\n        \tCase SCR->CR_STATUS==\"04\" //Bloqueado\r\n        \t\tcAprov += \"BLQ\"\r\n\t\t\tCase SCR->CR_STATUS==\"05\" //Nivel Liberado\r\n\t\t\t\tcAprov += \"##\"\r\n\t\t\tCase SCR->CR_STATUS==\"06\" //Rejeitado\r\n\t\t\t\tcAprov += \"REJ\"\r\n\t\t\t\t\r\n\t\t\tOtherWise                 //Aguar.Lib\r\n\t\t\t\tcAprov += \"??\"\r\n\t\tEndCase\r\n\t\tcAprov += \"] - \"\r\n\t\tdbSelectArea(\"SCR\")\r\n\t\tdbSkip()\r\n\tEnddo\r\n\tIf !Empty(SC7->C7_GRUPCOM)\r\n\t\tdbSelectArea(\"SAJ\")\r\n\t\tdbSetOrder(1)\r\n\t\tdbSeek(xFilial(\"SAJ\")+SC7->C7_GRUPCOM)\r\n\t\tWhile !Eof() .And. SAJ->AJ_FILIAL+SAJ->AJ_GRCOM == xFilial(\"SAJ\")+SC7->C7_GRUPCOM\r\n\t\t\tIf SAJ->AJ_USER != SC7->C7_USER\r\n\t\t\t\tIf SAJ->(FieldPos(\"AJ_MSBLQL\") > 0)\r\n\t\t\t\t\tIf SAJ->AJ_MSBLQL == \"1\"\r\n\t\t\t\t\t\tdbSkip()\r\n\t\t\t\t\t\tLOOP\r\n\t\t\t\t\tEndIf \r\n\t\t\t\tEndIf\r\n\t\t\t\tcAlter += AllTrim(UsrFullName(SAJ->AJ_USER))+\"/\"\r\n\t\t\tEndIf\r\n\t\t\tdbSelectArea(\"SAJ\")\r\n\t\t\tdbSkip()\r\n\t\tEndDo\r\n\tEndIf\r\nEndIf\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Imprime Aprovadores  ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf lNewAlc                   \r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,003 PSAY STR0052\t\t//\"Comprador Responsavel :\"\r\n\t@ li,027 PSAY Substr(cComprador,1,60)\r\n\t@ li,088 PSAY \"|\"\r\n\t@ li,089 PSAY STR0060      //\"BLQ:Bloqueado\"\r\n\t@ li,102 PSAY \"|\"\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\tnAuxLin := Len(cAlter)\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,003 PSAY STR0053\t\t//\"Compradores Alternativos :\"\r\n\tWhile nAuxLin > 0 .Or. lImpLeg\r\n\t\t@ li,029 PSAY Substr(cAlter,Len(cAlter)-nAuxLin+1,60)\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\tIf lImpLeg\r\n\t\t\t@ li,089 PSAY STR0061   //\"Ok:Liberado\"\r\n\t\t\tlImpLeg := .F.\r\n\t\tEndIf\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\tnAuxLin -= 60\r\n\t\tli++\r\n\tEndDo\r\n\t\r\n\tnAuxLin := Len(cAprov)\r\n\tlImpLeg := .T.\r\n\t\r\n\tWhile nAuxLin > 0\t.Or. lImpLeg\r\n\t\t@ li,001 PSAY \"|\"\r\n\t\tIf lImpLeg  // Imprimir soh a 1a vez\r\n\t\t\t@ li,003 PSAY STR0054\t\t//\"Aprovador(es) :\"\r\n\t\tEndIf\r\n\t\t@ li,018 PSAY Substr(cAprov,Len(cAprov)-nAuxLin+1,70)\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\tIf lImpLeg3   // Imprimir soh a 3a vez\r\n\t\t\t@ li,089 PSAY \"REJ:REJEITADO\" //\"REJ:REJEITADO\"\r\n\t\t\tlImpLeg3 := .F.\r\n\t\tEndIf\r\n\t\tIf lImpLeg2  // Imprimir soh a 2a vez\r\n\t\t\t@ li,089 PSAY STR0067 //\"##:Nivel.Lib\"\r\n\t\t\tlImpLeg2 := .F.\r\n\t\t\tlImpLeg3 := .T.\r\n\t\tEndIf\r\n\t\tIf lImpLeg   // Imprimir soh a 1a vez\r\n\t\t\t@ li,089 PSAY STR0062  //\"??:Aguar.Lib\"\r\n\t\t\tlImpLeg  := .F.\r\n\t\t\tlImpLeg2 := .T.\r\n\t\tEndIf\r\n\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\r\n\t\tnAuxLin -=70\r\n\t\tli++\r\n\tEndDo\r\n\tIf lImpLeg2\r\n\t\tlImpLeg2 := .F.\r\n\t\tlImpLeg3 := .T.\r\n\t\t@ li,001 PSAY \"|\"\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\t@ li,089 PSAY STR0067 //\"##:Nivel Lib\"\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\tli++\r\n    EndIf\r\n\tIf lImpLeg3\r\n\t\tlImpLeg3 := .F.\r\n\t\t@ li,001 PSAY \"|\"\r\n\t\t@ li,088 PSAY \"|\"\r\n\t\t@ li,089 PSAY \"REJ:REJEITADO\" //\"REJ:REJEITADO\"\r\n\t\t@ li,102 PSAY \"|\"\r\n\t\t@ li,142 - nDifColCC PSAY \"|\"\r\n\t\tli++\t\t\r\n\tEndIf\r\n\tIf nAuxLin == 0\r\n\t\tli++\r\n\tEndIf\r\n\r\n\t@ li,001 PSAY \"|\"\r\n\t@ li,002 PSAY Replicate(\"-\",limite)\r\n\t@ li,142 - nDifColCC PSAY \"|\"\r\n\tli++\r\n\t\r\nEndIf\r\n\r\n@ li,001 PSAY STR0029\t//\"|   NOTA: So aceitaremos a mercadoria se na sua Nota Fiscal constar o numero da Autorizacao de Entrega.\"\r\n@ li,142 - nDifColCC PSAY \"|\"   \r\n\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)     \r\n@ li,142 - nDifColCC PSAY \"|\"\r\n\r\nReturn .T.\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ ImpRodape³ Autor ³ Wagner Xavier         ³ Data ³          ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Imprime o rodape do formulario e salta para a proxima folha³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ ImpRodape(Void)   \t\t\t         \t\t\t\t\t  ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ \t\t\t\t\t                     \t\t\t\t      ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function ImpRodape()\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,070 PSAY STR0030\t\t//\"Continua ...\"\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli++\r\n@ li,001 PSAY \"|\"\r\n@ li,002 PSAY Replicate(\"-\",limite)\r\n@ li,142 - nDifColCC PSAY \"|\"\r\nli:=0\r\nReturn .T.\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ ImpCabec ³ Autor ³ Wagner Xavier         ³ Data ³          ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Imprime o Cabecalho do Pedido de Compra                    ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ ImpCabec(Void)                                             ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function ImpCabec(ncw)\r\nLocal nOrden, cCGC\r\nLOCAL cMoeda\r\nLocal cCGCFOR := \"\"\r\n\r\ncMoeda := Iif(mv_par12<10,Str(mv_par12,1),Str(mv_par12,2))\r\n\r\n@ 01,001 PSAY \"|\"\r\n@ 01,002 PSAY Replicate(\"-\",limite)\r\n@ 01,142 - nDifColCC PSAY \"|\"\r\n@ 02,001 PSAY \"|\"\r\n@ 02,029 PSAY IIf(nOrdem>1,(STR0033),\" \")\t\t//\" - continuacao\"\r\n\r\nIf mv_par08 == 1 .OR. mv_par08 == 3\r\n\t@ 02,045 PSAY (STR0031)+\" - \"+GetMV(\"MV_MOEDA\"+cMoeda) \t//\"| P E D I D O  D E  C O M P R A S\"\r\nElse\r\n\t@ 02,045 PSAY (STR0032)+\" - \"+GetMV(\"MV_MOEDA\"+cMoeda)  //\"| A U T. D E  E N T R E G A     \"\r\nEndIf\r\n\r\nIf ( Mv_PAR08==2 )\r\n\t@ 02,090 PSAY \"|\"\r\n\t@ 02,093 PSAY SC7->C7_NUMSC + \"/\" + SC7->C7_NUM  //    Picture PesqPict(\"SC7\",\"c7_num\")\t\r\nElse\r\n\t@ 02,096 PSAY \"|\"\r\n\t@ 02,101 PSAY SC7->C7_NUM      Picture PesqPict(\"SC7\",\"C7_NUM\")\r\nEndIf\r\n\r\n@ 02,107 PSAY \"/\"+Str(nOrdem,1)\r\n@ 02,112 PSAY IIf(SC7->C7_QTDREEM>0,Str(SC7->C7_QTDREEM+1,2)+STR0034+Str(ncw,2)+STR0035,\" \")\t\t//\"a.Emissao \"###\"a.VIA\"\r\n@ 02,142 - nDifColCC PSAY \"|\"\r\n@ 03,001 PSAY \"|\"\r\n@ 03,003 PSAY Substr(SM0->M0_NOMECOM,1,42)\r\n@ 03,045 PSAY \"|\"+Replicate(\"-\",95 - nDifColCC)\r\n@ 03,142 - nDifColCC PSAY \"|\"\r\n@ 04,001 PSAY \"|\"\r\n@ 04,003 PSAY Substr(SM0->M0_ENDENT,1,42)\r\ndbSelectArea(\"SA2\")\r\ndbSetOrder(1)\r\ndbSeek(xFilial(\"SA2\")+SC7->C7_FORNECE+SC7->C7_LOJA)\r\n@ 04,045 PSAY \"|\"\r\nIf ( cPaisLoc$\"ARG|POR|EUA\" )\r\n\t@ 04,047 PSAY Substr(SA2->A2_NOME,1,35)+\"-\"+SA2->A2_COD+\"-\"+SA2->A2_LOJA\t\r\nElse\r\n\t@ 04,047 PSAY Substr(SA2->A2_NOME,1,35)+\"-\"+SA2->A2_COD+\"-\"+SA2->A2_LOJA+(STR0036)+\" \" + SA2->A2_INSCR\t\t//\" I.E.: \"\t\r\nEndIf\r\n@ 04,142 - nDifColCC PSAY \"|\"\r\n@ 05,001 PSAY \"|\"\r\n@ 05,003 PSAY (STR0009)+Trans(SM0->M0_CEPENT,cCepPict)+\" - \"+Trim(SM0->M0_CIDENT)+\" - \"+SM0->M0_ESTENT\t\t//\"CEP :\"\r\n@ 05,045 PSAY \"|\"\r\n@ 05,047 PSAY SubStr(SA2->A2_END,1,42)   Picture PesqPict(\"SA2\",\"A2_END\")\r\n@ 05,089 PSAY \"-  \"+SubStr(Trim(SA2->A2_BAIRRO),1,(53-nDifColCC))\tPicture \"@!\"\r\n@ 05,142 - nDifColCC PSAY \"|\"\r\n@ 06,001 PSAY \"|\"\r\n@ 06,003 PSAY STR0037+SM0->M0_TEL\t\t//\"TEL: \"\r\n@ 06,023 PSAY STR0038+SM0->M0_FAX\t\t//\"FAX: \"\r\n@ 06,045 PSAY \"|\"\r\n@ 06,047 PSAY Trim(SA2->A2_MUN)  Picture \"@!\"\r\n@ 06,069 PSAY SA2->A2_EST    \t\tPicture PesqPict(\"SA2\",\"A2_EST\")\r\n@ 06,074 PSAY STR0009\t//\"CEP :\"\r\n@ 06,081 PSAY SA2->A2_CEP    \t\tPicture PesqPict(\"SA2\",\"A2_CEP\")\r\n\r\ndbSelectArea(\"SX3\")\r\nnOrden = IndexOrd()\r\ndbSetOrder(2)\r\ndbSeek(\"A2_CGC\")\r\ncCGC := Alltrim(X3TITULO())\r\n@ 06,093 PSAY cCGC+\":\" //\"CGC: \"\r\ndbSetOrder(nOrden)\r\n\r\ndbSelectArea(\"SA2\")\r\nIf cPaisLoc == \"BRA\"\r\n\tcCGCFOR\t:= Transform(SA2->A2_CGC,Iif(SA2->A2_TIPO == 'F',Substr(PICPES(SA2->A2_TIPO),1,17),Substr(PICPES(SA2->A2_TIPO),1,21))) \r\nElse  \r\n\tcCGCFOR\t:= SA2->A2_CGC\r\nEndIf  \r\n@ 06,103 PSAY cCGCFOR \r\n@ 06,142 - nDifColCC PSAY \"|\"\r\n@ 07,001 PSAY \"|\"\r\n@ 07,002 PSAY (cCGC) + \" \"+ Transform(SM0->M0_CGC,cCgcPict)\t\t//\"CGC: \"\r\nIf cPaisLoc == \"BRA\"\r\n\t@ 07,029 PSAY (STR0041)+ InscrEst()\t\t//\"IE:\"\r\nEndIf\r\n@ 07,045 PSAY \"|\"\r\n@ 07,047 PSAY SC7->C7_CONTATO Picture PesqPict(\"SC7\",\"C7_CONTATO\")\r\n@ 07,069 PSAY STR0042\t//\"FONE: \"\r\n@ 07,075 PSAY \"(\"+Substr(SA2->A2_DDD,1,3)+\") \"+Substr(SA2->A2_TEL,1,15)\r\n@ 07,100 PSAY (STR0038)\t//\"FAX: \"\r\n@ 07,106 PSAY \"(\"+Substr(SA2->A2_DDD,1,3)+\") \"+SubStr(SA2->A2_FAX,1,15)\r\n@ 07,142 - nDifColCC PSAY \"|\"\r\n@ 08,001 PSAY \"|\"\r\n@ 08,002 PSAY Replicate(\"-\",limite)\r\n@ 08,142 - nDifColCC PSAY \"|\"\r\n\r\nIf mv_par08 == 1 .OR. mv_par08 == 3\r\n\t@ 09,001 PSAY \"|\"\r\n\t@ 09,002 PSAY STR0043\t//\"Itm|\"\r\n\t@ 09,009 PSAY STR0044\t//\"Codigo      \"\r\n\t@ 09,022 PSAY STR0045\t//\"|Descricao do Material\"\r\n\t@ 09,049 PSAY STR0046\t//\"|UM|  Quant.\"\r\n\tIf cPaisLoc <> \"BRA\"\r\n\t\t@ 09,065 PSAY IIF(nDifColcc == 0,STR0056,STR0057)\t//\"|Valor Unitario|      Valor Total   |Entrega   |  C.C.   | S.C. |\"\r\n\tElse\r\n\t\t@ 09,065 PSAY IIF(nDifColcc == 0,STR0047,STR0055)\t//\"|Valor Unitario|IPI% |  Valor Total   | Entrega  |  C.C.   | S.C. |\"\r\n\tEndIf\r\n\t@ 10,001 PSAY \"|\"\r\n\t@ 10,002 PSAY Replicate(\"-\",limite)\r\n\t@ 10,142 - nDifColCC PSAY \"|\"\r\nElse\r\n\t@ 09,001 PSAY \"|\"\r\n\t@ 09,002 PSAY STR0043\t//\"Itm|\"\r\n\t@ 09,009 PSAY STR0044\t//\"Codigo      \"\r\n\t@ 09,022 PSAY STR0045\t//\"|Descricao do Material\"\r\n\t@ 09,049 PSAY STR0046\t//\"|UM|  Quant.\"\r\n\t@ 09,065 PSAY STR0048\t//\"|Valor Unitario|  Valor Total   |Entrega | Numero da OP  \"\r\n\t@ 09,142 - nDifColCC PSAY \"|\"\r\n\t@ 10,001 PSAY \"|\"\r\n\t@ 10,002 PSAY Replicate(\"-\",limite)\r\n\t@ 10,142 - nDifColCC PSAY \"|\"\r\nEndIf\r\ndbSelectArea(\"SC7\")\r\nli := 10\r\nReturn .T.\r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³R110Center³ Autor ³ Jose Lucas            ³ Data ³          ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Centralizar o Nome do Liberador do Pedido.                 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ ExpC1 := R110CenteR(ExpC2)                                 ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ ExpC1 := Nome do Liberador                                 ³±±\r\n±±³Parametros³ ExpC2 := Nome do Liberador Centralizado                    ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\nStatic Function R110Center(cLiberador)\r\nReturn( Space((30-Len(AllTrim(cLiberador)))/2)+AllTrim(cLiberador) )\r\n                                                         \r\n/*/\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Fun‡…o    ³ChkPergUs ³ Autor ³ Nereu Humberto Junior ³ Data ³21/09/07  ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descri‡…o ³ Funcao para buscar as perguntas que o usuario nao pode     ³±±\r\n±±³          ³ alterar para impressao de relatorios direto do browse      ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ ChkPergUs(ExpC1,ExpC2,ExpC3)                               ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ ExpC1 := Id do usuario                                     ³±±\r\n±±³          ³ ExpC2 := Grupo de perguntas                                ³±±\r\n±±³          ³ ExpC2 := Numero da sequencia da pergunta                   ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MatR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n/*/\r\n\r\n\r\n/*\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Funcao    ³R110FIniPC³ Autor ³ Edson Maricate        ³ Data ³20/05/2000³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descricao ³ Inicializa as funcoes Fiscais com o Pedido de Compras      ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Sintaxe   ³ R110FIniPC(ExpC1,ExpC2)                                    ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Parametros³ ExpC1 := Numero do Pedido                                  ³±±\r\n±±³          ³ ExpC2 := Item do Pedido                                    ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MATR110,MATR120,Fluxo de Caixa                             ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n*/\r\nStatic Function R110FIniPC(cPedido,cItem,cSequen,cFiltro)\r\n\r\nLocal aArea\t\t:= GetArea()\r\nLocal aAreaSC7\t:= SC7->(GetArea())\r\nLocal cValid\t:= \"\"\r\nLocal nPosRef\t:= 0\r\nLocal nItem\t\t:= 0\r\nLocal cItemDe\t:= IIf(cItem==Nil,'',cItem)\r\nLocal cItemAte\t:= IIf(cItem==Nil,Repl('Z',Len(SC7->C7_ITEM)),cItem)\r\nLocal cRefCols\t:= ''\r\nLocal aStru\t\t:= FWFormStruct(3,\"SC7\")[1]\r\nLocal nX\r\n\r\nDEFAULT cSequen\t:= \"\"\r\nDEFAULT cFiltro\t:= \"\"\r\n\r\ndbSelectArea(\"SC7\")\r\ndbSetOrder(1)\r\nIf dbSeek(xFilial(\"SC7\")+cPedido+cItemDe+Alltrim(cSequen))\r\n\tMaFisEnd()\r\n\tMaFisIni(SC7->C7_FORNECE,SC7->C7_LOJA,\"F\",\"N\",\"R\",{})\r\n\tWhile !Eof() .AND. SC7->C7_FILIAL+SC7->C7_NUM == xFilial(\"SC7\")+cPedido .AND. ;\r\n\t\t\tSC7->C7_ITEM <= cItemAte .AND. (Empty(cSequen) .OR. cSequen == SC7->C7_SEQUEN)\r\n\r\n\t\t// Nao processar os Impostos se o item possuir residuo eliminado  \r\n\t\tIf &cFiltro\r\n\t\t\tdbSelectArea('SC7')\r\n\t\t\tdbSkip()\r\n\t\t\tLoop\r\n\t\tEndIf\r\n            \r\n\t\t// Inicia a Carga do item nas funcoes MATXFIS  \r\n\t\tnItem++\r\n\t\tMaFisIniLoad(nItem)\r\n\r\n\t\tFor nX := 1 To Len(aStru)\r\n\t\t\tcValid\t:= StrTran(UPPER(GetCbSource(aStru[nX][7])),\" \",\"\")\r\n\t\t\tcValid\t:= StrTran(cValid,\"'\",'\"')\r\n\t\t\tIf \"MAFISREF\" $ cValid .And. !(aStru[nX][14]) //campos que não são virtuais\r\n\t\t\t\tnPosRef  := AT('MAFISREF(\"',cValid) + 10\r\n\t\t\t\tcRefCols := Substr(cValid,nPosRef,AT('\",\"MT120\",',cValid)-nPosRef )\r\n\t\t\t\t// Carrega os valores direto do SC7.           \r\n\t\t\t\tMaFisLoad(cRefCols,&(\"SC7->\"+ aStru[nX][3]),nItem)\r\n\t\t\tEndIf\r\n\t\tNext nX\t\t\r\n\r\n\t\tMaFisEndLoad(nItem,2)\r\n\t\tdbSelectArea('SC7')\r\n\t\tdbSkip()\r\n\tEnd\r\nEndIf\r\n\r\nRestArea(aAreaSC7)\r\nRestArea(aArea)\r\n\r\nReturn .T.\r\n\r\n/*\r\nÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜÜ\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\n±±ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿±±\r\n±±³Funcao    ³R110Logo  ³ Autor ³ Materiais             ³ Data ³07/01/2015³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³Descricao ³ Retorna string com o nome do arquivo bitmap de logotipo    ³±±\r\n±±ÃÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´±±\r\n±±³ Uso      ³ MATR110                                                    ³±±\r\n±±ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ±±\r\n±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±±\r\nßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß\r\n*/\r\n\r\nStatic Function R110Logo()\r\n\r\nLocal cBitmap := \"LGRL\"+SM0->M0_CODIGO+SM0->M0_CODFIL+\".BMP\" // Empresa+Filial\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Se nao encontrar o arquivo com o codigo do grupo de empresas ³\r\n//³ completo, retira os espacos em branco do codigo da empresa   ³\r\n//³ para nova tentativa.                                         ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf !File( cBitmap )\r\n\tcBitmap := \"LGRL\" + AllTrim(SM0->M0_CODIGO) + SM0->M0_CODFIL+\".BMP\" // Empresa+Filial\r\nEndIf\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Se nao encontrar o arquivo com o codigo da filial completo,  ³\r\n//³ retira os espacos em branco do codigo da filial para nova    ³\r\n//³ tentativa.                                                   ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf !File( cBitmap )\r\n\tcBitmap := \"LGRL\"+SM0->M0_CODIGO + AllTrim(SM0->M0_CODFIL)+\".BMP\" // Empresa+Filial\r\nEndIf\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Se ainda nao encontrar, retira os espacos em branco do codigo³\r\n//³ da empresa e da filial simultaneamente para nova tentativa.  ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf !File( cBitmap )\r\n\tcBitmap := \"LGRL\" + AllTrim(SM0->M0_CODIGO) + AllTrim(SM0->M0_CODFIL)+\".BMP\" // Empresa+Filial\r\nEndIf\r\n\r\n//ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿\r\n//³ Se nao encontrar o arquivo por filial, usa o logo padrao     ³\r\n//ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ\r\nIf !File( cBitmap )\r\n\tcBitmap := \"LGRL\"+SM0->M0_CODIGO+\".BMP\" // Empresa\r\nEndIf\r\n\r\nReturn cBitmap\r\n\r\n"}}}
Content-Length: 169
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/ITMmatr110.prx"}}}
Content-Length: 4050
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120APV.prw","languageId":"advpl","version":1,"text":"\r\n#Include \"Protheus.ch\"\r\n#Include \"RwMake.ch\"\r\n#Include \"TbiConn.ch\"\r\n#INCLUDE \"TOTVS.CH\"\r\n#INCLUDE \"TOPCONN.CH\"\r\n\r\n//Pazzini\r\nUser Function MT120APV()\r\n/***************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal ExpC1 := Nil\r\nLocal ExpC2 := Nil\r\nLocal cGrp  := \"\" //Grupo de aprovação\r\n\r\nLocal aPergs     := {}\r\nLocal aRetorn    := {}\r\nLocal cLoad      := \"00001\"\r\nLocal lCanSave   := .T.\r\nLocal lUserSave  := .T.\r\nLocal cTitulo    := \"GRUPO DE APROVADORES\"\r\nLocal bOk        := {|| .T.}\r\nLocal aButtons   := {}\r\nLocal lCentered  := .T.\r\nLocal nPosx\r\nLocal nPosy\r\nLocal cMSG       := \"\"\r\n//local aCombo   := {\"000001\",\"000002\",\"000003\",\"000004\",\"000005\",\"000006\",\"000007\",\"000008\",\"000009\",\"000010\",\"000011\",\"000012\",\"000013\",\"000014\",\"000015\"}\r\n\r\n\r\n\r\n/* Variável Privada */\r\nPrivate cNewGRP    := Space(06)\r\n//Private lIncluir \t:= .F.\r\n//Private lAlterar \t:= .F.\r\n\r\n/* Abro a empresa TESTE, caso faça uso via debug\r\nRemover para utilizar dentro do Protheus*/\r\n // RpcSetEnv('99','01')\r\nIF !IsBlind()  \r\n\r\n    If  !Type(\"ALTERA\") == \"U\"\r\n        ALTERA := .F.\r\n        INCLUIR := .T.\r\n    Endif\r\n\r\n    If !Type(\"INCLUIR\") == \"U\"\r\n        ALTERA := .T.\r\n        INCLUIR := .F.\r\n    Endif\r\n\r\n    If (ALTERA .OR. INCLUIR ) == .T.\r\n        If Type(\"PARAMIXB\") == \"U\"\r\n        \r\n            IF EMPTY(cMSG)\r\n                cMSG := AllTrim(cMSG) + \"ALTERAR GRUPO DE APROVADORES ! \" + chr(13)+chr(10)\r\n                If !IsBlind()  \r\n                    If MsgYesNo(cMSG + chr(13)+chr(10)+ \"Deseja continuar?\" )\r\n                        lRet := .t.\r\n                    Else\r\n                        lRet := .F.\r\n                        IF lRet == .F. .and. !IsBlind()  \r\n                            Return(lRet)\r\n                        EndIf \r\n                    EndIf\r\n                EndIf\r\n\r\n            EndIf\r\n                /* Adiciono a pergunta do Parambox */\r\n              //  aAdd(aPergs, {1, \"NOVO GRUPO : \" , cNewGRP  , aCombo[], \".T.\", \"\", \".T.\", 80, .F.})\r\n\r\n                /* Se a pergunta for confirmada */\r\n                //aAdd( aPergs ,{9,\"Abaixo escolha uma opção\",200, 40,.T.})                 \r\n                //aAdd( aPergs ,{2,\"Tipo 2 - Escolha:\",01,aCombo,50,\"\",.T.})\r\n\r\n\r\n               // aPergs := {}\r\n                cPergs := \"MT120APV01\"\r\n\r\n                Aadd(aPergs,{cPergs,\"Grupo de aprovadores?\",\"C\",06,00,\"G\",\"\",\"SAL\",\"\",\"\",\"\",\"\",\"\",\"\"})\r\n\r\n                U_Testasx1(cPergs,aPergs,.F.) \r\n                \r\n                If ! Pergunte(cPergs,.T.)\r\n                    Return(cGrp)\r\n                EndIf\r\n\r\n                If Empty(mv_par01)\r\n                    Return(cGrp)\r\n                EndIf\r\n                \r\n                cGrp := mv_par01\r\n                MSGALERT( \"Grupo alterado com sucesso ! \")\r\n        Else\r\n                ExpC1 := PARAMIXB[1]\r\n                ExpC2 := PARAMIXB[2]\r\n\r\n                //EXEMPLO 2 (Manipulando o saldo do pedido, na alteração do pedido):\r\n                //Manipulando o saldo do pedido pelo usuário, conf. necessidade, atualizando a variável n120TotLib\r\n                /*If ALTERA\r\n                    MSGALERT( \"ALTERAR no ponto MT120APV\")\r\n                Endif\r\n                \r\n                If INCLUIR\r\n                    MSGALERT( \"INCLUIR no ponto MT120APV\")\r\n                Endif\r\n                */  \r\n        EndIf\r\n\r\n    EndIf \r\n       // MSGALERT( \"Saindo do ponto de entrada MT120APV\")\r\nENDIF\r\n\r\nReturn cGrp\r\n\r\n"}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120APV.prw"}}}
Content-Length: 2591
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120FIM.prw","languageId":"advpl","version":1,"text":"#INCLUDE \"TOTVS.CH\"\r\n#Include 'FWMVCDef.ch'\r\n#INCLUDE \"PROTHEUS.CH\"\r\n#INCLUDE \"TOPCONN.CH\"\r\n#INCLUDE \"TBICONN.CH\"\r\n#INCLUDE \"RPTDEF.CH\"\r\n\r\n/*/{Protheus.doc} MT120FIM\r\n@description Ponto de entrada no final da gravacao do pedido\r\n@author..: PAZZINI\r\n@since...: 2023-04-19\r\n@version.: 1.0\r\n@type....: User function\r\n/*/\r\nUser Function MT120FIM()\r\n/************************************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal aArea := GetArea()\r\nLocal cA120Num := ParamIxb[2]\r\nLocal cSC7Filial := xFilial(\"SC7\")\r\nLocal cQuery := \"\"\r\n\r\n// Att C7_XNOMESC = C1_SOLICIT \r\ncQuery := \" UPDATE \" + RetSqlName(\"SC7\")\r\ncQuery += \"   SET C7_XNOMESC = C1_SOLICIT\r\ncQuery += \"   \tFROM \t\t\t\t\t\r\ncQuery += \"   \t\t\"+RetSqlName(\"SC7\")+\" SC7 WITH(NOLOCK) INNER JOIN \"+RetSqlName(\"SC1\")+\"  SC1 WITH(NOLOCK)  \t\t\t\t\t\t\r\ncQuery += \"   \t\t             ON(SC1.C1_FILIAL+SC1.C1_PEDIDO+C1_ITEMPED) = (C7_FILIAL+C7_NUM+C7_ITEMSC)    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\ncQuery += \"   \tWHERE SC7.D_E_L_E_T_ = '' \r\ncQuery += \"   \t  AND   SC1.D_E_L_E_T_ = ''\r\ncQuery += \"   \t  AND C7_NUM    = '\"+cA120Num+\"' \r\ncQuery += \"   \t  AND C7_FILIAL = '\"+cSC7Filial+\"'\r\n\r\nTcSQLExec(cQuery)\r\n\r\n// Att C7_NOMEPC = C7_OBS\r\ncQuery := \" UPDATE \" + RetSqlName(\"SC7\")\r\ncQuery += \"   SET C7_XMOTPC = C7_OBS\r\ncQuery += \"   \tFROM \t\t\t\t\t\r\ncQuery += \"   \t\t\"+RetSqlName(\"SC7\")+\" SC7 WITH(NOLOCK)   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\ncQuery += \"   \tWHERE SC7.D_E_L_E_T_ = '' \r\ncQuery += \"   \t  AND C7_NUM    = '\"+cA120Num+\"' \r\ncQuery += \"   \t  AND C7_FILIAL = '\"+cSC7Filial+\"'\r\n\r\nTcSQLExec(cQuery)\r\n\r\n// Att C7_NOMEPC = USR_NOME\r\ncQuery := \" UPDATE \" + RetSqlName(\"SC7\")\r\ncQuery += \"   SET C7_NOMEPC = SYS_USR.USR_NOME\r\ncQuery += \"   \tFROM \t\t\t\t\t\r\ncQuery += \"   \t\t\"+RetSqlName(\"SC7\")+\" SC7 WITH(NOLOCK) LEFT JOIN SYS_USR WITH(NOLOCK)  \t\t\t\t\t\t\r\ncQuery += \"   \t\t             ON(C7_USER) =(SYS_USR.USR_ID)   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\ncQuery += \"   \tWHERE SC7.D_E_L_E_T_ = '' \r\ncQuery += \"   \t  AND C7_NUM    = '\"+cA120Num+\"' \r\ncQuery += \"   \t  AND C7_FILIAL = '\"+cSC7Filial+\"'\r\n\r\nTcSQLExec(cQuery)\r\n\t\t\t\t\r\nRestArea(aArea)\r\n\r\nReturn()\r\n\r\n"}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120FIM.prw"}}}
Content-Length: 723
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT094CPC%20.prw","languageId":"advpl","version":1,"text":"#Include 'Protheus.ch'\r\n\r\n/*/{Protheus.doc} MT094CPC.prw\r\n@description \r\n@author PAZZINI\r\n@since 07/03/16\r\n@version 1.0\r\n@type User function\r\n/*/\r\nUser Function MT094CPC()\r\n/************************************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal cCampos := \"\"\r\n\r\ncCampos := \"C7_NOMEPC|C7_CC|C7_OBS|C7_OBSM|C7_QUJE|C7_DATPRF|C7_USER|C7_NUMSC|C7_XNOMESC|C7_OBS|C7_OBSM|C7_XMOTPC\" \r\n\r\nReturn (cCampos)\r\n"}}}
Content-Length: 170
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT094CPC%20.prw"}}}
Content-Length: 1069
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT103TOK.PRW","languageId":"advpl","version":1,"text":"#INCLUDE \"Protheus.ch\"\r\n#INCLUDE \"RwMake.ch\"\r\n#INCLUDE \"topconn.ch\" \r\n#INCLUDE \"Colors.ch\" \r\n#INCLUDE \"JPEG.CH\"\r\n\r\n/*\r\nPrograma        : Programa MT103TOK.prw\r\nObjetivo        : P.Entrada verificar valor digitado no campo numero dentro do documento de entrada. \r\nAutor           : Por Giliard Pazzini teste \t\r\nData/Hora       : 20/10/2022 16:36\r\nObs.            : \r\n*/\r\n\r\nUser Function MT103TOK()\r\n/*****************************************************************************************\r\n* Programa principal \r\n*\r\n***/  \r\nLocal lRet\t\t:= Paramixb[1]\r\n\r\nIf l103Inclui\r\n\tIf Len(Alltrim(cNFiscal)) <> 9 .or. cNFiscal == \"000000000\"\r\n\t\tMsgBox(\"Problema com a numeração do documento fiscal. Favor verificar!!!\",\"MT103TOK\",\"STOP\")\r\n\t\tlRet := .F.\r\n\tEndIf\r\nEndIf\r\n\r\nReturn  lRet\r\n"}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT103TOK.PRW"}}}
Content-Length: 4050
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120APV.prw","languageId":"advpl","version":1,"text":"\r\n#Include \"Protheus.ch\"\r\n#Include \"RwMake.ch\"\r\n#Include \"TbiConn.ch\"\r\n#INCLUDE \"TOTVS.CH\"\r\n#INCLUDE \"TOPCONN.CH\"\r\n\r\n//Pazzini\r\nUser Function MT120APV()\r\n/***************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal ExpC1 := Nil\r\nLocal ExpC2 := Nil\r\nLocal cGrp  := \"\" //Grupo de aprovação\r\n\r\nLocal aPergs     := {}\r\nLocal aRetorn    := {}\r\nLocal cLoad      := \"00001\"\r\nLocal lCanSave   := .T.\r\nLocal lUserSave  := .T.\r\nLocal cTitulo    := \"GRUPO DE APROVADORES\"\r\nLocal bOk        := {|| .T.}\r\nLocal aButtons   := {}\r\nLocal lCentered  := .T.\r\nLocal nPosx\r\nLocal nPosy\r\nLocal cMSG       := \"\"\r\n//local aCombo   := {\"000001\",\"000002\",\"000003\",\"000004\",\"000005\",\"000006\",\"000007\",\"000008\",\"000009\",\"000010\",\"000011\",\"000012\",\"000013\",\"000014\",\"000015\"}\r\n\r\n\r\n\r\n/* Variável Privada */\r\nPrivate cNewGRP    := Space(06)\r\n//Private lIncluir \t:= .F.\r\n//Private lAlterar \t:= .F.\r\n\r\n/* Abro a empresa TESTE, caso faça uso via debug\r\nRemover para utilizar dentro do Protheus*/\r\n // RpcSetEnv('99','01')\r\nIF !IsBlind()  \r\n\r\n    If  !Type(\"ALTERA\") == \"U\"\r\n        ALTERA := .F.\r\n        INCLUIR := .T.\r\n    Endif\r\n\r\n    If !Type(\"INCLUIR\") == \"U\"\r\n        ALTERA := .T.\r\n        INCLUIR := .F.\r\n    Endif\r\n\r\n    If (ALTERA .OR. INCLUIR ) == .T.\r\n        If Type(\"PARAMIXB\") == \"U\"\r\n        \r\n            IF EMPTY(cMSG)\r\n                cMSG := AllTrim(cMSG) + \"ALTERAR GRUPO DE APROVADORES ! \" + chr(13)+chr(10)\r\n                If !IsBlind()  \r\n                    If MsgYesNo(cMSG + chr(13)+chr(10)+ \"Deseja continuar?\" )\r\n                        lRet := .t.\r\n                    Else\r\n                        lRet := .F.\r\n                        IF lRet == .F. .and. !IsBlind()  \r\n                            Return(lRet)\r\n                        EndIf \r\n                    EndIf\r\n                EndIf\r\n\r\n            EndIf\r\n                /* Adiciono a pergunta do Parambox */\r\n              //  aAdd(aPergs, {1, \"NOVO GRUPO : \" , cNewGRP  , aCombo[], \".T.\", \"\", \".T.\", 80, .F.})\r\n\r\n                /* Se a pergunta for confirmada */\r\n                //aAdd( aPergs ,{9,\"Abaixo escolha uma opção\",200, 40,.T.})                 \r\n                //aAdd( aPergs ,{2,\"Tipo 2 - Escolha:\",01,aCombo,50,\"\",.T.})\r\n\r\n\r\n               // aPergs := {}\r\n                cPergs := \"MT120APV01\"\r\n\r\n                Aadd(aPergs,{cPergs,\"Grupo de aprovadores?\",\"C\",06,00,\"G\",\"\",\"SAL\",\"\",\"\",\"\",\"\",\"\",\"\"})\r\n\r\n                U_Testasx1(cPergs,aPergs,.F.) \r\n                \r\n                If ! Pergunte(cPergs,.T.)\r\n                    Return(cGrp)\r\n                EndIf\r\n\r\n                If Empty(mv_par01)\r\n                    Return(cGrp)\r\n                EndIf\r\n                \r\n                cGrp := mv_par01\r\n                MSGALERT( \"Grupo alterado com sucesso ! \")\r\n        Else\r\n                ExpC1 := PARAMIXB[1]\r\n                ExpC2 := PARAMIXB[2]\r\n\r\n                //EXEMPLO 2 (Manipulando o saldo do pedido, na alteração do pedido):\r\n                //Manipulando o saldo do pedido pelo usuário, conf. necessidade, atualizando a variável n120TotLib\r\n                /*If ALTERA\r\n                    MSGALERT( \"ALTERAR no ponto MT120APV\")\r\n                Endif\r\n                \r\n                If INCLUIR\r\n                    MSGALERT( \"INCLUIR no ponto MT120APV\")\r\n                Endif\r\n                */  \r\n        EndIf\r\n\r\n    EndIf \r\n       // MSGALERT( \"Saindo do ponto de entrada MT120APV\")\r\nENDIF\r\n\r\nReturn cGrp\r\n\r\n"}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120APV.prw"}}}
Content-Length: 2591
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120FIM.prw","languageId":"advpl","version":1,"text":"#INCLUDE \"TOTVS.CH\"\r\n#Include 'FWMVCDef.ch'\r\n#INCLUDE \"PROTHEUS.CH\"\r\n#INCLUDE \"TOPCONN.CH\"\r\n#INCLUDE \"TBICONN.CH\"\r\n#INCLUDE \"RPTDEF.CH\"\r\n\r\n/*/{Protheus.doc} MT120FIM\r\n@description Ponto de entrada no final da gravacao do pedido\r\n@author..: PAZZINI\r\n@since...: 2023-04-19\r\n@version.: 1.0\r\n@type....: User function\r\n/*/\r\nUser Function MT120FIM()\r\n/************************************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal aArea := GetArea()\r\nLocal cA120Num := ParamIxb[2]\r\nLocal cSC7Filial := xFilial(\"SC7\")\r\nLocal cQuery := \"\"\r\n\r\n// Att C7_XNOMESC = C1_SOLICIT \r\ncQuery := \" UPDATE \" + RetSqlName(\"SC7\")\r\ncQuery += \"   SET C7_XNOMESC = C1_SOLICIT\r\ncQuery += \"   \tFROM \t\t\t\t\t\r\ncQuery += \"   \t\t\"+RetSqlName(\"SC7\")+\" SC7 WITH(NOLOCK) INNER JOIN \"+RetSqlName(\"SC1\")+\"  SC1 WITH(NOLOCK)  \t\t\t\t\t\t\r\ncQuery += \"   \t\t             ON(SC1.C1_FILIAL+SC1.C1_PEDIDO+C1_ITEMPED) = (C7_FILIAL+C7_NUM+C7_ITEMSC)    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\ncQuery += \"   \tWHERE SC7.D_E_L_E_T_ = '' \r\ncQuery += \"   \t  AND   SC1.D_E_L_E_T_ = ''\r\ncQuery += \"   \t  AND C7_NUM    = '\"+cA120Num+\"' \r\ncQuery += \"   \t  AND C7_FILIAL = '\"+cSC7Filial+\"'\r\n\r\nTcSQLExec(cQuery)\r\n\r\n// Att C7_NOMEPC = C7_OBS\r\ncQuery := \" UPDATE \" + RetSqlName(\"SC7\")\r\ncQuery += \"   SET C7_XMOTPC = C7_OBS\r\ncQuery += \"   \tFROM \t\t\t\t\t\r\ncQuery += \"   \t\t\"+RetSqlName(\"SC7\")+\" SC7 WITH(NOLOCK)   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\ncQuery += \"   \tWHERE SC7.D_E_L_E_T_ = '' \r\ncQuery += \"   \t  AND C7_NUM    = '\"+cA120Num+\"' \r\ncQuery += \"   \t  AND C7_FILIAL = '\"+cSC7Filial+\"'\r\n\r\nTcSQLExec(cQuery)\r\n\r\n// Att C7_NOMEPC = USR_NOME\r\ncQuery := \" UPDATE \" + RetSqlName(\"SC7\")\r\ncQuery += \"   SET C7_NOMEPC = SYS_USR.USR_NOME\r\ncQuery += \"   \tFROM \t\t\t\t\t\r\ncQuery += \"   \t\t\"+RetSqlName(\"SC7\")+\" SC7 WITH(NOLOCK) LEFT JOIN SYS_USR WITH(NOLOCK)  \t\t\t\t\t\t\r\ncQuery += \"   \t\t             ON(C7_USER) =(SYS_USR.USR_ID)   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\ncQuery += \"   \tWHERE SC7.D_E_L_E_T_ = '' \r\ncQuery += \"   \t  AND C7_NUM    = '\"+cA120Num+\"' \r\ncQuery += \"   \t  AND C7_FILIAL = '\"+cSC7Filial+\"'\r\n\r\nTcSQLExec(cQuery)\r\n\t\t\t\t\r\nRestArea(aArea)\r\n\r\nReturn()\r\n\r\n"}}}
Content-Length: 1262
{"jsonrpc":"2.0","id":4,"method":"$totvsserver/compilation","params":{"compilationInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNTMyMDM4MDowOjE6MQ==.fv6OFh+jUPJFYaF/8efycAfo2aK8i7mB/nOCgy4O9yOBeG+lli3EAtAU4i9eq2yea6iqcRTu0nz1HZFLty9oTt9M7QM+QJTq4HIGCPPF8oJcePAr9GRr6mLdZUp0bh/hUMQxSRrvYKA1lp+z4bh8w1djf/u2cZaUfvlDlrT8M417Gb8gxUw+wGSYEdb37CY+jwA0DUIhutOrR9uJ31q0vx3FaL64bw5KudYLV5itg74yLcqYPRs71cdy+Z6ZvPhEC5BM81Yh9XEmS8+9BlQ5o9/wbTNjCNm7WWRuzLQb5VJZZOOjT7eyfs2SVxb91irYdwz2p7gpB/ryA9i+FG3+qw==","authorizationToken":"","environment":"COMPILA_Q","includeUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/include"],"fileUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120FIM.prw"],"compileOptions":{"recompile":true,"debugAphInfo":true,"gradualSending":true,"generatePpoFile":false,"showPreCompiler":false,"priorVelocity":true,"returnPpo":false,"commitWithErrorOrWarning":false},"extensionsAllowed":[".PRW",".PRX",".PRG",".PPX",".PPP",".TLPP",".APW",".APH",".APL",".AHU",".TRES",".PNG",".BMP",".RES",".4GL",".PER",".JS",".RPTDESIGN"],"includeUrisRequired":true}}}
Content-Length: 178
{"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/05_ESTOQUE/A330DECC.prw","version":1}}}
Content-Length: 178
{"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/05_ESTOQUE/MTA105OK.PRW","version":1}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120FIM.prw"}}}
Content-Length: 4050
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120APV.prw","languageId":"advpl","version":1,"text":"\r\n#Include \"Protheus.ch\"\r\n#Include \"RwMake.ch\"\r\n#Include \"TbiConn.ch\"\r\n#INCLUDE \"TOTVS.CH\"\r\n#INCLUDE \"TOPCONN.CH\"\r\n\r\n//Pazzini\r\nUser Function MT120APV()\r\n/***************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal ExpC1 := Nil\r\nLocal ExpC2 := Nil\r\nLocal cGrp  := \"\" //Grupo de aprovação\r\n\r\nLocal aPergs     := {}\r\nLocal aRetorn    := {}\r\nLocal cLoad      := \"00001\"\r\nLocal lCanSave   := .T.\r\nLocal lUserSave  := .T.\r\nLocal cTitulo    := \"GRUPO DE APROVADORES\"\r\nLocal bOk        := {|| .T.}\r\nLocal aButtons   := {}\r\nLocal lCentered  := .T.\r\nLocal nPosx\r\nLocal nPosy\r\nLocal cMSG       := \"\"\r\n//local aCombo   := {\"000001\",\"000002\",\"000003\",\"000004\",\"000005\",\"000006\",\"000007\",\"000008\",\"000009\",\"000010\",\"000011\",\"000012\",\"000013\",\"000014\",\"000015\"}\r\n\r\n\r\n\r\n/* Variável Privada */\r\nPrivate cNewGRP    := Space(06)\r\n//Private lIncluir \t:= .F.\r\n//Private lAlterar \t:= .F.\r\n\r\n/* Abro a empresa TESTE, caso faça uso via debug\r\nRemover para utilizar dentro do Protheus*/\r\n // RpcSetEnv('99','01')\r\nIF !IsBlind()  \r\n\r\n    If  !Type(\"ALTERA\") == \"U\"\r\n        ALTERA := .F.\r\n        INCLUIR := .T.\r\n    Endif\r\n\r\n    If !Type(\"INCLUIR\") == \"U\"\r\n        ALTERA := .T.\r\n        INCLUIR := .F.\r\n    Endif\r\n\r\n    If (ALTERA .OR. INCLUIR ) == .T.\r\n        If Type(\"PARAMIXB\") == \"U\"\r\n        \r\n            IF EMPTY(cMSG)\r\n                cMSG := AllTrim(cMSG) + \"ALTERAR GRUPO DE APROVADORES ! \" + chr(13)+chr(10)\r\n                If !IsBlind()  \r\n                    If MsgYesNo(cMSG + chr(13)+chr(10)+ \"Deseja continuar?\" )\r\n                        lRet := .t.\r\n                    Else\r\n                        lRet := .F.\r\n                        IF lRet == .F. .and. !IsBlind()  \r\n                            Return(lRet)\r\n                        EndIf \r\n                    EndIf\r\n                EndIf\r\n\r\n            EndIf\r\n                /* Adiciono a pergunta do Parambox */\r\n              //  aAdd(aPergs, {1, \"NOVO GRUPO : \" , cNewGRP  , aCombo[], \".T.\", \"\", \".T.\", 80, .F.})\r\n\r\n                /* Se a pergunta for confirmada */\r\n                //aAdd( aPergs ,{9,\"Abaixo escolha uma opção\",200, 40,.T.})                 \r\n                //aAdd( aPergs ,{2,\"Tipo 2 - Escolha:\",01,aCombo,50,\"\",.T.})\r\n\r\n\r\n               // aPergs := {}\r\n                cPergs := \"MT120APV01\"\r\n\r\n                Aadd(aPergs,{cPergs,\"Grupo de aprovadores?\",\"C\",06,00,\"G\",\"\",\"SAL\",\"\",\"\",\"\",\"\",\"\",\"\"})\r\n\r\n                U_Testasx1(cPergs,aPergs,.F.) \r\n                \r\n                If ! Pergunte(cPergs,.T.)\r\n                    Return(cGrp)\r\n                EndIf\r\n\r\n                If Empty(mv_par01)\r\n                    Return(cGrp)\r\n                EndIf\r\n                \r\n                cGrp := mv_par01\r\n                MSGALERT( \"Grupo alterado com sucesso ! \")\r\n        Else\r\n                ExpC1 := PARAMIXB[1]\r\n                ExpC2 := PARAMIXB[2]\r\n\r\n                //EXEMPLO 2 (Manipulando o saldo do pedido, na alteração do pedido):\r\n                //Manipulando o saldo do pedido pelo usuário, conf. necessidade, atualizando a variável n120TotLib\r\n                /*If ALTERA\r\n                    MSGALERT( \"ALTERAR no ponto MT120APV\")\r\n                Endif\r\n                \r\n                If INCLUIR\r\n                    MSGALERT( \"INCLUIR no ponto MT120APV\")\r\n                Endif\r\n                */  \r\n        EndIf\r\n\r\n    EndIf \r\n       // MSGALERT( \"Saindo do ponto de entrada MT120APV\")\r\nENDIF\r\n\r\nReturn cGrp\r\n\r\n"}}}
Content-Length: 1262
{"jsonrpc":"2.0","id":5,"method":"$totvsserver/compilation","params":{"compilationInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNTMyMDM4MDowOjE6MQ==.fv6OFh+jUPJFYaF/8efycAfo2aK8i7mB/nOCgy4O9yOBeG+lli3EAtAU4i9eq2yea6iqcRTu0nz1HZFLty9oTt9M7QM+QJTq4HIGCPPF8oJcePAr9GRr6mLdZUp0bh/hUMQxSRrvYKA1lp+z4bh8w1djf/u2cZaUfvlDlrT8M417Gb8gxUw+wGSYEdb37CY+jwA0DUIhutOrR9uJ31q0vx3FaL64bw5KudYLV5itg74yLcqYPRs71cdy+Z6ZvPhEC5BM81Yh9XEmS8+9BlQ5o9/wbTNjCNm7WWRuzLQb5VJZZOOjT7eyfs2SVxb91irYdwz2p7gpB/ryA9i+FG3+qw==","authorizationToken":"","environment":"COMPILA_Q","includeUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/include"],"fileUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120APV.prw"],"compileOptions":{"recompile":true,"debugAphInfo":true,"gradualSending":true,"generatePpoFile":false,"showPreCompiler":false,"priorVelocity":true,"returnPpo":false,"commitWithErrorOrWarning":false},"extensionsAllowed":[".PRW",".PRX",".PRG",".PPX",".PPP",".TLPP",".APW",".APH",".APL",".AHU",".TRES",".PNG",".BMP",".RES",".4GL",".PER",".JS",".RPTDESIGN"],"includeUrisRequired":true}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT120APV.prw"}}}
Content-Length: 1069
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT103TOK.PRW","languageId":"advpl","version":1,"text":"#INCLUDE \"Protheus.ch\"\r\n#INCLUDE \"RwMake.ch\"\r\n#INCLUDE \"topconn.ch\" \r\n#INCLUDE \"Colors.ch\" \r\n#INCLUDE \"JPEG.CH\"\r\n\r\n/*\r\nPrograma        : Programa MT103TOK.prw\r\nObjetivo        : P.Entrada verificar valor digitado no campo numero dentro do documento de entrada. \r\nAutor           : Por Giliard Pazzini teste \t\r\nData/Hora       : 20/10/2022 16:36\r\nObs.            : \r\n*/\r\n\r\nUser Function MT103TOK()\r\n/*****************************************************************************************\r\n* Programa principal \r\n*\r\n***/  \r\nLocal lRet\t\t:= Paramixb[1]\r\n\r\nIf l103Inclui\r\n\tIf Len(Alltrim(cNFiscal)) <> 9 .or. cNFiscal == \"000000000\"\r\n\t\tMsgBox(\"Problema com a numeração do documento fiscal. Favor verificar!!!\",\"MT103TOK\",\"STOP\")\r\n\t\tlRet := .F.\r\n\tEndIf\r\nEndIf\r\n\r\nReturn  lRet\r\n"}}}
Content-Length: 1262
{"jsonrpc":"2.0","id":6,"method":"$totvsserver/compilation","params":{"compilationInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNTMyMDM4MDowOjE6MQ==.fv6OFh+jUPJFYaF/8efycAfo2aK8i7mB/nOCgy4O9yOBeG+lli3EAtAU4i9eq2yea6iqcRTu0nz1HZFLty9oTt9M7QM+QJTq4HIGCPPF8oJcePAr9GRr6mLdZUp0bh/hUMQxSRrvYKA1lp+z4bh8w1djf/u2cZaUfvlDlrT8M417Gb8gxUw+wGSYEdb37CY+jwA0DUIhutOrR9uJ31q0vx3FaL64bw5KudYLV5itg74yLcqYPRs71cdy+Z6ZvPhEC5BM81Yh9XEmS8+9BlQ5o9/wbTNjCNm7WWRuzLQb5VJZZOOjT7eyfs2SVxb91irYdwz2p7gpB/ryA9i+FG3+qw==","authorizationToken":"","environment":"COMPILA_Q","includeUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/include"],"fileUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT103TOK.PRW"],"compileOptions":{"recompile":true,"debugAphInfo":true,"gradualSending":true,"generatePpoFile":false,"showPreCompiler":false,"priorVelocity":true,"returnPpo":false,"commitWithErrorOrWarning":false},"extensionsAllowed":[".PRW",".PRX",".PRG",".PPX",".PPP",".TLPP",".APW",".APH",".APL",".AHU",".TRES",".PNG",".BMP",".RES",".4GL",".PER",".JS",".RPTDESIGN"],"includeUrisRequired":true}}}
Content-Length: 167
{"jsonrpc":"2.0","method":"textDocument/didClose","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT103TOK.PRW"}}}
Content-Length: 723
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT094CPC%20.prw","languageId":"advpl","version":1,"text":"#Include 'Protheus.ch'\r\n\r\n/*/{Protheus.doc} MT094CPC.prw\r\n@description \r\n@author PAZZINI\r\n@since 07/03/16\r\n@version 1.0\r\n@type User function\r\n/*/\r\nUser Function MT094CPC()\r\n/************************************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal cCampos := \"\"\r\n\r\ncCampos := \"C7_NOMEPC|C7_CC|C7_OBS|C7_OBSM|C7_QUJE|C7_DATPRF|C7_USER|C7_NUMSC|C7_XNOMESC|C7_OBS|C7_OBSM|C7_XMOTPC\" \r\n\r\nReturn (cCampos)\r\n"}}}
Content-Length: 1265
{"jsonrpc":"2.0","id":7,"method":"$totvsserver/compilation","params":{"compilationInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNTMyMDM4MDowOjE6MQ==.fv6OFh+jUPJFYaF/8efycAfo2aK8i7mB/nOCgy4O9yOBeG+lli3EAtAU4i9eq2yea6iqcRTu0nz1HZFLty9oTt9M7QM+QJTq4HIGCPPF8oJcePAr9GRr6mLdZUp0bh/hUMQxSRrvYKA1lp+z4bh8w1djf/u2cZaUfvlDlrT8M417Gb8gxUw+wGSYEdb37CY+jwA0DUIhutOrR9uJ31q0vx3FaL64bw5KudYLV5itg74yLcqYPRs71cdy+Z6ZvPhEC5BM81Yh9XEmS8+9BlQ5o9/wbTNjCNm7WWRuzLQb5VJZZOOjT7eyfs2SVxb91irYdwz2p7gpB/ryA9i+FG3+qw==","authorizationToken":"","environment":"COMPILA_Q","includeUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/include"],"fileUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT094CPC%20.prw"],"compileOptions":{"recompile":true,"debugAphInfo":true,"gradualSending":true,"generatePpoFile":false,"showPreCompiler":false,"priorVelocity":true,"returnPpo":false,"commitWithErrorOrWarning":false},"extensionsAllowed":[".PRW",".PRX",".PRG",".PPX",".PPP",".TLPP",".APW",".APH",".APL",".AHU",".TRES",".PNG",".BMP",".RES",".4GL",".PER",".JS",".RPTDESIGN"],"includeUrisRequired":true}}}
Content-Length: 729
{"jsonrpc":"2.0","method":"textDocument/didChange","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT094CPC%20.prw","version":2},"contentChanges":[{"text":"#Include 'Protheus.ch'\r\n\r\n/*/\r\n{Protheus.doc} MT094CPC.prw\r\n@description \r\n@author PAZZINI\r\n@since 07/03/16\r\n@version 1.0\r\n@type User function\r\n/*/\r\nUser Function MT094CPC()\r\n/************************************************************************************************************************\r\n*\r\n*\r\n****/\r\nLocal cCampos := \"\"\r\n\r\ncCampos := \"C7_NOMEPC|C7_CC|C7_OBS|C7_OBSM|C7_QUJE|C7_DATPRF|C7_USER|C7_NUMSC|C7_XNOMESC|C7_OBS|C7_OBSM|C7_XMOTPC\" \r\n\r\nReturn (cCampos)\r\n"}]}}
Content-Length: 1240
{"jsonrpc":"2.0","id":8,"method":"$totvsserver/compilation","params":{"compilationInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNTMyMDM4MDowOjE6MQ==.fv6OFh+jUPJFYaF/8efycAfo2aK8i7mB/nOCgy4O9yOBeG+lli3EAtAU4i9eq2yea6iqcRTu0nz1HZFLty9oTt9M7QM+QJTq4HIGCPPF8oJcePAr9GRr6mLdZUp0bh/hUMQxSRrvYKA1lp+z4bh8w1djf/u2cZaUfvlDlrT8M417Gb8gxUw+wGSYEdb37CY+jwA0DUIhutOrR9uJ31q0vx3FaL64bw5KudYLV5itg74yLcqYPRs71cdy+Z6ZvPhEC5BM81Yh9XEmS8+9BlQ5o9/wbTNjCNm7WWRuzLQb5VJZZOOjT7eyfs2SVxb91irYdwz2p7gpB/ryA9i+FG3+qw==","authorizationToken":"","environment":"COMPILA_Q","includeUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/include"],"fileUris":["file:///extension-output-TOTVS.tds-vscode-%231-TOTVS%20LS"],"compileOptions":{"recompile":true,"debugAphInfo":true,"gradualSending":true,"generatePpoFile":false,"showPreCompiler":false,"priorVelocity":true,"returnPpo":false,"commitWithErrorOrWarning":false},"extensionsAllowed":[".PRW",".PRX",".PRG",".PPX",".PPP",".TLPP",".APW",".APH",".APL",".AHU",".TRES",".PNG",".BMP",".RES",".4GL",".PER",".JS",".RPTDESIGN"],"includeUrisRequired":false}}}
Content-Length: 181
{"jsonrpc":"2.0","method":"textDocument/didSave","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/MT094CPC%20.prw","version":2}}}
