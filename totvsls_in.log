Content-Length: 3121
{"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":8536,"clientInfo":{"name":"vscode","version":"1.67.0"},"rootPath":"d:\\TOTVS 12\\Microsiga\\Protheus\\ProjetoVSCode","rootUri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","capabilities":{"workspace":{"applyEdit":true,"workspaceEdit":{"documentChanges":true,"resourceOperations":["create","rename","delete"],"failureHandling":"textOnlyTransactional"},"didChangeConfiguration":{"dynamicRegistration":true},"didChangeWatchedFiles":{"dynamicRegistration":true},"symbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]}},"executeCommand":{"dynamicRegistration":true},"configuration":true,"workspaceFolders":true},"textDocument":{"publishDiagnostics":{"relatedInformation":true,"versionSupport":false,"tagSupport":{"valueSet":[1,2]}},"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"contextSupport":true,"completionItem":{"snippetSupport":true,"commitCharactersSupport":true,"documentationFormat":["markdown","plaintext"],"deprecatedSupport":true,"preselectSupport":true,"tagSupport":{"valueSet":[1]}},"completionItemKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]}},"hover":{"dynamicRegistration":true,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":true,"signatureInformation":{"documentationFormat":["markdown","plaintext"],"parameterInformation":{"labelOffsetSupport":true}},"contextSupport":true},"definition":{"dynamicRegistration":true,"linkSupport":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"hierarchicalDocumentSymbolSupport":true},"codeAction":{"dynamicRegistration":true,"isPreferredSupport":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}}},"codeLens":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true,"prepareSupport":true},"documentLink":{"dynamicRegistration":true,"tooltipSupport":true},"typeDefinition":{"dynamicRegistration":true,"linkSupport":true},"implementation":{"dynamicRegistration":true,"linkSupport":true},"colorProvider":{"dynamicRegistration":true},"foldingRange":{"dynamicRegistration":true,"rangeLimit":5000,"lineFoldingOnly":true},"declaration":{"dynamicRegistration":true,"linkSupport":true},"selectionRange":{"dynamicRegistration":true}},"window":{"workDoneProgress":true}},"initializationOptions":{"launchArgs":["--log-file=totvsls.log","--record=totvsls"]},"trace":"off","workspaceFolders":[{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","name":"ProjetoVSCode"}]}}
Content-Length: 52
{"jsonrpc":"2.0","method":"initialized","params":{}}
Content-Length: 15301
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/10_LIB/RelInWeb.prw","languageId":"advpl","version":1,"text":"#Include \"protheus.ch\"\r\n\r\n/*\r\nCriado por: Bruno\r\nData......: 12/01/2018\r\nUso.......: \r\n\r\nhttp://administrador:xpacD99label@189.50.0.33:10530/ReportServer/Pages/ReportViewer.aspx?%2fItinga_reports%2fRQ0056&rs:Command=Render\r\n*/\r\n#define SW_SHOWNA           8 // Esconde a barra de tarefas\r\n#define SW_SHOWNORMAL       1 // Normal\r\n\r\nUser Function RelInWEB(cPrograma,cDescri,cParam,cTipo)\r\n*******************************************************************************\r\n*  \r\n*\r\n***\r\n\tDefault cPrograma  := \"\"\r\n\tDefault cDescri    := \"\"\r\n\tDefault cParam     := \"\" \r\n\tDefault cTipo      := \"\"  \r\n\tDefault cLinkIe    := \"\"            \r\n\r\n\tPrivate cLink      := \"\"\r\n\tPrivate cLinkInt   := \"\"\r\n\tPrivate aInfoGeral := {}\r\n\t\r\n\tPrivate oDlg1, oTIBrw\r\n\r\n\tPrivate aSize\t   := MsAdvSize()\r\n\tPrivate aInfo\t   := {}\r\n\tPrivate aObj\t   := {}\r\n\tPrivate aPObj\t   := {}\r\n\r\n\tPrivate aRethora   := {}\r\n\r\n\t\r\n\tIf Empty(cPrograma) .and. Empty(cDescri)\r\n\t\tcPrograma\t:= SubString(FunDesc(), 1+At(\"[\",FunDesc()) , At(\"]\",FunDesc())  - At(\"[\",FunDesc()) -1  )\r\n\t\tcDescri\t\t:= Upper(SubString(FunDesc(), 1 , At(\"[\",FunDesc()) - 1 ))\r\n\t\tIf len(strTokArr(FunDesc(), ',' )) == 2\r\n\t\t\tcTipo       := IIf(empty(strTokArr(FunDesc(), ',' )[2]) , '' , strTokArr(FunDesc(), ',' )[2]) \r\n\t\tEndIF\r\n\tEndIf\r\n\r\n\tIf UPPER(SubString(cPrograma,1,3)) == \"RIM\" .AND. SubString(CNUMEMP,1,2) == \"01\"\r\n\t\tAlert(\"Este relatório não pertence a essa empresa!\")\r\n\t\tReturn()\r\n\tEndIf\r\n\t\r\n\t//If GetEnvServer() == \"PRODUCAO\"\r\n\t\r\n\tcLink\t\t:= \"http://189.50.0.33:10530/reportserver/Pages/ReportViewer.aspx?%2fItinga_reports%2f\"+ cPrograma //+\"&rs:Command=Render\"+ cParam\r\n\tcLinkInt\t:= \"http://189.50.0.33:10530/reportserver/Pages/ReportViewer.aspx?%2fItinga_reports%2f\"+ cPrograma\r\n\t\r\n\tcLinkIe   \t:= \"http://189.50.0.33:10530/reportserver/Pages/ReportViewer.aspx?%2fItinga_reports%2f\"+ cPrograma\r\n\r\n\t//cLink\t\t:= \"http://189.50.0.33:10530/ReportServer/Pages/ReportViewer.aspx?%2fItinga_reports%2fRIM0019&rs:Command=Render\"\r\n\t//EndIf\r\n\t//http://192.168.0.201/report_server?%2fsup_brasil%2fRSB0027&DTINI=2018/1/1&DTFIM=2018/12/31&NATINI=0&NATFIM=ZZZZZZ&TIPOPREV=2&rs:Format=MHTML\" -O '+ @Filename +''\r\n\r\n\t//Alert(GetEnvServer())\r\n\r\n\tIf \"COMPI\" $ upper(GetEnvServer())  \t\r\n\t\tcLink\t\t:= \"http://Administrator:xpacD99label@192.168.1.104:10530/ReportServer/Pages/ReportViewer.aspx?%2fItinga_reports%2f\"+ cPrograma\r\n\t\tcLinkIe   \t:= \"http://Administrator:xpacD99label@192.168.1.104:10530/ReportServer/Pages/ReportViewer.aspx?%2fItinga_reports%2f\"+ cPrograma\r\n\tEndIf\r\n\t\r\n\t/*\r\n\tcLink\t\t:= \"http://192.168.1.23:10520/reportserver/Pages/ReportViewer.aspx?%2fMARIZA%2f\"+ cPrograma //+\"&rs:Command=Render\"+ cParam\r\n  \t\r\n\tIf GetEnvServer() == \"REMOTO\"\r\n\t\tcLink\t\t:= \"http://proteus.marizaalimentos.com.br:10520/reportserver/Pages/ReportViewer.aspx?%2fMARIZA%2f\"+ cPrograma\r\n\tEndIf\r\n\t*/\r\n\t\r\n\t/*\r\n\tIf GetClientIP() == \"192.168.1.101\"\r\n\t\tcLink\t\t:= \"http://192.168.1.101:10530/reportserver/Pages/ReportViewer.aspx?%2fItinga_reports%2f\"+ cPrograma\r\n\tEndIf\r\n\t*/\r\n\r\n\tIf !Empty(cParam)\r\n\t\tcParam      := &cParam \r\n\t\tcLink\t\t:= cLink    + cParam\r\n\t\tcLinkInt    := cLinkInt + cParam  \r\n\t\tcLinkIe     := cLinkIe  + cParam  \r\n\tEndIf\r\n\t\t\r\n\t//Na versão 12, houve uma mudança na função que reversa 30pixels na janela\r\n\t\r\n\tIf AllTrim(cversao)==\"12\"\r\n\t\taSize[2] := 0\r\n\tEndIf\r\n\r\n\taInfo := { aSize[1], aSize[2], aSize[3], aSize[4], 0, 05 }\r\n\taAdd( aObj, { 000, 000, .T., .T. }) //MenuBar\r\n\taPObj := MsObjSize( aInfo, aObj ) \r\n\r\n\taRethora := FwTimeUF(\"MG\")\r\n\r\n\t//If aRethora[1] >= \"20220101\" //*<------------cofigurar a validade e trocar as datas abaixo\r\n\t//\tAlert(\"SIGAWISE! Atualize os relatórios.\")      \r\n\t//\tReturn()\r\n\t//EndIf\r\n\r\n/*\r\ncBaseUrl := cLink\r\n\r\ncHtml:= \"<!DOCTYPE html>\"+;\r\n          \"<html>\"+;\r\n              '<head  lang=\"pt-BR\">'+;  \r\n              \"</head>\"+;\r\n              \"<body>\"+;\r\n                  \"<h1>TWebEngine com SetHtml</h1>\"+;\r\n                  \"<p>\"+cLink+\"</p>\"+;\r\n                  \"<br>\"+;\r\n                  \"<img src='workplace.jpg' alt='Workplace'>\"+;\r\n                  '<div lang=\"pt-BR\" align=\"center\">'+;\r\n                  \t'<IFRAME src=\"'+cLink+'\" name=Destaques width=100% marginwidth=\"0\" height=100% marginheight=\"0\" align=\"top\" scrolling=no frameBorder=0 hspace=\"0\" vspace=\"0\" allowtransparency=\"true\"></IFRAME>'+;\r\n                  '</div>'+;\r\n              \"</body>\"+;\r\n          \"</html>\"\r\n \r\n */\r\n \r\n cHtml:= \"<html><body><script language=javascript>window.open('\" + cLink + \"','\" + cPrograma + \"','resizable=1,scrollbars=1,width=760,height=680,left=2,top=2,toolbar=0,status=0,location=0,menubar=0');</script></body></HTML>\"\r\n  \r\n aInfoGeral := GetRmtInfo()\r\n  \r\n //Alert(aInfoGeral[9]) \r\n  \r\n //AVISO(\"Leia com Atenção!\", \"Os relatórios dinâmicos serão abertos em um modelo externo ao Protheus! Para Fechar use o (ALT)+[F4]!\" , { \"Fechar\" }, 1)\r\n \r\n //WaitRun(\"cmd /c start iexplore.exe -k \"+ '\"' + cLink +'\"', SW_SHOWNA )\r\n //&rc:Toolbar=false\r\n \r\n//DRSFile(cLink) \r\n \r\n \r\n //If !Empty(cParam)\r\n If  (\"SAFARI\") $ UPPER(aInfoGeral[9])\r\n \r\n \t//ShellExecute('open',cLink,\"\",\"\",1)\r\n \t//ShellExecute(\"Open\",\"http://www.google.com.br\", \"\", \"C:\\\", 1 )\r\n\r\n\t//DRSFile(\"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\\"+cPrograma+\"_DS.PDF\", cLink  +\"&rs:Format=pdf\")\r\n  \r\n\t//IF (\"SAFARI\") $ UPPER(aInfoGeral[9])\r\n    /*\r\n\tDEFINE MSDIALOG oDlg1 TITLE \"RELATÓRIO \"+ cDescri From aSize[7],0 to aSize[6],aSize[5] of oMainWnd PIXEL\r\n\t\r\n\t\t\r\n\t\toTBar := TBar():New( oDlg1, 25, 32, .T.,,,, .F. )\r\n\t\t\r\n\t  //oTBtnBmp1 := TBtnBmp2():New( 00, 00, 35, 25, 'S4WB010N',,,,      { || AVISO(\"Leia com Atenção!\", \"Os relatórios dinâmicos serão abertos em um modelo externo ao Protheus! Para Fechar use o (ALT)+[F4]!\" , { \"Fechar\" }, 1),ShellExecute( \"Open\", \"%PROGRAMFILES%\\Internet Explorer\\iexplore.exe\", '-k \"' + cLink +'\"', \"C:\\\", 3 ) }, oTBar, 'Imprimir',, .F., .F. )\r\n\t    //oTBtnBmp2 := TBtnBmp2():New( 00, 00, 35, 25, 'PMSEXCEL',,,,      { || WaitRunSrv( '\"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\wget.exe\" -t 1 \"' + cLinkInt  +'&rs:Format=pdf\"  -O \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\'+cPrograma+'.PDF\"'   , .T. , \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\\" )         , bOk := CpyS2T( \"\\RELINWEB\\\"+cPrograma+\".xlsx\", \"C:\\TEMP\" ) , ShellExecute( \"Open\", cPrograma+'.xlsx',\"\" , \"C:\\TEMP\\\", 3 )}, oTBar, 'MS Excel',, .F., .F. )\r\n\t    \r\n\t    \r\n\t    oTBtnBmp2 := TBtnBmp2():New( 00, 00, 35, 25, 'PMSEXCEL',,,,      { || oWebEngine:PrintPDF() }, oTBar, '*.pdf',, .F., .F. )\r\n\t    \r\n\t    \r\n\t    //oTBtnBmp3 := TBtnBmp2():New( 00, 00, 35, 25, 'PAPEL_ESCRITO',,,, { || WaitRunSrv( '\"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\wget.exe\" -t 1 \"' + cLinkInt  +'&rs:Format=EXCELOPENXML\" -O \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\'+cPrograma+'.xlsx\"'  , .T. , \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\\" ) , bOk := CpyS2T( \"\\RELINWEB\\\"+cPrograma+\".PDF\" , \"C:\\TEMP\" ) , ShellExecute( \"Open\", cPrograma+'.TXT' ,\"\" , \"C:\\TEMP\\\", 3 )}, oTBar, 'TXT',, .F., .F. )\r\n\t    //oTBtnBmp4 := TBtnBmp2():New( 00, 00, 35, 25, 'ATALHO',,,,        { || WaitRunSrv( '\"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\wget.exe\" -t 1 \"' + cLinkInt  +'&rs:Format=CSV\" -O \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\'+cPrograma+'.txt\"'  , .T. , \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\\" )           , bOk := CpyS2T( \"\\RELINWEB\\\"+cPrograma+\".TXT\" , \"C:\\TEMP\" ) , ShellExecute( \"Open\", cPrograma+'.PDF' ,\"\" , \"C:\\TEMP\\\", 3 )}, oTBar, 'PDF',, .F., .F. )\r\n\t    oTBtnBmp4 := TBtnBmp2():New( 00, 00, 35, 25, 'TK_REFRESH',,,,    { || oWebEngine:setHtml(cHtml, cLink) }, oTBar, 'Atualizar',, .F., .F. )\r\n\t    oTBtnBmp4 := TBtnBmp2():New( 00, 00, 35, 25, 'FINAL',,,,         { || oDlg1:end() }, oTBar, 'Sair',, .F., .F. )\r\n\t    \r\n\t\t//oTIBrw := TIBrowser():New( aPObj[1,1],aPObj[1,2],aPObj[1,4],aPObj[1,3], cLink, oDlg1 )\r\n\t\t\r\n\t\tPRIVATE oWebChannel := TWebChannel():New()\r\n\t \tnPort \t\t\t\t:= oWebChannel::connect()\r\n\t \t \t\r\n\t \toWebEngine := TWebEngine():New(oDlg1, aPObj[1,1],aPObj[1,2],aPObj[1,4],aPObj[1,3],,)\r\n\t \t//oWebEngine := TWebEngine():New(test:Content, 0, 0, 100, 100,, nPort)\r\n\t \t\r\n\t\toWebEngine:navigate(cLink)\r\n\t\t\r\n\t\t//oWebEngine:bLoadFinished := {|self,url| DRSFile(cLink) }\r\n\t \t\r\n\t\t//oWebEngine:setHtml(cLink, cLink)\r\n\t\t//oWebEngine:Align := CONTROL_ALIGN_ALLCLIENT\r\n\t\t//oWebEngine:bLoadFinished := {|self,url| conout(\"Termino da carga do pagina: \" + url) }\r\n\t\t\r\n\tActivate MsDialog oDlg1\r\n\t*/\r\nElse\r\n\r\n\t//AVISO(\"Leia com Atenção!\", \"Os relatórios dinâmicos serão abertos em um modelo externo ao Protheus! Para Fechar use o (ALT)+[F4]!\" , { \"Fechar\" }, 1)\r\n\t//ShellExecute( \"Open\", \"%PROGRAMFILES%\\Internet Explorer\\iexplore.exe\", '-k \"' + cLink +'\"', \"C:\\\", 3 )\r\n\t//ShellExecute( \"Open\", \"%PROGRAMFILES%\\Internet Explorer\\iexplore.exe\", cHtml, \"C:\\\", 3 )\r\n\r\nEndIf\r\n   \r\n// Prepara o conector WebSocket\r\n\r\nIf Upper(cTipo) == \"[IE]\"\r\n\r\n\tAVISO(\"Leia com Atenção!\", \"Os relatórios dinâmicos serão abertos em um modelo externo ao Protheus! Para Fechar use o (ALT)+[F4]!\" , { \"Fechar\" }, 1)\r\n\tShellExecute( \"Open\", \"%PROGRAMFILES%\\Internet Explorer\\iexplore.exe\", '-k \"' + cLinkIe +'\"', \"C:\\\", 3 )\r\n\t\r\nElse\r\n\r\n\tDEFINE MSDIALOG oDlg1 TITLE \"RELATÓRIO \"+ cDescri From aSize[7],0 to aSize[6],aSize[5] of oMainWnd PIXEL\r\n\t\t//oTIBrw := TIBrowser():New( aPObj[1,1],aPObj[1,2],aPObj[1,4],aPObj[1,3], cLink, oDlg1 )\r\n\t\t\r\n\t\t//PRIVATE oWebChannel := TWebChannel():New()\r\n\t \t//nPort \t\t\t  := oWebChannel::connect()\r\n\t \t \t\r\n\t \toWebEngine := TWebEngine():New(oDlg1, aPObj[1,1],aPObj[1,2],aPObj[1,4],aPObj[1,3],,)\r\n\t\toWebEngine:cLang := \"pt-BR\"\r\n\t \t//oWebEngine := TWebEngine():New(test:Content, 0, 0, 100, 100,, nPort)\r\n\t \t\r\n\t\toWebEngine:navigate(cLink)\r\n\t\t//oWebEngine:bDlStatus := {|self,nStatus,sPath| conout( \"Status do download: \" + Str(nStatus) + \" (\" + sPAth + \")\" )}\r\n\t\t//oWebEngine:bLoadFinished := {|self,url| DRSFile(cLink) }\r\n\t \t\r\n\t\t//oWebEngine:setHtml(cHtml, cBaseUrl)\r\n\t\toWebEngine:Align := CONTROL_ALIGN_ALLCLIENT\r\n\t\t//oWebEngine:bLoadFinished := {|self,url| conout(\"Termino da carga do pagina: \" + url) }\r\n\r\n\tActivate MsDialog oDlg1\r\n\r\nEndIf\r\n\r\nReturn\r\n\r\nStatic Function MGUrlMain(cUrlNow)\r\n*******************************************************************************\r\n*  \r\n*\r\n***\r\n\r\nMsgAlert(cUrlNow)\r\noWebEngine:goBack()\r\n \r\nReturn()\r\n\r\n \r\nStatic Function DRSFile()\r\n*******************************************************************************\r\n*  \r\n*\r\n***\r\n//local cLocalFile := \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\test_bruno.pdf\"\r\n//local cURL1      := \"http://192.168.1.101:10530/reportserver/Pages/ReportViewer.aspx?%2fItinga_reports%2fRIM0023&cFilDest=&rs:Format=pdf\"\r\n\r\n    Local cURL    := \"http://192.168.1.101:10530\"                      // URL DO SERVIÇO\r\n    Local cPath   := \"/reportserver/Pages/ReportViewer.aspx?%2fItinga_reports%2fRIM0023&cFilDest=&rs:Format=pdf\" // RECURSO DA URI\r\n    Local aHeader := {}                                           // CABEÇALHO DE INFORMAÇÕ?ES DA REQUISIÇÃO\r\n    Local oRest   := NIL                                          // CLIENTE PARA CONSUMO\r\n    Local nHandle := 00                                           // CÓDIGO DE SUPORTE AO ARQUIVO\r\n\r\n        // INSTANCIA O CLIENTE REST\r\n        oRest := FwRest():New(cURL)\r\n\r\n        // INFORMA O RECURSO E O BODY\r\n        oRest:SetPath(cPath)\r\n\r\n        // ENVIA A REQUISIÇÃO E VALIDA O RESULTADO\r\n        If (oRest:Get(aHeader))\r\n            // CRIA O NOME DO ARQUIVO (FUNÇÕES UTILIZADAS PARA EVITAR CONFLITO DE NOME)\r\n            nHandle := FCreate(\"\\dirdoc\\\" + StrTran(DToS(Date()) + \"_\" + Time() + \"_DOCUMENT.pdf\", \":\", \"\"))\r\n            FWrite(nHandle, oRest:GetResult())\r\n            FClose(nHandle)\r\n\r\n            // VERIFICA SE O ARQUIVO FOI CRIADO CORRETAMENTE\r\n            If (!File(\"\\dirdoc\\\" + cFileName))\r\n                ConOut(\"@ADVPL: Couldn't generate *.PDF file\")\r\n            EndIf\r\n        Else\r\n            ConOut(\"@ADVPL: Couldn't consume API\")\r\n        EndIf\r\n\r\n\r\n/*local cUserPwd   := \"\" //\"john.doe@example.com:my_password\"\r\nlocal aInfo      := {}\r\nlocal nRet       := 0\r\nlocal cFileName  := \"\"\r\n         \r\nLocal cURL    := \"http://192.168.1.101:10530\"                      // URL DO SERVIÇO\r\nLocal cPath   := \"/reportserver/Pages/ReportViewer.aspx?%2fItinga_reports%2fRIM0023&cFilDest=&rs:Format=pdf\" // RECURSO DA URI\r\nLocal aHeader := {}                                           // CABEÇALHO DE INFORM\r\nLocal oRest   := NIL                                          // CLIENTE PARA CONSUMO\r\nLocal nHandle := 00                                           // CÓDIGO DE SUPORTE AO ARQUIVO\r\n\r\n// PREPARAÇÃO DE AMBIENTE (REMOVER SE EXECUTADO VIA GUI)\r\n\r\n// INSTANCIA O CLIENTE REST\r\noRest := FwRest():New(cURL)\r\n\r\n// INFORMA O RECURSO E O BODY\r\noRest:SetPath(cPath)\r\n\r\n// ENVIA A REQUISIÇÃO E VALIDA O RESULTADO\r\nIf (oRest:Get(aHeader))\r\n    // CRIA O NOME DO ARQUIVO (FUNÇÕES UTILIZADAS PARA EVITAR CONFLITO DE NOME)\r\n    nHandle := FCreate(\"\\RELINWEB\\\" + StrTran(DToS(Date()) + \"_\" + Time() + \"_DOCUMENT.pdf\", \":\", \"\"))\r\n    FWrite(nHandle, oRest:GetResult())\r\n    FClose(nHandle)\r\n\r\n    // VERIFICA SE O ARQUIVO FOI CRIADO CORRETAMENTE\r\n    If (!File(\"\\RELINWEB\\\" + cFileName))\r\n        ConOut(\"@ADVPL: Couldn't generate *.PDF file\")\r\n    EndIf\r\nElse\r\n    ConOut(\"@ADVPL: Couldn't consume API\")\r\nEndIf\r\n         */\r\n/* \r\nconout(\"* fazendo download do arquivo \" + cLocalFile)\r\n         \r\nnRet = WDClient(\"GET\", cLocalFile, cURL1, \"\", cUserPwd, @aInfo)\r\n \r\nif nRet == 0\r\n   conout(\"* download bem sucedido, verifique nos arquivos locais\")\r\nelse\r\n   conout(cLocalFile)\r\n   conout(cURL1)\r\n   conout(\"* erro \" + AllTrim(Str(nRet)) + \" no download\")\r\n   conout(\"* httpRespCode=\" + AllTrim(Str(aInfo[1])))\r\n   conout(\"* erro2=\" + AllTrim(Str(aInfo[2])))\r\n   conout(\"* erro3=\" + AllTrim(Str(aInfo[3])))\r\nendif\r\n*/\r\n\r\n\r\nReturn()\r\n\r\n"}}}
Content-Length: 705
{"jsonrpc":"2.0","id":1,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6djF5aTBwNzQ4bm1ranViaXNrbGl4aW93NXFneDQ6MToxOTIuMTY4LjEuMTAzOjEyMzY6MDo3LjAwLjE5MTIwNVA6Mw==:djE6Y29tcGlsYV9xOkFkbWluOjNBQWx5ZERjZ1poWERxUzR2SWNIY2NxV1ZQdzJBM2E3Mm1aQTVuUFptRlU9|djI6MTY1MjEyMzcxNjowOjE6MQ==.fPN2ckVxdaGVTPmCxU4VX2NOGHPNzRvvBImARCWW2FClgOPDL9piKIYefXBBWJQIhKOYlh7i+E19GTZyPpT8OkiYZOxryJfbeKGAueHFoO1D8VXqz1W3vMkRRrihoUaBfj91QBZnefhrNuWupp78H+gDZNnM0kpkbPhQyp4sEcP7wAFiCL2AipHqbrbJ/kD0lZW8uOCjtpmICWKBJuwSJWFYk9yb2uC7lRFR/NP5ef9eUMgYmruRyXTdoJGkdGZUy77CZEThaA4xiuI4BL8iQz0oPs877sPVFLnKZ0COecWHYbTJSBymoGJyUvBAPvuKB9Jy+JJrwA5aSgPLrvu5ZQ==","serverName":"SRV_DEVELOPER","connType":3}}}
Content-Length: 679
{"jsonrpc":"2.0","id":2,"method":"$totvsserver/serverPermissions","params":{"serverPermissionsInfo":{"connectionToken":"djM6djF5aTBwNzQ4bm1ranViaXNrbGl4aW93NXFneDQ6MToxOTIuMTY4LjEuMTAzOjEyMzY6MDo3LjAwLjE5MTIwNVA6Mw==:djE6Y29tcGlsYV9xOkFkbWluOjNBQWx5ZERjZ1poWERxUzR2SWNIY2NxV1ZQdzJBM2E3Mm1aQTVuUFptRlU9|djI6MTY1MjE3ODQ3NzowOjE6MQ==.Wt0h7Xec5EOTugGUcUBmYWiFZElbYGoLYeKv4JmRoWZgtEYJieBHqTpG8w9rEMCDdix009KMk6joxEUA/EuMM9mjyoX2Fd3eDsrjPFuGNvuO46YjSiIfktxSgwYWPzbnOs3daEMO4/TH9ZQEc5Sz6QpaaCJNiKwIjEfzUhDQIuauwGib7ZDokVBfNXuTPxbv3CCB7K6baB9/MaxLjFocfMtCrER3UA6/vs/GIeC4aIH6A2WqRBmJCauDImrrOwQtrbeqREniKY8sSYmTF7FuXiTatf9SXLUbq5LzKvyCPEbeJalBV+RzwrmqOT7ep3eLVAcv91CzqPIB0zvg6E+ODg=="}}}
Content-Length: 183
{"jsonrpc":"2.0","id":3,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"includes","value":"D:\\TOTVS 12\\Microsiga\\Protheus\\include;"}}}
Content-Length: 869
{"jsonrpc":"2.0","id":4,"method":"$totvsserver/patchApply","params":{"patchApplyInfo":{"connectionToken":"djM6djF5aTBwNzQ4bm1ranViaXNrbGl4aW93NXFneDQ6MToxOTIuMTY4LjEuMTAzOjEyMzY6MDo3LjAwLjE5MTIwNVA6Mw==:djE6Y29tcGlsYV9xOkFkbWluOjNBQWx5ZERjZ1poWERxUzR2SWNIY2NxV1ZQdzJBM2E3Mm1aQTVuUFptRlU9|djI6MTY1MjE3ODQ3NzowOjE6MQ==.Wt0h7Xec5EOTugGUcUBmYWiFZElbYGoLYeKv4JmRoWZgtEYJieBHqTpG8w9rEMCDdix009KMk6joxEUA/EuMM9mjyoX2Fd3eDsrjPFuGNvuO46YjSiIfktxSgwYWPzbnOs3daEMO4/TH9ZQEc5Sz6QpaaCJNiKwIjEfzUhDQIuauwGib7ZDokVBfNXuTPxbv3CCB7K6baB9/MaxLjFocfMtCrER3UA6/vs/GIeC4aIH6A2WqRBmJCauDImrrOwQtrbeqREniKY8sSYmTF7FuXiTatf9SXLUbq5LzKvyCPEbeJalBV+RzwrmqOT7ep3eLVAcv91CzqPIB0zvg6E+ODg==","environment":"compila_q","patchUri":"file:///d%3A/TOTVS%2012/BKP_UPDATES/2022-05-10%20-%20LIB/22-05-02-LIB_LABEL_02052022_P12_LOBO-TTTP120.PTM","isLocal":true,"isValidOnly":false,"applyScope":"only_new"}}}
Content-Length: 722
{"jsonrpc":"2.0","id":5,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6bGRkNGY0b2oxM2NsMGlidnF4bTh3cHdyanMxcnB4OjE6MTkyLjE2OC4xLjEwMzoxMjMzOjA6Ny4wMC4xOTEyMDVQOjM=:djE6Q09NUElMQV9RX0lOVEVHUkFET1I6QWRtaW46ZTRHTlZ3V0ozOVA0WnhFZ3JudkRLbDBzb2QxeFdlZzBsMHR2ZzRaUElDRT0=|djI6MTY1MTU4NjQ5NDowOjE6MQ==.qh/e6HSEM36kUe/nxzaiaox29SM/PpZAIInifv0VTqnNojDvl6KosS1RQWT3jLP93brBIAFT8FV0zP8eEdajKLhAYBAX7YWMJLleEeX0IYEN/Xw3dKiC2Dp3vHimp3yJ7FdNfppsCfmGnERucOKYbZnqlxgYfkft4G4d7aA4AHhaMJcXNpsMIbXPaLw81W2Dt03DY2EMyxZwmMbk/F+Fh66Crvqkndd1V+s6/CwjaSSuDQgN9zF1D8hFFIxx4qVBVOYjJwU7tvxqG/LeJ+b+WJZN3GYpXb/EtiKU0dsNmOhloOBw7OVTuu/0h2qvyAmFEZ/zeQaz60XSc2VrRH3PXw==","serverName":"SRV_INTEGRADOR","connType":3}}}
Content-Length: 695
{"jsonrpc":"2.0","id":6,"method":"$totvsserver/serverPermissions","params":{"serverPermissionsInfo":{"connectionToken":"djM6bGRkNGY0b2oxM2NsMGlidnF4bTh3cHdyanMxcnB4OjE6MTkyLjE2OC4xLjEwMzoxMjMzOjA6Ny4wMC4xOTEyMDVQOjM=:djE6Q09NUElMQV9RX0lOVEVHUkFET1I6QWRtaW46ZTRHTlZ3V0ozOVA0WnhFZ3JudkRLbDBzb2QxeFdlZzBsMHR2ZzRaUElDRT0=|djI6MTY1MjE3ODU5ODowOjE6MQ==.B7kzCMUPZWKYJ7C880BxsGAL8Gswy4iYYKF0AXGiq8wpRQl0z3mp3Sseh8BzsEufaItfVfPkQ3A1Y/YZMfWchyOvTopz85TXhPVeFrIanjG7/WVwHkSB4M5OCR13NkcLqKYKUeQBlPScn7s73ASx6TM7aKK+rfZzBfi9DkMfgz7+rXRTnZ3x55Ulo/3hMRzG3AbR73KxDcGw7zTYB+v0Nx3kcv5JuuOmMzl9R3whc8SXIzY2tcRVOOVRMyCEsAmEOnheATRJVnhHmFfnznOzbAi/y1IAqNOEr5v7vzuFopmz9NTUJ1bRKZX9FEqr+ABP4MNoJVOxfvetbL3neOIQQQ=="}}}
Content-Length: 183
{"jsonrpc":"2.0","id":7,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"includes","value":"D:\\TOTVS 12\\Microsiga\\Protheus\\include;"}}}
Content-Length: 869
{"jsonrpc":"2.0","id":8,"method":"$totvsserver/patchApply","params":{"patchApplyInfo":{"connectionToken":"djM6djF5aTBwNzQ4bm1ranViaXNrbGl4aW93NXFneDQ6MToxOTIuMTY4LjEuMTAzOjEyMzY6MDo3LjAwLjE5MTIwNVA6Mw==:djE6Y29tcGlsYV9xOkFkbWluOjNBQWx5ZERjZ1poWERxUzR2SWNIY2NxV1ZQdzJBM2E3Mm1aQTVuUFptRlU9|djI6MTY1MjE3ODQ3NzowOjE6MQ==.Wt0h7Xec5EOTugGUcUBmYWiFZElbYGoLYeKv4JmRoWZgtEYJieBHqTpG8w9rEMCDdix009KMk6joxEUA/EuMM9mjyoX2Fd3eDsrjPFuGNvuO46YjSiIfktxSgwYWPzbnOs3daEMO4/TH9ZQEc5Sz6QpaaCJNiKwIjEfzUhDQIuauwGib7ZDokVBfNXuTPxbv3CCB7K6baB9/MaxLjFocfMtCrER3UA6/vs/GIeC4aIH6A2WqRBmJCauDImrrOwQtrbeqREniKY8sSYmTF7FuXiTatf9SXLUbq5LzKvyCPEbeJalBV+RzwrmqOT7ep3eLVAcv91CzqPIB0zvg6E+ODg==","environment":"compila_q","patchUri":"file:///d%3A/TOTVS%2012/BKP_UPDATES/2022-05-10%20-%20LIB/22-05-02-LIB_LABEL_02052022_P12_LOBO-TTTP120.PTM","isLocal":true,"isValidOnly":false,"applyScope":"only_new"}}}
Content-Length: 896
{"jsonrpc":"2.0","id":9,"method":"$totvsserver/patchApply","params":{"patchApplyInfo":{"connectionToken":"djM6bGRkNGY0b2oxM2NsMGlidnF4bTh3cHdyanMxcnB4OjE6MTkyLjE2OC4xLjEwMzoxMjMzOjA6Ny4wMC4xOTEyMDVQOjM=:djE6Q09NUElMQV9RX0lOVEVHUkFET1I6QWRtaW46ZTRHTlZ3V0ozOVA0WnhFZ3JudkRLbDBzb2QxeFdlZzBsMHR2ZzRaUElDRT0=|djI6MTY1MjE3ODU5ODowOjE6MQ==.B7kzCMUPZWKYJ7C880BxsGAL8Gswy4iYYKF0AXGiq8wpRQl0z3mp3Sseh8BzsEufaItfVfPkQ3A1Y/YZMfWchyOvTopz85TXhPVeFrIanjG7/WVwHkSB4M5OCR13NkcLqKYKUeQBlPScn7s73ASx6TM7aKK+rfZzBfi9DkMfgz7+rXRTnZ3x55Ulo/3hMRzG3AbR73KxDcGw7zTYB+v0Nx3kcv5JuuOmMzl9R3whc8SXIzY2tcRVOOVRMyCEsAmEOnheATRJVnhHmFfnznOzbAi/y1IAqNOEr5v7vzuFopmz9NTUJ1bRKZX9FEqr+ABP4MNoJVOxfvetbL3neOIQQQ==","environment":"COMPILA_Q_INTEGRADOR","patchUri":"file:///d%3A/TOTVS%2012/BKP_UPDATES/2022-05-10%20-%20LIB/22-05-02-LIB_LABEL_02052022_P12_LOBO-TTTP120.PTM","isLocal":true,"isValidOnly":false,"applyScope":"only_new"}}}
Content-Length: 699
{"jsonrpc":"2.0","id":10,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6ajJicndyMzQ5N2VrdHg5NGxjZ3V5ejd6ODVlcWo6MToxOTIuMTY4LjEuMTAzOjEyNDc6MDo3LjAwLjE5MTIwNVA6Mw==:djE6V1NSRVNUOkFkbWluOkhKT1VzanVxM1BPNlh5TVN3MnFxWjJBVEszdEV1WHQwL0hMb1BBVWE1a0k9|djI6MTY1MTY2ODU5NjowOjE6MQ==.Ev0RytujojGjnef+MB+AILO22PTDIxN2YoqF/qd7MQr8A6FQu3tXPy7MrftWEkkpyw4rs11bZrP1vEz2tlLVT0VPcGPcxCRQqxirbQYApDA3oi8wB2dz8JJPydhm9/mEuf8tNJFmz6Ucubat36fB5LtpvnzPWY0NCWJZfnt5mArfxLS1fYwQsd+EpRW3EPSu8DZ17LGZW/DuMhBanjVu1v5QGEULS15fNS2mDHAFjtbkA0kVx9+a6kgRYniga5p9BjybgHjMDj92Ov5iAoiW2h08apX/8mest6KEj8uMDkRl3p+9C+h5Nwzd5Amo/Tgt0KaVZexj4Ydwm+YxTkMoxA==","serverName":"SRV_WSREST","connType":3}}}
Content-Length: 676
{"jsonrpc":"2.0","id":11,"method":"$totvsserver/serverPermissions","params":{"serverPermissionsInfo":{"connectionToken":"djM6ajJicndyMzQ5N2VrdHg5NGxjZ3V5ejd6ODVlcWo6MToxOTIuMTY4LjEuMTAzOjEyNDc6MDo3LjAwLjE5MTIwNVA6Mw==:djE6V1NSRVNUOkFkbWluOkhKT1VzanVxM1BPNlh5TVN3MnFxWjJBVEszdEV1WHQwL0hMb1BBVWE1a0k9|djI6MTY1MjE3ODY3NzowOjE6MQ==.LUBb3HoQBjAt1+qiJEFQAs6vKPi5DZSBloST5bLZO0tbgVeGfoAryY2imFJmPlKjjTQJ85G6dbNsNJf4Txy8LDFFu+r5gd0wMu/2m1eKS5SO6XFw7FDO5Uu5fsuBD2je/KJVn3nFOXGQdY60IqxF7FcMjsV7Pl2iOx+tguo0NmnCIgu7/0F4X477eHaQYgl3928vvElHvbRaFRLsUpFe4YaFH5SBb0c5RGVJfhvzV+CfZpWZNkD3UtGk7HWbI/X+wrRxAnXYYftX1i7Uc+8E2QbAMOJLnVXogF2So0ROWlrbJQZ/pwzw4/8Q1JJ6Qi2PJRX9sDNpRdc3Ac8YQvr5Ig=="}}}
Content-Length: 184
{"jsonrpc":"2.0","id":12,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"includes","value":"D:\\TOTVS 12\\Microsiga\\Protheus\\include;"}}}
Content-Length: 863
{"jsonrpc":"2.0","id":13,"method":"$totvsserver/patchApply","params":{"patchApplyInfo":{"connectionToken":"djM6ajJicndyMzQ5N2VrdHg5NGxjZ3V5ejd6ODVlcWo6MToxOTIuMTY4LjEuMTAzOjEyNDc6MDo3LjAwLjE5MTIwNVA6Mw==:djE6V1NSRVNUOkFkbWluOkhKT1VzanVxM1BPNlh5TVN3MnFxWjJBVEszdEV1WHQwL0hMb1BBVWE1a0k9|djI6MTY1MjE3ODY3NzowOjE6MQ==.LUBb3HoQBjAt1+qiJEFQAs6vKPi5DZSBloST5bLZO0tbgVeGfoAryY2imFJmPlKjjTQJ85G6dbNsNJf4Txy8LDFFu+r5gd0wMu/2m1eKS5SO6XFw7FDO5Uu5fsuBD2je/KJVn3nFOXGQdY60IqxF7FcMjsV7Pl2iOx+tguo0NmnCIgu7/0F4X477eHaQYgl3928vvElHvbRaFRLsUpFe4YaFH5SBb0c5RGVJfhvzV+CfZpWZNkD3UtGk7HWbI/X+wrRxAnXYYftX1i7Uc+8E2QbAMOJLnVXogF2So0ROWlrbJQZ/pwzw4/8Q1JJ6Qi2PJRX9sDNpRdc3Ac8YQvr5Ig==","environment":"WSREST","patchUri":"file:///d%3A/TOTVS%2012/BKP_UPDATES/2022-05-10%20-%20LIB/22-05-02-LIB_LABEL_02052022_P12_LOBO-TTTP120.PTM","isLocal":true,"isValidOnly":false,"applyScope":"only_new"}}}
Content-Length: 692
{"jsonrpc":"2.0","id":14,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6aXg4cmRtZGtremVrcHdtMmh4YTZ0b3BnY2pjODhuOjE6MTkyLjE2OC4xLjEwMzo1MDYwOjE6Ny4wMC4xOTEyMDVQOjM=:djE6U1BFRDpBZG1pbjpqdlhrSm1HNEdEbWZrWUNHSjRKR0RkQ2RVYXpCbzdPcjhMekdIcnBoWGU4PQ==|djI6MTY1MTU4NjUzOTowOjE6MQ==.WvZGhSrTi5cyPp5QclG6JeU0+SbD9r+O06C4Co4Di3YwuP4K/t2APVStsqr169TIkRFXaYFyq5CgnKMdOPgZYy272Np1wBnCeI9WXz9ef+TzOF4EeIQrjlQxVAuNprgZrgvXS+81IM1pBLCboxtkEKncNeojAPWfHoCELmTwRyuGRdVTkQXJsg41SbCRtZ3PuqeHHOT+7JyrrCl5FuC6kVI+bHF1kIWCrHH/pP3xQpkvQsjYJPfySOQHOWNerhi/7iTHKeaqOoATtjgFY/8QV/hj+FdxeulQnjVqRty5K830/xPpea4NBO9imH+wpTEobnmOYYaPinHnjUvjyZs9Cg==","serverName":"TSS","connType":3}}}
Content-Length: 676
{"jsonrpc":"2.0","id":15,"method":"$totvsserver/serverPermissions","params":{"serverPermissionsInfo":{"connectionToken":"djM6aXg4cmRtZGtremVrcHdtMmh4YTZ0b3BnY2pjODhuOjE6MTkyLjE2OC4xLjEwMzo1MDYwOjE6Ny4wMC4xOTEyMDVQOjM=:djE6U1BFRDpBZG1pbjpqdlhrSm1HNEdEbWZrWUNHSjRKR0RkQ2RVYXpCbzdPcjhMekdIcnBoWGU4PQ==|djI6MTY1MjE3ODczOTowOjE6MQ==.czP+71llhOisn2lSKGQ5UPN2+5hRliz6Yj4gasqCVC1ajdTujg03vlV5PW4JKnJaPBUB5qxsIOeugxuUo2Ka642YflfwOOYVNTP/qPgVt6Hu9NB2sizPB87uxgKz4/T3GTRZdG7tv8pDIptou/EgoyZDDJDtpUE8CFq7fkRToRkTU2Qx0qhZYD5Bpj7k9eUALL37TYV0Cfs5iorRDRGsbSoHqgrdWxnBriWXuoPLsRiPaU+HY4yLvX+P+e7G5EfzIKAGH551o6kwUGZ4VwLJyIfJ2HHE0AimDi5uKWS6PrQx5n87XzaieCDQTvSQ2mTU76gT77A/MRaPsk30/BO4aA=="}}}
Content-Length: 706
{"jsonrpc":"2.0","id":16,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6djF5aTBwNzQ4bm1ranViaXNrbGl4aW93NXFneDQ6MToxOTIuMTY4LjEuMTAzOjEyMzY6MDo3LjAwLjE5MTIwNVA6Mw==:djE6Y29tcGlsYV9xOkFkbWluOjNBQWx5ZERjZ1poWERxUzR2SWNIY2NxV1ZQdzJBM2E3Mm1aQTVuUFptRlU9|djI6MTY1MjE3ODQ3NzowOjE6MQ==.Wt0h7Xec5EOTugGUcUBmYWiFZElbYGoLYeKv4JmRoWZgtEYJieBHqTpG8w9rEMCDdix009KMk6joxEUA/EuMM9mjyoX2Fd3eDsrjPFuGNvuO46YjSiIfktxSgwYWPzbnOs3daEMO4/TH9ZQEc5Sz6QpaaCJNiKwIjEfzUhDQIuauwGib7ZDokVBfNXuTPxbv3CCB7K6baB9/MaxLjFocfMtCrER3UA6/vs/GIeC4aIH6A2WqRBmJCauDImrrOwQtrbeqREniKY8sSYmTF7FuXiTatf9SXLUbq5LzKvyCPEbeJalBV+RzwrmqOT7ep3eLVAcv91CzqPIB0zvg6E+ODg==","serverName":"SRV_DEVELOPER","connType":3}}}
Content-Length: 680
{"jsonrpc":"2.0","id":17,"method":"$totvsserver/serverPermissions","params":{"serverPermissionsInfo":{"connectionToken":"djM6djF5aTBwNzQ4bm1ranViaXNrbGl4aW93NXFneDQ6MToxOTIuMTY4LjEuMTAzOjEyMzY6MDo3LjAwLjE5MTIwNVA6Mw==:djE6Y29tcGlsYV9xOkFkbWluOjNBQWx5ZERjZ1poWERxUzR2SWNIY2NxV1ZQdzJBM2E3Mm1aQTVuUFptRlU9|djI6MTY1MjE3ODQ3NzowOjE6MQ==.Wt0h7Xec5EOTugGUcUBmYWiFZElbYGoLYeKv4JmRoWZgtEYJieBHqTpG8w9rEMCDdix009KMk6joxEUA/EuMM9mjyoX2Fd3eDsrjPFuGNvuO46YjSiIfktxSgwYWPzbnOs3daEMO4/TH9ZQEc5Sz6QpaaCJNiKwIjEfzUhDQIuauwGib7ZDokVBfNXuTPxbv3CCB7K6baB9/MaxLjFocfMtCrER3UA6/vs/GIeC4aIH6A2WqRBmJCauDImrrOwQtrbeqREniKY8sSYmTF7FuXiTatf9SXLUbq5LzKvyCPEbeJalBV+RzwrmqOT7ep3eLVAcv91CzqPIB0zvg6E+ODg=="}}}
Content-Length: 184
{"jsonrpc":"2.0","id":18,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"includes","value":"D:\\TOTVS 12\\Microsiga\\Protheus\\include;"}}}
Content-Length: 13169
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/02_COMPRAS/IMPPC.PRW","languageId":"advpl","version":1,"text":"#INCLUDE \"TopConn.CH\"\r\n#INCLUDE \"RWMAKE.CH\"\r\n#INCLUDE \"PROTHEUS.CH\"   \r\n#INCLUDE \"TBICONN.CH\"\r\n\r\n\r\n/*\r\n+----------+-----------+----------+-------------------------+------+-----------+\r\n|Programa  | ImpPc     | Autor    | BRUNO LAGE FERREIRA     |Data  |11.02.2020 |\r\n+----------+-----------+----------+-------------------------+------+-----------+\r\n|Descricao | Impressão de Relatorio Pedido de Compras                          |\r\n+----------+-------------------------------------------------------------------+\r\n| USO      | Compras\t\t\t\t                     \t\t\t\t\t   |\r\n+----------+-------------------------------------------------------------------+\r\n|           ALTERACOES FEITAS DESDE A CRIACAO                                  |\r\n+----------+-----------+-------------------------------------------------------+\r\n|Autor     | Data      | Descricao                                             |\r\n+----------+-----------+-------------------------------------------------------+\r\n|          |           |                                                       |\r\n+----------+-----------+-------------------------------------------------------+\r\nQ-Liberação Faturamento\r\n5527995295180-1587589430@g.us\r\n\r\nQ-N2 - Liberação Compras\r\n5527995295180-1594316108@g.us\r\n\r\nQ-N1 - Liberação Compras\r\n5527995295180-1587589523@g.us\r\n*/\r\n\r\nUser Function MT121BRW()\r\n/**********************************************************************************\r\n* Adição do novo menu personalizado para impressao do pedido de compras.\r\n*\r\n****/\r\nLocal aSubMnu := {}\r\n\r\n\tAAdd(aSubMnu,\t{ \"Nível 01\" , \"U_fPCWAAPP('1')\", 0 , 6, 0, nil})  \t    \r\n\tAAdd(aSubMnu,\t{ \"Nível 02\" , \"U_fPCWAAPP('2')\", 0 , 6, 0, nil})  \t\t\r\n\r\n\taAdd(aRotina,{\"(NEW) Ped.Compra\",\"u_ImpPc(1)\" , 0, 2, 0, Nil }) //\"New Ped. Compra\"\r\n\r\n\t/*\r\n\tSomente para Qualitá\r\n\t*/\r\n\tIf SubString(CNUMEMP,1,2) == \"01\"\r\n\t\tAAdd(aRotina,{ \"Enviar Ped.Compra WhatsApp\" , aSubMnu, 0 , 6, 0, nil})  \t\t   \t\t\t\t\t\t\t\t\t\t//\"pedido de compra\r\n\tEndIf\r\n\r\nReturn \r\n\r\n\r\nUser Function fPCWAAPP(cOpcao)\r\n****************************************************************************************************************\r\n*    \r\n*\r\n****\r\n\r\n/*\r\nAtualiza os dados do relatorio mantendo \r\nsempre o atual. O tempo de execução este caso nao necessita abrir o relatorio na tela\r\n*/\r\nu_ImpPc(2)\r\n\r\nWaitRunSrv( '\"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\wget.exe\" -t 1 \"http://192.168.1.101:10530/ReportServer/Pages/ReportViewer.aspx?%2fItinga_reports%2fRXX0022&rs:Format=pdf\" -O \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\RXX0022.PDF\"' , .t. , \"D:\\TOTVS 12\\Microsiga\\protheus_data\\RELINWEB\\wget\\\" )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n//Grupo de Faturamento Whatsapp\r\n//{\"root\":[{\"id\":\"5527995295180-1587589523@g.us\",\"descricao\":\"Q-Liberação Compras\"},{\"id\":\"5527995295180-1587589430@g.us\",\"descricao\":\"Q-Liberação Faturamento\"}]}\r\n\r\n\r\n/*\r\nOficial\r\n*/\r\n//cProt := U_SWENARWAP(\"5551997331669\",  \"Aprovação Ped. de Compras:\" +AllTrim(SC7->C7_NUM) + \" Usuário:\" + SUBSTR(CUSUARIO,7,15)  ,\"PC:\" +AllTrim(SC7->C7_NUM) ,\"RXX0022\"           ,\"PDF\",\"\\RELINWEB\\RXX0022.pdf\")\r\n\r\n/*\r\nTeste\r\n*/\r\n   \r\nIf cOpcao == \"1\" \r\n\tcProt := U_SWENARWAP(\"5527995295180-1587589523@g.us\", \"(Nível 1) Aprovação Ped. de Compras:\" +AllTrim(SC7->C7_NUM) + \" Usuário:\" + SUBSTR(CUSUARIO,7,15)     ,\"PC:\" +AllTrim(SC7->C7_NUM)   ,\"RXX0022\"           ,\"PDF\",\"\\RELINWEB\\RXX0022.pdf\")                     \r\nElse\r\n\tcProt := U_SWENARWAP(\"5527995295180-1594316108@g.us\", \"(Nível 2) Aprovação sem o nível 1.  Aprovação Ped. de Compras:\" +AllTrim(SC7->C7_NUM) + \" Usuário:\" + SUBSTR(CUSUARIO,7,15)     ,\"PC:\" +AllTrim(SC7->C7_NUM)   ,\"RXX0022\"           ,\"PDF\",\"\\RELINWEB\\RXX0022.pdf\")\r\nEndIf\r\n        \r\n                  \r\nIF cProt = \"\" .or. cProt = nil \r\n\tAlert(\"ERRO!!! O WhatsApp pode estar passando por alguma instabilidade no momento. Aguarde alguns instantes de tente novamente mais tarde!\")\r\n\tReturn()\r\nEndIf                 \r\n                      \r\nIf  RecLock(\"WAM\",.T.) \r\n\r\n\tReplace WAM_FILIAL  With \"\" \r\n\tReplace WAM_DATA    With Date()\r\n\tReplace WAM_HORA    With Time()\r\n\tReplace WAM_ID      With cProt\r\n\tReplace WAM_MSG     With \"Aprovação Pedido de Compras:\" +AllTrim(SC7->C7_NUM) + \"Usuário:\" + SUBSTR(CUSUARIO,7,15) + \" Fornecedor:\" + AllTrim(SC7->C7_NOMEFOR)\r\n\t//Replace WAM_TELL    With \"5551997331669\"\r\n\t//Replace WAM_TELL    With \"5533984022125\"\r\n\tReplace WAM_INDEX   With SC7->C7_FILIAL + SC7->C7_NUM\r\n\tReplace WAM_PERG    With \"S\"\r\n\tReplace WAM_NIVEL   With cOpcao\r\n\t//Replace WAM_DATAR   With \"\"\r\n\t//Replace WAM_HORAR   With \"\"\r\n\t//Replace WAM_RESPOSV With \"\"\r\n\t\r\n\tIF SubString(CNUMEMP,1,2) == \"05\"\r\n\t\tReplace WAM_EXEC    With 'ITINGA-PC'\r\n\tElse\r\n\t\tReplace WAM_EXEC    With 'QUALITA-PC'\r\n\tEndIf\r\n\t\r\n   MsUnLock()\r\nEndIf\r\n\r\n\r\n/*\r\nUPDATE NA SC8 ENVIANDO PARA APROVAÇÃO NO WHATSAPP\r\n*/\r\ncQuery := \" UPDATE \" + RetSqlName(\"SC7\")  \r\ncQuery += \"    SET C7_LIBZAP = 'S'\r\ncQuery += \"  FROM \" + RetSqlName(\"SC7\")\r\ncQuery += \"  WHERE D_E_L_E_T_ <> '*'\r\ncQuery += \"    AND C7_NUM = '\"+SC7->C7_NUM+\"'\r\n\t\t\t\r\nTcSQLExec(cQuery)\r\n\r\nAlert(\"WhatsApp enviado com sucesso! \" + cProt)\r\n\r\nReturn()\r\n\r\nUser Function ImpPc(nTipo)\r\n/******************************************************************************************************************************************************************\r\n* criação da tab temp do pedido de venda\r\n*\r\n****/\r\n\r\nLocal cQuery    := \"\"\r\nLocal cAprov    := \"\"\r\n\r\n\t\r\n**************************\r\n**************************\r\n***     BRUNO LAGE    ****\r\n**************************\r\n**************************    \r\n\r\ncTabela   := \"TB_RXX22\"\r\n\r\nIf TcCanOpen(cTabela)  \r\n   lOk := TcDelFile(cTabela)   \r\nElse  \r\n\tMsgInfo(\"Talbela \"+cTabela+\" nao encontrada.\")\r\nEndif\r\n\r\ncQuery := \"SELECT CR_APROV FROM \" +RetSQLName(\"SCR\")+\" WHERE D_E_L_E_T_ = '' AND CR_NUM = '\"+ AllTrim(SC7->C7_NUM) +\"' AND CR_FILIAL = '\"+ AllTrim(SC7->C7_FILIAL) +\"'\"\r\n\r\nTcQuery cQuery Alias TMPAPRO New\r\n\t\t\r\ndbSelectArea(\"TMPAPRO\")     \r\ndbGoTop()\r\n\t\r\ncAprov := UPPER(UsrFullName(  TMPAPRO->CR_APROV  ))\r\n\r\ndbSelectArea(\"TMPAPRO\")\r\ndbCloseArea()\r\n\r\n/*\r\nAprovação via WhatsApp\r\n*/\r\nIf cAprov == \"\" .And. SubString(CNUMEMP,1,2) == \"01\"\r\n\t\r\n\tcQuery := \" SELECT * \r\n\tcQuery += \"  FROM WAM010\r\n\tcQuery += \"  WHERE D_E_L_E_T_ = ''\r\n\tcQuery += \"    AND WAM_EXEC = 'QUALITA-PC'\r\n\tcQuery += \"\tAND WAM_PERG = 'N'\r\n\tcQuery += \"\tAND WAM_DATAR <>''\r\n\tcQuery += \"    AND WAM_INDEX = '\" + AllTrim(SC7->C7_FILIAL)+AllTrim(SC7->C7_NUM) +\"'\"\r\n\t\r\n\tTcQuery cQuery Alias TMPAPRO New\r\n\t\r\n\tdbSelectArea(\"TMPAPRO\")     \r\n\tdbGoTop()\r\n\tIf !EOF()\t\r\n\t\tcAprov := \"LIBERADO VIA WHATSAPP\"\r\n\tEndIf\r\n\t\r\n\tdbSelectArea(\"TMPAPRO\")\r\n\tdbCloseArea()\r\n\t\r\nEndIf\r\n\r\n  \t \r\ncQuery := \" SELECT \t\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_NOMECOM)) + \"' AS EMPRESA,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_CGC))     + \"' AS CPNJ,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_TEL))     + \"' AS TEL,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_ENDCOB))  + \"' AS ENDEREC,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_ESTCOB))  + \"' AS ESTADO,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_CIDCOB))  + \"' AS CIDADE,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_CEPCOB))  + \"' AS CEP_COB,\r\n\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_ENDENT))  + \"' AS ENDEREC_ENT,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_ESTENT))  + \"' AS ESTADO_ENT,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_CIDENT))  + \"' AS CIDADE_ENT,\r\ncQuery += \" \t\t'\" + UPPER(ALLTRIM(SM0->M0_CEPENT))  + \"' AS CEP_ENT,\r\n\r\ncQuery += \" \t\t'\" + UPPER(UsrFullName(SC7->C7_USER)) + \"' AS COMPRADOR,\r\n\r\nIf SubString(CNUMEMP,1,2) == \"01\"\r\n\tcQuery += \"\t\t\t'\" + \"Diego Sirtori\" +\"' APROVADOR,\r\nElse\r\n\tcQuery += \"\t\t\t'\" + IIF(EMPTY(cAprov),UPPER(\"Airton Novais dos Santos\"),cAprov) +\"' APROVADOR,\r\nEndIf\r\n\r\ncQuery += \"  \t\tC7_NUMSC  SOLICITACAO,\r\ncQuery += \"\t\t\tC7_ITEMSC ITEM_SOLICITACAO,\r\n\r\ncQuery += \"         '\" + SubString(CNUMEMP,1,2) + \"' AS ID_EMPRESA,\"\r\n\r\nIf SubString(CNUMEMP,1,2) == \"01\"\r\n\tcQuery += \"\t\t\t(\t\r\n\tcQuery += \"\t\t\tCASE\r\n\tcQuery += \"\t\t\t\t\t\t\tWHEN (SELECT C1_XTIPO FROM \" +RetSQLName(\"SC1\")+ \" WHERE D_E_L_E_T_ = '' AND C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC) = ''   THEN '-' \r\n\tcQuery += \"\t\t\t\t\t\t\tWHEN (SELECT C1_XTIPO FROM \" +RetSQLName(\"SC1\")+ \" WHERE D_E_L_E_T_ = '' AND C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC) = '01' THEN '01-MAQUINA PARADA' \r\n\tcQuery += \"\t\t\t\t\t\t\tWHEN (SELECT C1_XTIPO FROM \" +RetSQLName(\"SC1\")+ \" WHERE D_E_L_E_T_ = '' AND C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC) = '02' THEN '02-REQUER ATENCAO' \r\n\tcQuery += \"\t\t\t\t\t\t\tWHEN (SELECT C1_XTIPO FROM \" +RetSQLName(\"SC1\")+ \" WHERE D_E_L_E_T_ = '' AND C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC) = '03' THEN '03-COMPRA NORMAL' \r\n\tcQuery += \"\t\t\tEND\r\n\tcQuery += \"\t\t\t) STATUS  ,\r\nElse\r\n\tcQuery += \"     '03-COMPRA NORMAL' STATUS  ,\r\nEndIf \r\n\r\ncQuery += \"\t\t\t(SELECT CAST(C1_EMISSAO AS DATE) FROM \" +RetSQLName(\"SC1\")+ \" WHERE D_E_L_E_T_ = '' AND C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC) DT_EMISSAO_SC, \r\ncQuery += \"\t\t\t(SELECT CAST(C1_DATPRF  AS DATE) FROM \" +RetSQLName(\"SC1\")+ \" WHERE D_E_L_E_T_ = '' AND C1_FILIAL = C7_FILIAL AND C1_NUM = C7_NUMSC AND C1_ITEM = C7_ITEMSC) DT_NECESSIDADE, \r\ncQuery += \"\t\t\tC7_NUMCOT COTACAO,\r\ncQuery += \"\t\t\t(SELECT DISTINCT CAST(C8_EMISSAO AS DATE) FROM \" +RetSQLName(\"SC8\")+ \" WHERE D_E_L_E_T_ = '' AND C8_FILIAL = C7_FILIAL AND C8_NUM = C7_NUMCOT AND C8_ITEM = C7_ITEMSC) DT_COTACAO, \r\ncQuery += \"\t\t\tC7_NUM PEDIDO,\r\ncQuery += \"\t\t\tCAST(C7_EMISSAO AS DATE) DT_PEDIDO,\r\ncQuery += \"\t\t\tC7_ITEM,\r\ncQuery += \"\t\t\tC7_PRODUTO,\r\ncQuery += \"\t\t\tRTRIM(LTRIM(C7_DESCRI)) C7_DESCRI,\r\ncQuery += \"\t\t\tC7_UM,\r\ncQuery += \"\t\t\tC7_QUANT,\r\ncQuery += \"\t\t\tC7_PRECO,\r\ncQuery += \"\t\t\tC7_TOTAL,\r\ncQuery += \"\t\t\tCAST(C7_DATPRF AS DATE)  PREVISAO_ENTREGA,\r\nIf SubString(CNUMEMP,1,2) == \"01\"\r\n\tcQuery += \"\t\t\tRTRIM(LTRIM(C7_OBSM)) OBS,\r\nElse\r\n\tcQuery += \"\t\t\tRTRIM(LTRIM(ISNULL(CONVERT(VARCHAR(2047), CONVERT(VARBINARY(2047), C7_OBS)),'') )) OBS,\r\nEndIf\r\ncQuery += \"\t\t\tC7_FORNECE,\r\ncQuery += \"\t\t\tSA2.A2_NOME DESCRI_FORN,\r\ncQuery += \"\t\t\tSA2.A2_END ENDERECO,\r\ncQuery += \"\t\t\tSA2.A2_EST UF,\r\ncQuery += \"\t\t\tSA2.A2_MUN MUNICIPIO,\r\ncQuery += \"\t\t\tSA2.A2_BAIRRO BAIRRO,\r\ncQuery += \"\t\t\tA2_CEP CEP,\r\ncQuery += \"\t\t\tSA2.A2_CGC CNPJ,\r\ncQuery += \"\t\t\tSA2.A2_INSCR INSCRICAO,\r\ncQuery += \"\t\t\t(RTRIM(LTRIM(SA2.A2_DDD))+''+RTRIM(LTRIM(SA2.A2_TEL))) TELEFONE,\r\ncQuery += \"\t\t\tC7_VLDESC,\r\ncQuery += \"\t\t\tC7_LOJA,\r\ncQuery += \"\t\t\tC7_CC,\r\ncQuery += \"\t\t\tC7_COND,\r\ncQuery += \"\t\t\t(SELECT RTRIM(LTRIM(E4_DESCRI)) FROM \" +RetSQLName(\"SE4\")+ \" WHERE D_E_L_E_T_ = '' AND E4_CODIGO =  C7_COND ) E4_DESCRI,\r\ncQuery += \"\t\t\tIIF(C7_MOEDA =1,'REAL',IIF(C7_MOEDA=2,'DOLAR','EURO')) C7_MOEDA,\r\ncQuery += \"\t\t\tC7_VALICM,\r\ncQuery += \"\t\t\tC7_BASEICM,\r\ncQuery += \"\t\t\tC7_ICMSRET,\r\ncQuery += \"\t\t\tC7_VALFRE,\r\ncQuery += \"\t\t\tC7_VALEMB,\r\ncQuery += \"\t\t\tC7_VALIPI,\r\ncQuery += \"\t\t\tC7_DESC1 DESC1,\r\ncQuery += \"\t\t\tC7_DESC2 DESC2,\r\ncQuery += \"\t\t\tC7_DESC3 DESC3,\r\ncQuery += \"\t\t\tC7_FRETE VLRFRETE,\r\ncQuery += \"\t\t\tC7_DESPESA DESPESA,\r\ncQuery += \"\t\t\tC7_SEGURO SEGURO\r\n \r\ncQuery += \" INTO TB_RXX22\r\n\r\ncQuery += \" FROM \" +RetSQLName(\"SC7\")+ \" SC7\r\ncQuery += \"\t  INNER JOIN \" +RetSQLName(\"SA2\")+ \" SA2 ON\r\ncQuery += \"\t  ((SA2.A2_COD+SA2.A2_LOJA) = (SC7.C7_FORNECE+SC7.C7_LOJA)) \r\ncQuery += \"\t  AND C7_NUM    = '\" + AllTrim(SC7->C7_NUM)    + \"'\r\ncQuery += \"\t  AND C7_FILIAL = '\" + AllTrim(SC7->C7_FILIAL) + \"'\r\ncQuery += \"\t  AND SC7.D_E_L_E_T_=''\r\ncQuery += \"\t  AND SA2.D_E_L_E_T_=''\r\ncQuery += \" ORDER BY C7_ITEM\r\n\r\nTcSQLExec(cQuery)\r\n\r\n/*\r\nSHOW DO RELATORIO\r\n*/\r\nIf nTipo == 1\r\n\tIf SubString(CNUMEMP,1,2) == \"01\"\r\n\t\tu_RelInWeb(\"RXX0022\")\r\n\tElse\r\n\t\tu_RelInWeb(\"RXX0022_I\")\r\n\tEndIf\r\nEndIf\r\n\r\nReturn()\r\n"}}}
Content-Length: 149
{"jsonrpc":"2.0","id":19,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 147
{"jsonrpc":"2.0","id":20,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 154
{"jsonrpc":"2.0","id":21,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":22,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 149
{"jsonrpc":"2.0","id":23,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 147
{"jsonrpc":"2.0","id":24,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 154
{"jsonrpc":"2.0","id":25,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":26,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 76
{"jsonrpc":"2.0","method":"$/setTraceNotification","params":{"value":"off"}}
Content-Length: 1235
{"jsonrpc":"2.0","id":27,"method":"$totvsserver/compilation","params":{"compilationInfo":{"connectionToken":"djM6djF5aTBwNzQ4bm1ranViaXNrbGl4aW93NXFneDQ6MToxOTIuMTY4LjEuMTAzOjEyMzY6MDo3LjAwLjE5MTIwNVA6Mw==:djE6Y29tcGlsYV9xOkFkbWluOjNBQWx5ZERjZ1poWERxUzR2SWNIY2NxV1ZQdzJBM2E3Mm1aQTVuUFptRlU9|djI6MTY1MjE3ODQ3NzowOjE6MQ==.Wt0h7Xec5EOTugGUcUBmYWiFZElbYGoLYeKv4JmRoWZgtEYJieBHqTpG8w9rEMCDdix009KMk6joxEUA/EuMM9mjyoX2Fd3eDsrjPFuGNvuO46YjSiIfktxSgwYWPzbnOs3daEMO4/TH9ZQEc5Sz6QpaaCJNiKwIjEfzUhDQIuauwGib7ZDokVBfNXuTPxbv3CCB7K6baB9/MaxLjFocfMtCrER3UA6/vs/GIeC4aIH6A2WqRBmJCauDImrrOwQtrbeqREniKY8sSYmTF7FuXiTatf9SXLUbq5LzKvyCPEbeJalBV+RzwrmqOT7ep3eLVAcv91CzqPIB0zvg6E+ODg==","environment":"compila_q","includeUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/include"],"fileUris":["file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/10_LIB/RelInWeb.prw"],"compileOptions":{"recompile":true,"debugAphInfo":true,"gradualSending":true,"generatePpoFile":false,"showPreCompiler":false,"priorVelocity":true,"returnPpo":false,"commitWithErrorOrWarning":false},"extensionsAllowed":[".PRW",".PRX",".PRG",".PPX",".PPP",".TLPP",".APW",".APH",".APL",".AHU",".TRES",".PNG",".BMP",".RES",".4GL",".PER",".JS",".RPTDESIGN"],"includeUrisRequired":true}}}
Content-Length: 239
{"jsonrpc":"2.0","id":28,"method":"textDocument/completion","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/10_LIB/RelInWeb.prw"},"position":{"line":53,"character":34},"context":{"triggerKind":1}}}
Content-Length: 149
{"jsonrpc":"2.0","id":29,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 147
{"jsonrpc":"2.0","id":30,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 154
{"jsonrpc":"2.0","id":31,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":32,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 149
{"jsonrpc":"2.0","id":33,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 147
{"jsonrpc":"2.0","id":34,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 154
{"jsonrpc":"2.0","id":35,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":36,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 76
{"jsonrpc":"2.0","method":"$/setTraceNotification","params":{"value":"off"}}
