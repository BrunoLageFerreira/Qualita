Content-Length: 3121
{"jsonrpc":"2.0","id":0,"method":"initialize","params":{"processId":2068,"clientInfo":{"name":"vscode","version":"1.70.0"},"rootPath":"d:\\TOTVS 12\\Microsiga\\Protheus\\ProjetoVSCode","rootUri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","capabilities":{"workspace":{"applyEdit":true,"workspaceEdit":{"documentChanges":true,"resourceOperations":["create","rename","delete"],"failureHandling":"textOnlyTransactional"},"didChangeConfiguration":{"dynamicRegistration":true},"didChangeWatchedFiles":{"dynamicRegistration":true},"symbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]}},"executeCommand":{"dynamicRegistration":true},"configuration":true,"workspaceFolders":true},"textDocument":{"publishDiagnostics":{"relatedInformation":true,"versionSupport":false,"tagSupport":{"valueSet":[1,2]}},"synchronization":{"dynamicRegistration":true,"willSave":true,"willSaveWaitUntil":true,"didSave":true},"completion":{"dynamicRegistration":true,"contextSupport":true,"completionItem":{"snippetSupport":true,"commitCharactersSupport":true,"documentationFormat":["markdown","plaintext"],"deprecatedSupport":true,"preselectSupport":true,"tagSupport":{"valueSet":[1]}},"completionItemKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25]}},"hover":{"dynamicRegistration":true,"contentFormat":["markdown","plaintext"]},"signatureHelp":{"dynamicRegistration":true,"signatureInformation":{"documentationFormat":["markdown","plaintext"],"parameterInformation":{"labelOffsetSupport":true}},"contextSupport":true},"definition":{"dynamicRegistration":true,"linkSupport":true},"references":{"dynamicRegistration":true},"documentHighlight":{"dynamicRegistration":true},"documentSymbol":{"dynamicRegistration":true,"symbolKind":{"valueSet":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},"hierarchicalDocumentSymbolSupport":true},"codeAction":{"dynamicRegistration":true,"isPreferredSupport":true,"codeActionLiteralSupport":{"codeActionKind":{"valueSet":["","quickfix","refactor","refactor.extract","refactor.inline","refactor.rewrite","source","source.organizeImports"]}}},"codeLens":{"dynamicRegistration":true},"formatting":{"dynamicRegistration":true},"rangeFormatting":{"dynamicRegistration":true},"onTypeFormatting":{"dynamicRegistration":true},"rename":{"dynamicRegistration":true,"prepareSupport":true},"documentLink":{"dynamicRegistration":true,"tooltipSupport":true},"typeDefinition":{"dynamicRegistration":true,"linkSupport":true},"implementation":{"dynamicRegistration":true,"linkSupport":true},"colorProvider":{"dynamicRegistration":true},"foldingRange":{"dynamicRegistration":true,"rangeLimit":5000,"lineFoldingOnly":true},"declaration":{"dynamicRegistration":true,"linkSupport":true},"selectionRange":{"dynamicRegistration":true}},"window":{"workDoneProgress":true}},"initializationOptions":{"launchArgs":["--log-file=totvsls.log","--record=totvsls"]},"trace":"off","workspaceFolders":[{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode","name":"ProjetoVSCode"}]}}
Content-Length: 52
{"jsonrpc":"2.0","method":"initialized","params":{}}
Content-Length: 15227
{"jsonrpc":"2.0","method":"textDocument/didOpen","params":{"textDocument":{"uri":"file:///d%3A/TOTVS%2012/Microsiga/Protheus/ProjetoVSCode/07_FINANCEIRO/F060ACT.PRW","languageId":"advpl","version":1,"text":"#INCLUDE \"rwmake.ch\"\r\n#INCLUDE \"protheus.ch\"\r\n#INCLUDE \"TOPCONN.CH\"\r\n\r\n/*                                          \r\nPrograma ...: F060ACT.Prw\r\nUso ........: Apos gravação dos dados da transferencia\r\nData .......: 07/04/20\r\nFeito por ..: Bruno Lage Ferreira.\r\n*/\r\n\r\n\r\nUser Function SACI008()\r\n/****************************************************************************************************\r\n* //\r\n*\r\n****/      \r\nLocal lRet      := .T.\r\n\r\nIf SubString(CNUMEMP,1,2) == \"01\" \r\n\r\n\t/*\r\n\tIF  RecLock(\"SE1\",.F.)\r\n\t\t\tSE1->E1_XUSUTRA := SUBSTR(CUSUARIO,7,15)\r\n\t\t\tSE1->E1_XDTTRAN := dDataBase\r\n\t\t\tSE1->E1_XVLRTRA := 0\r\n\t\tMsUnLock()\r\n\tEndIf\r\n\t*/\r\n\tU_fAtuSZS6()\r\n\r\nEndIf\r\n\r\nReturn(lRet)\r\n\r\nUser Function EncFina070()\r\n/****************************************************************************************************\r\n*\r\n*\r\n****/      \r\nPrivate aRecTrafBaixa := {}\r\n\r\nFINA070()\r\n\r\nReturn()\r\n\r\n\r\nUser Function FA070CHK()\r\n/****************************************************************************************************\r\n*\r\n*\r\n****/ \r\nLocal lRet := .T. \r\nIf SubString(CNUMEMP,1,2) == \"01\"\r\n\tdbSelectArea(\"ZS5\")\r\n\tdbSetorder(1)\r\n\tIf SE1->E1_MOEDA <> 1\r\n\t\tIf !dbSeek(xFilial(\"ZS5\") + SE1->E1_PREFIXO + SE1->E1_NUM + SE1->E1_PARCELA + SE1->E1_CLIENTE + SE1->E1_LOJA + SE1->E1_TIPO)\r\n\t\t\tAlert(\"Não existe transferência para este título!\")\r\n\t\t\t//lRet := .F.\r\n\t\t\t//Return(lRet)\r\n\t\tEndIf\r\n\tEndIf\r\nEndIf\r\nReturn(lRet)\r\n\r\n\r\n\r\nUser Function F070VREC()\r\n/****************************************************************************************************\r\n* valtype(aRecTrafBaixa)\r\n*\r\n****/      \r\nLocal lRet      := .T.\r\nLocal aDadosVlr\t:= PARAMIXB\r\n\r\nIf SubString(CNUMEMP,1,2) == \"01\" \r\n\tIf (SE1->E1_XVLRTRA <> 0) .And. (aDadosVlr[1] <> SE1->E1_XVLRTRA)\t\r\n\t\tlRet      := .T.\r\n\t\t//Alert(\"Valor da [transferência: \" + AllTrim(STR(SE1->E1_XVLRTRA)) + \" ] diferente do valor [Recebido :\" + AllTrim(STR(aDadosVlr[1])) + \"].\")\r\n\tEndIf\r\nEndIf\r\n\r\nReturn(lRet)\r\n\r\n\r\nUser Function F070DTRE()\r\n/****************************************************************************************************\r\n*\r\n*\r\n****/      \r\nLocal lRet := .F.\r\n\r\n//Alert(\"F070DTRE\")\r\n\r\nReturn(lRet)\r\n\r\n\r\nUser Function F060ACT()\r\n/****************************************************************************************************\r\n*\r\n*\r\n****/      \r\nLocal aDadosF060ACT\t:= PARAMIXB[1]\r\nLocal lCloseDlg     := .F.\r\n\r\n// Variaveis Locais da Funcao\r\nPRIVATE cEdit1\t := SE1->E1_CLIENTE + \"/\" + SE1->E1_LOJA + \" - \" + AllTrim(SE1->E1_NOMCLI) + \" SALDO: [\"+ ALLTRIM(STR(SE1->E1_SALDO)) +\"]\"\r\nPRIVATE cEdit2\t := SE1->E1_XVLRTRA\r\nPRIVATE cEdit3\t := SE1->E1_XDESBCA\r\n\r\nPRIVATE oEdit1\r\nPRIVATE oEdit2\r\nPRIVATE oEdit3\r\n\r\nPRIVATE aListBoxFin := {}\r\nPRIVATE oListBoxFin \r\n\r\n// Variaveis Private da Funcao\r\nPRIVATE _oDlg\t\t\t\t// Dialog Principal\r\n\r\nPRIVATE OOK\t   := LoadBitmap(GetResources(), \"LBOK\")\r\nPRIVATE ONO\t   := LoadBitmap(GetResources(), \"LBNO\")\r\n\r\n// Variaveis Private da Funcao\r\nIf SubString(CNUMEMP,1,2) == \"01\" \r\n\r\n\tIf (aDadosF060ACT[1] == '1' .Or. aDadosF060ACT[1] == 'J' ) .AND. SE1->E1_MOEDA <> 1  \r\n\t\r\n\t   \tDo While lCloseDlg == .F.\r\n\t\t\tDEFINE MSDIALOG _oDlg TITLE \"Controle Internacional de Transferências:\" FROM u_MGETTELA(333),u_MGETTELA(275) TO u_MGETTELA(734),u_MGETTELA(795) PIXEL\r\n\t\t\t\r\n\t\t\t// Cria Componentes Padroes do Sistema\r\n\t\t\t@ u_MGETTELA(006),u_MGETTELA(005) Say \"INFORMAÇÕES:\" Size u_MGETTELA(042),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlg\r\n\t\t\t@ u_MGETTELA(006),u_MGETTELA(052) MsGet oEdit1 Var cEdit1 when(.f.) Size u_MGETTELA(200),u_MGETTELA(009) COLOR CLR_BLACK PIXEL OF _oDlg\r\n\t\t\t@ u_MGETTELA(021),u_MGETTELA(006) Say \"(=) VALOR TRANSF.:\" Size u_MGETTELA(046),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlg\r\n\t\t\t@ u_MGETTELA(021),u_MGETTELA(052) MsGet oEdit2 Var cEdit2 when(.f.) Size u_MGETTELA(057),u_MGETTELA(009) picture(\"@E 999,999.99\")  COLOR CLR_BLACK PIXEL OF _oDlg\r\n\t\t\t@ u_MGETTELA(021),u_MGETTELA(114) Say \"(=) DESPES. BANQUEIRO:\" Size u_MGETTELA(055),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlg\r\n\t\t\t@ u_MGETTELA(021),u_MGETTELA(165) MsGet oEdit3 Var cEdit3 when(.f.) Size u_MGETTELA(087),u_MGETTELA(009) picture(\"@E 999,999.99\")  COLOR CLR_BLACK PIXEL OF _oDlg\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t@ u_MGETTELA(180),u_MGETTELA(050)  Button \"(+) INCLUIR\"  Size u_MGETTELA(037),u_MGETTELA(012) ACTION(FEditInf()) PIXEL OF _oDlg\r\n\t\t\t@ u_MGETTELA(180),u_MGETTELA(100) Button \"(-) DELETAR\"  Size u_MGETTELA(037),u_MGETTELA(012) ACTION(fDelete())  PIXEL OF _oDlg\r\n\t\t\t@ u_MGETTELA(180),u_MGETTELA(150) Button \"REL. SALDOS\"  Size u_MGETTELA(037),u_MGETTELA(012) ACTION(u_relinweb(\"RQ0068\",\"Relatório de Saldo\",'u_fParR68()' ) )  PIXEL OF _oDlg\r\n\r\n\t\t\t@ u_MGETTELA(180),u_MGETTELA(200) Button \"Ok\"           Size u_MGETTELA(037),u_MGETTELA(012) ACTION(FTotais(),lCloseDlg := .T. ,close(_oDlg))  PIXEL OF _oDlg\r\n\t\t\t\r\n\t\t\t@ u_MGETTELA(035),u_MGETTELA(006) ListBox oListBoxFin Fields ;\r\n\t\t\t\tHEADER \" \",\"ID\",\"DATA\",\"VALOR\",\"DESPESA\",\"SALDO\";\r\n\t\t\t\tSize u_MGETTELA(247),u_MGETTELA(140) Of _oDlg Pixel;\r\n\t\t\t\tColSizes 05,05,50,50,50,50\r\n\t\t\r\n\t\t\toListBoxFin:bLDblClick := {|| fClickMark(oListBoxFin:nAT) } \r\n\t\t\r\n\t\t\t// Chamadas das ListBox do Sistema\r\n\t\t\tfListFin1()\r\n\t\t\tFTotais()\r\n\t\r\n\t\t\tACTIVATE MSDIALOG _oDlg CENTERED \r\n\t\tEndDo\r\n\t\r\n\tElse\r\n\t\t/*\r\n\t\tIF RecLock(\"SE1\",.F.)\r\n\t\t\tSE1->E1_XUSUTRA := SUBSTR(CUSUARIO,7,15)\r\n\t\t\tSE1->E1_XDTTRAN := dDataBase\r\n\t\t\tSE1->E1_XVLRTRA := 0\r\n\t\t\tSE1->E1_XDESBCA := 0\r\n\t\t\tMsUnLock()\r\n\t\tEndIf\r\n\t\t*/\r\n\tEndIf\r\n\t\r\nEndIf\r\n\r\nReturn Nil\r\n\r\nUser Function fParR68()\r\n/*********************************************************************************************************************\r\n*  \r\n* \r\n*\r\n***/\r\nLocal cRet := \"\"\r\n\r\ncRet := \"&FILIAL=\" + SE1->E1_FILIAL + \"&NUMTITULO=\" + SE1->E1_NUM\r\n\r\nReturn(cRet)\r\n\r\n\r\nStatic Function fClickMark(nLinha)\r\n/*********************************************************************************************************************\r\n*  \r\n* \r\n*\r\n***/\r\nLocal _NI := 0\r\n\r\nFor _NI := 1 To Len(aListBoxFin)\r\n\tIf _NI == nLinha\r\n\t\taListBoxFin[_NI][1] := iif(aListBoxFin[_NI][1]==ONO,OOK,ONO)\r\n\t/*Else\r\n\t\taListBoxFin[_NI][1] := ONO*/\r\n\tEndIf\r\nNext\r\n\r\noListBoxFin:REFRESH()\r\n\r\nReturn()\r\n\r\n\r\nStatic Function fDelete()\r\n/*********************************************************************************************************************\r\n*  \r\n* \r\n*\r\n***/\r\nLocal _NI := 0\r\n\r\nFor _NI := 1 To Len(aListBoxFin)\r\n\tIf aListBoxFin[_NI][1] == OOK\r\n\t\r\n\t\tdbSelectArea(\"ZS5\")\r\n\t\tdbGoTo(aListBoxFin[_NI][2])\r\n\t\tIf Empty(ZS5_DBAIXA)\r\n\t\t\tIF RecLock(\"ZS5\",.f.)\r\n\t\t\t\tdbDelete()\r\n\t\t\t\tMsUnLock()\r\n\t\t\tEndIf\r\n\t\tElse\r\n\t\t\tAlert(\"Este título já sofreu baixas!\")\r\n\t\tEndIf\r\n\r\n\tEndIf\r\nNext\r\n\r\nfListFin1()\r\nFTotais()\r\n\r\nReturn()\r\n\r\nStatic Function FTotais() \r\n****************************************************************************************************************\r\n*    \r\n*\r\n****\r\nLocal nTotalTranf := 0\r\nLocal nTotalDesp  := 0\r\nLocal dUltData    \r\nLocal nX          := 0\r\n\r\nFor nX:=1 to  Len(aListBoxFin)\r\n\tnTotalTranf := nTotalTranf + aListBoxFin[nX][6]\r\n\tnTotalDesp  := nTotalDesp  + aListBoxFin[nX][5]\r\n\tdUltData    := Iif(aListBoxFin[nX][3]>dUltData,aListBoxFin[nX][3],dUltData)\r\nNext nX\r\n\r\nIF RecLock(\"SE1\",.F.)\r\n\tSE1->E1_XUSUTRA := SUBSTR(CUSUARIO,7,15)\r\n\tSE1->E1_XDTTRAN := dUltData\r\n\tSE1->E1_XVLRTRA := nTotalTranf\r\n\tSE1->E1_XDESBCA := nTotalDesp\r\n\tMsUnLock()\r\nEndIf\r\n\r\ncEdit2 := nTotalTranf\r\ncEdit3 := nTotalDesp\r\n\r\noEdit2:Refresh()\r\noEdit3:Refresh()\r\n\r\nIf nTotalTranf > SE1->E1_VALOR \r\n\tAlert(\"Total transferido maior que total da invoice. Verifique!\")\r\nEndIf \r\n\r\nReturn()\r\n\r\n\r\nStatic Function FEditInf() \r\n****************************************************************************************************************\r\n*    \r\n*\r\n****\r\nLocal nEdit11\t := dDataBase\r\nLocal oEdit11\r\n\r\nLocal nEdit21\t := SE1->E1_SALDO\r\nLocal oEdit21\r\n\r\nLocal nEdit31\t := 0\r\nLocal oEdit31\r\n\r\nLocal nEdit41\t := 0\r\nLocal oEdit41\r\n\r\nLocal lNExec     := .F.\r\nLocal lNDele     := .F.\r\n\r\nLocal aAreaSE1   := GetArea()\r\n\r\n// Variaveis Private da Funcao\r\nPrivate _oDlgVlr\t\t\t\t// Dialog Principal\r\n\r\n\r\ndbSelectArea(\"SE1\")\r\ndbSetorder(2)\r\niF dbSeek(SE1->E1_FILIAL+ SE1->E1_CLIENTE+ SE1->E1_LOJA+ SE1->E1_PREFIXO+ SE1->E1_NUM+ SE1->E1_PARCELA+ \"AB-\")\r\n\tAlert(\"Encontrado título de abatimento! Valor:\" + AllTrim(Str(SE1->E1_SALDO)) )\r\n\tnEdit21\t := nEdit21 - SE1->E1_SALDO\r\nEndIf\r\n\r\ndbSelectArea(\"SE1\")\r\nRestArea(aAreaSE1)\r\n\r\n// Variaveis que definem a Acao do Formulario                    \r\nDEFINE MSDIALOG _oDlgVlr TITLE \"INCLUIR...\"    FROM u_MGETTELA(223),u_MGETTELA(173) TO u_MGETTELA(359),u_MGETTELA(520) PIXEL\r\n\r\n\t// Cria as Groups do Sistema\r\n\t@ u_MGETTELA(003),u_MGETTELA(005) TO u_MGETTELA(044),u_MGETTELA(168) LABEL \"\" PIXEL OF _oDlgVlr\r\n\r\n\t// Cria Componentes Padroes do Sistema\r\n\t@ u_MGETTELA(010),u_MGETTELA(008) Say \"Data:\" Size u_MGETTELA(066),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t@ u_MGETTELA(010),u_MGETTELA(050) MsGet oEdit11 Var nEdit11            Size u_MGETTELA(35)  ,u_MGETTELA(009)  COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t\r\n\t@ u_MGETTELA(010),u_MGETTELA(085) Say \"Valor:\" Size u_MGETTELA(066),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t@ u_MGETTELA(010),u_MGETTELA(130) MsGet oEdit21 Var nEdit21            Size u_MGETTELA(35) ,u_MGETTELA(009)  picture(\"@E 999,999.99\") COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t\r\n\t@ u_MGETTELA(028),u_MGETTELA(008) Say \"Despesa:\" Size u_MGETTELA(066),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t@ u_MGETTELA(028),u_MGETTELA(050) MsGet oEdit31 Var nEdit31            Size u_MGETTELA(35) ,u_MGETTELA(009) picture(\"@E 999,999.99\") COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t\r\n\t//@ u_MGETTELA(028),u_MGETTELA(085) Say \"Desconto: {Vlr}\" Size u_MGETTELA(066),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t//@ u_MGETTELA(028),u_MGETTELA(130) MsGet oEdit4 Var nEdit4            Size u_MGETTELA(35) ,u_MGETTELA(009) picture(\"@E 9999.99\") COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\t\r\n\t@ u_MGETTELA(047),u_MGETTELA(131) Button \"Ok\" \t\tSize u_MGETTELA(037),u_MGETTELA(012)  ACTION( lNExec := .T. , Close(_oDlgVlr))  PIXEL OF _oDlgVlr\r\n\t//@ u_MGETTELA(047),u_MGETTELA(085) Button \"Deletar\" \tSize u_MGETTELA(037),u_MGETTELA(012)  ACTION( lNDele := .T. , Close(_oDlgVlr))  PIXEL OF _oDlgVlr\r\n\t\r\n\t//@ u_MGETTELA(050),u_MGETTELA(007) Say \"O valor irá subistituir todas as chapas do cavalete! \"  Size u_MGETTELA(113),u_MGETTELA(008) COLOR CLR_BLACK PIXEL OF _oDlgVlr\r\n\r\nACTIVATE MSDIALOG _oDlgVlr CENTERED\r\n\r\n\r\nIF lNExec = .T.\r\n\r\n\t\tIF RecLock(\"ZS5\",.T.)\r\n\t\t\tZS5->ZS5_FILIAL := SE1->E1_FILIAL\r\n\t\t\tZS5->ZS5_PREFIX := SE1->E1_PREFIXO\r\n\t\t\tZS5->ZS5_NUM    := SE1->E1_NUM\r\n\t\t\tZS5->ZS5_PAR    := SE1->E1_PARCELA\r\n\t\t\tZS5->ZS5_TIPO   := SE1->E1_TIPO\r\n\t\t\tZS5->ZS5_CLIENT := SE1->E1_CLIENTE\r\n\t\t\tZS5->ZS5_LOJA   := SE1->E1_LOJA \r\n\t\t\tZS5->ZS5_DTRANS := nEdit11\r\n\t\t\tZS5->ZS5_VLR    := nEdit21\r\n\t\t\tZS5->ZS5_DESPE  := nEdit31\r\n\t\t\tMsUnLock()\r\n\t\tEndIf\r\n\t\t\r\n\t\tfListFin1()\r\n\t\tFTotais()\r\nEndIf\r\n\r\n\r\nReturn()\r\n\r\n\r\nStatic Function fListFin1()\r\n/*****************************************************************************************************************\r\n* //\r\n* //\r\n* \r\n*****/\r\nLocal cQuery      := \"\"\r\n\r\naListBoxFin := {}\r\n\r\ncQuery := \" SELECT R_E_C_N_O_ RECNO, \r\ncQuery += \" \t   ZS5_FILIAL      ,\r\ncQuery += \" \t   ZS5_PREFIX      ,\r\ncQuery += \" \t   ZS5_NUM         ,\r\ncQuery += \" \t   ZS5_PAR         ,\r\ncQuery += \" \t   ZS5_TIPO        ,\r\ncQuery += \" \t   ZS5_CLIENT      ,\r\ncQuery += \" \t   ZS5_LOJA        ,\r\ncQuery += \" \t   ZS5_DTRANS      ,\r\ncQuery += \" \t   ZS5_VLR         ,\r\ncQuery += \" \t   ZS5_DESPE \t   ,\r\ncQuery += \" \t   ZS5_VLRBX \t   \r\ncQuery += \"   FROM \" + RetSqlName(\"ZS5\") + \" SZ5 \r\ncQuery += \"  WHERE ZS5_FILIAL    = '\"+ SE1->E1_FILIAL  +\"' \r\ncQuery += \"    AND ZS5_PREFIX    = '\"+ SE1->E1_PREFIXO +\"' \r\ncQuery += \"    AND ZS5_NUM       = '\"+ SE1->E1_NUM     +\"'\r\ncQuery += \"    AND ZS5_PAR       = '\"+ SE1->E1_PARCELA+\"'\r\ncQuery += \"    AND ZS5_TIPO      = '\"+ SE1->E1_TIPO    +\"'\r\ncQuery += \"    AND ZS5_CLIENT    = '\"+ SE1->E1_CLIENTE +\"'\r\ncQuery += \"    AND ZS5_LOJA      = '\"+ SE1->E1_LOJA    +\"'\r\ncQuery += \"    AND D_E_L_E_T_ = '' \r\n\r\nTcQuery cQuery Alias TMP_FIM New\r\ndbSelectArea(\"TMP_FIM\")\r\n\r\n\tdbSelectArea(\"TMP_FIM\")\r\n\tDo While !EOF()\r\n\t\t\t\r\n\t\tAadd(aListBoxFin,{\tONO\t\t\t\t\t\t\t\t\t\t\t\t\t\t,;\r\n\t\t\t\t\t\t\tTMP_FIM->RECNO           \t\t\t\t\t\t\t\t,;\r\n\t\t\t\t\t\t\tStoD(TMP_FIM->ZS5_DTRANS)\t\t\t\t\t\t\t\t,;\r\n\t\t\t\t\t\t\tTMP_FIM->ZS5_VLR         \t\t\t\t\t\t\t\t,;\r\n\t\t\t\t\t\t\tTMP_FIM->ZS5_DESPE       \t\t\t\t\t\t\t\t,;\r\n\t\t\t\t\t\t\tTMP_FIM->ZS5_VLR - TMP_FIM->ZS5_VLRBX      \t\t\t\t;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\r\n\t\tdbSelectArea(\"TMP_FIM\")\r\n\t\tdbSkip()\r\n\tEndDo\r\n\t\r\n\tif Empty(aListBoxFin)\r\n\t\tAadd(aListBoxFin,{\t\tONO,;\r\n\t\t\t\t\t\t\t\t0,;\r\n\t\t\t\t\t\t\t\tStoD(\"\"),;\r\n\t\t\t\t\t\t\t\t0,;\r\n\t\t\t\t\t\t\t\t0,;\r\n\t\t\t\t\t\t\t\t0;\r\n\t\t\t\t\t\t\t\t})\r\n\tEndIf \r\n\r\n\toListBoxFin:SetArray(aListBoxFin)\r\n\t\r\n\toListBoxFin:bLine := {|| {;\r\n\t\t\t\t\taListBoxFin[oListBoxFin:nAT,01],;\r\n\t\t\t\t\taListBoxFin[oListBoxFin:nAT,02],;\r\n\t\t\t\t\taListBoxFin[oListBoxFin:nAT,03],;\r\n\t\t\t\t\taListBoxFin[oListBoxFin:nAT,04],;\r\n\t\t\t\t\taListBoxFin[oListBoxFin:nAT,05],;\r\n\t\t\t\t\taListBoxFin[oListBoxFin:nAT,06]}}\r\n\r\noListBoxFin:REFRESH()\r\n\r\ndbSelectArea(\"TMP_FIM\")\r\ndbCloseArea()\r\n\r\nReturn()\r\n\r\n\r\nStatic Function fGravTransf(nVlrTransf,nVlrDesp)\r\n***********************************************************************************\r\n*\r\n*\r\n***\r\nIF RecLock(\"SE1\",.F.)\r\n\t\tSE1->E1_XUSUTRA := SUBSTR(CUSUARIO,7,15)\r\n\t\tSE1->E1_XDTTRAN := dDataBase\r\n\t\tSE1->E1_XVLRTRA := nVlrTransf\r\n\t\tSE1->E1_XDESBCA := nVlrDesp\r\n\tMsUnLock()\r\nEndIf\r\n\r\nAVISO(\"Tranferência\", \"Transferência gravada com sucesso!\", { \"Fechar\" }, 1)\r\nClose(_oDlg)\r\n\r\nReturn()\r\n"}}}
Content-Length: 703
{"jsonrpc":"2.0","id":1,"method":"$totvsserver/reconnect","params":{"reconnectInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNDM4NTYwNzowOjE6MQ==.r+4kKJmf4ejXIDNY5DApuAqCW1wYyEm5bYsjESI+F7niYGSV2cimeEM80abiBPJMoHkwJuIlqEUb0IU4B5XRvSUHg5iOFia6MkOKqlnfGgMg4tLRvVhdNVQNQ895gRanQbHcWZDIlq7PWPpGWW+KBGyUXdd5rAaG2njN3qDcLDO0oED9SzFyso8ItybozuaFPXK8HJZic/RR1WocIncF6Rx7DKoosi/A6U/cMssxRjHMGRIgXw9h5TqgOhnSSd/wF2aNLC/pwSxxKb3uYiUEQueJgg/6kRs6IK0PZInJwHKbqLW6BDljLSfRiHNTqOCCeXOzG9yxPTV5G1AvkT1rug==","serverName":"DEV_COMPILA","connType":3}}}
Content-Length: 148
{"jsonrpc":"2.0","id":2,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":3,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 153
{"jsonrpc":"2.0","id":4,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 145
{"jsonrpc":"2.0","id":5,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 148
{"jsonrpc":"2.0","id":6,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":7,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 153
{"jsonrpc":"2.0","id":8,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 145
{"jsonrpc":"2.0","id":9,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 76
{"jsonrpc":"2.0","method":"$/setTraceNotification","params":{"value":"off"}}
Content-Length: 682
{"jsonrpc":"2.0","id":10,"method":"$totvsserver/serverInformations","params":{"serverInformationsInfo":{"connectionToken":"djM6NjFxOWMxbzU3ZGFsNG1uYTZramNldjRqdHE3ZGdwOjE6MTkyLjE2OC4xLjEwMzoxMjM2OjA6Ny4wMC4yMTAzMjRQOjM=:djE6Q09NUElMQV9ROkFkbWluOjhjTG9KcHlFRmNmdkJ0TGN6dHE1Q1FkWTM4TjJDNmtISEIyWUQzTmxsNUU9|djI6MTcwNDM4NTk0NzowOjE6MQ==.IUOtlG6rWpDCfGbEY6hcGBkMf8FrrPFC4fdbwx2lct6n4t+Nw5Oov//+Pi1xk1cKGFDM8HlgxMTUktbqy+0uYth3s0PuRj9wckjarvoKimP8l3O98nm+Q06lcCuQuJUIXwnQL0/fZ/LP8YHi+ziI+zUe+67PePdMBOgF6TinbgM8YqADEEblaQ7Zj9xOHVJUycNBnbG27jlDm2z1Q0qXy1S2qIY0EU+7ly8LST8h6B8S7QSiD4iF5O7IPIE66CHYLgTmkxIVMHKgJPbM9zMY+Kw2W+B8ArksA7tTGOJaSPlz0rqu2YIUBPAgPurNectGG/iN5/89/2vY8n8iMwWHdg=="}}}
Content-Length: 184
{"jsonrpc":"2.0","id":11,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"includes","value":"D:\\TOTVS 12\\Microsiga\\Protheus\\include;"}}}
Content-Length: 149
{"jsonrpc":"2.0","id":12,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 147
{"jsonrpc":"2.0","id":13,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 154
{"jsonrpc":"2.0","id":14,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":15,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 149
{"jsonrpc":"2.0","id":16,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"fsencoding","value":"cp1252"}}}
Content-Length: 147
{"jsonrpc":"2.0","id":17,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"autocomplete","value":"LS"}}}
Content-Length: 154
{"jsonrpc":"2.0","id":18,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"notificationlevel","value":"none"}}}
Content-Length: 146
{"jsonrpc":"2.0","id":19,"method":"$totvsserver/changeSetting","params":{"changeSettingInfo":{"scope":"advpls","key":"linter","value":"enabled"}}}
Content-Length: 76
{"jsonrpc":"2.0","method":"$/setTraceNotification","params":{"value":"off"}}
